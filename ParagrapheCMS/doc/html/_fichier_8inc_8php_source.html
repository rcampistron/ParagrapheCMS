<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>CMSCroisix:  Fichier source de class/Fichier.inc.php</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Généré par Doxygen 1.6.2 -->
  <div class="navpath"><a class="el" href="dir_a0b1ff84f080d2ce1409d6712f25da0e.html">class</a>
  </div>
<div class="contents">
<h1>Fichier.inc.php</h1><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 &lt;?php  
<a name="l00008"></a><a class="code" href="class_fichier.html">00008</a> <span class="keyword">class </span><a class="code" href="class_fichier.html">Fichier</a> {
<a name="l00013"></a><a class="code" href="class_fichier.html#a6671704e8941480bbb3f0880dcd345e9">00013</a>     <span class="keyword">public</span> <a class="code" href="class_fichier.html#a6671704e8941480bbb3f0880dcd345e9">$numfichier</a>;
<a name="l00018"></a><a class="code" href="class_fichier.html#af81b4088e5d1d5a963183fc3a1b75c41">00018</a>     <span class="keyword">public</span> <a class="code" href="class_fichier.html#af81b4088e5d1d5a963183fc3a1b75c41">$nomFichier</a>;
<a name="l00023"></a><a class="code" href="class_fichier.html#ac06fa4b1464b10f854a3a63c746f3a71">00023</a>         <span class="keyword">public</span> <a class="code" href="class_fichier.html#ac06fa4b1464b10f854a3a63c746f3a71">$poidsFichier</a>;
<a name="l00028"></a><a class="code" href="class_fichier.html#acc72cf4b685e9e0d6879a0d38bffb286">00028</a>         <span class="keyword">public</span> <a class="code" href="class_fichier.html#acc72cf4b685e9e0d6879a0d38bffb286">$libFichier</a>;
<a name="l00033"></a><a class="code" href="class_fichier.html#aba9f221c896bf21746e2d64cdd2f79d2">00033</a>         <span class="keyword">public</span> <a class="code" href="class_fichier.html#aba9f221c896bf21746e2d64cdd2f79d2">$ordreFichier</a>;
<a name="l00038"></a><a class="code" href="class_fichier.html#acec1dfd286df26e5d6e993396c786646">00038</a>         <span class="keyword">public</span> <a class="code" href="class_fichier.html#acec1dfd286df26e5d6e993396c786646">$numparafichier</a>;
<a name="l00043"></a><a class="code" href="class_fichier.html#a9bc62f750f518ded94acc78ac473d498">00043</a>         <span class="keyword">public</span> <a class="code" href="class_fichier.html#a9bc62f750f518ded94acc78ac473d498">$tmp_name</a>;
<a name="l00048"></a><a class="code" href="class_fichier.html#a302d62e2eb52f162f4c7eb52d49eaadb">00048</a>         <span class="keyword">public</span> <a class="code" href="class_fichier.html#a302d62e2eb52f162f4c7eb52d49eaadb">$modif</a>;
<a name="l00049"></a>00049         
<a name="l00055"></a><a class="code" href="class_fichier.html#aca3c4cf56b16d52eeae0f8e895392828">00055</a>         function <a class="code" href="class_fichier.html#aca3c4cf56b16d52eeae0f8e895392828">creerFichier</a>() {
<a name="l00056"></a>00056             <span class="keywordflow">if</span> ($this-&gt;modif) $chem=<span class="stringliteral">&quot;../&quot;</span>;
<a name="l00057"></a>00057                 
<a name="l00058"></a>00058             $liste=explode(<span class="stringliteral">&quot;.&quot;</span>,$this-&gt;nomFichier);
<a name="l00059"></a>00059             <span class="keywordflow">if</span> ($liste[4]) $ext=$liste[4]; <span class="keywordflow">else</span> <span class="keywordflow">if</span> ($liste[3]) $ext=$liste[3]; <span class="keywordflow">else</span> <span class="keywordflow">if</span> ($liste[2]) $ext=$liste[2]; <span class="keywordflow">else</span> $ext=$liste[1]; 
<a name="l00060"></a>00060             $nom_fichier=$liste[0].<span class="stringliteral">&quot;.&quot;</span>.$ext;
<a name="l00061"></a>00061             @move_uploaded_file($this-&gt;tmp_name, $chem.<span class="stringliteral">&quot;fichiers/&quot;</span>.$nom_fichier);       
<a name="l00062"></a>00062                 
<a name="l00063"></a>00063                 mysql_query(<span class="stringliteral">&quot;INSERT INTO if_fichier (nom_fichier) VALUES (&#39;$nom_fichier&#39;)&quot;</span>);
<a name="l00064"></a>00064                 $this-&gt;numfichier=mysql_insert_id();
<a name="l00065"></a>00065                 
<a name="l00066"></a>00066                 <span class="keywordflow">return</span> $this-&gt;numfichier; 
<a name="l00067"></a>00067         }
<a name="l00068"></a>00068         
<a name="l00069"></a>00069         function modifierFichier() {
<a name="l00070"></a>00070         
<a name="l00071"></a>00071         }
<a name="l00072"></a>00072         
<a name="l00073"></a>00073         function supprimerFichier() {
<a name="l00074"></a>00074         
<a name="l00075"></a>00075         }
<a name="l00076"></a>00076         
<a name="l00080"></a><a class="code" href="class_fichier.html#a9d0345af5f10acb16ee4356f2ad87a90">00080</a>         function <a class="code" href="class_fichier.html#a9d0345af5f10acb16ee4356f2ad87a90">infosFichier</a>() {
<a name="l00081"></a>00081                 
<a name="l00082"></a>00082                 
<a name="l00083"></a>00083                 <span class="keywordflow">if</span> ($this-&gt;numparafichier) {
<a name="l00084"></a>00084                         $row=SelectMultiple(<span class="stringliteral">&quot;if_para_fichier&quot;</span>,<span class="stringliteral">&quot;numparafichier&quot;</span>,$this-&gt;numparafichier);
<a name="l00085"></a>00085                         $this-&gt;libFichier=$row[<span class="stringliteral">&quot;libelle&quot;</span>];
<a name="l00086"></a>00086                         $this-&gt;ordreFichier=$row[<span class="stringliteral">&quot;ordre&quot;</span>];
<a name="l00087"></a>00087                         $this-&gt;numfichier=$row[<span class="stringliteral">&quot;numfichier&quot;</span>];
<a name="l00088"></a>00088                         $row=SelectMultiple(<span class="stringliteral">&quot;if_fichier&quot;</span>,<span class="stringliteral">&quot;numfichier&quot;</span>,$this-&gt;numfichier);
<a name="l00089"></a>00089                         <span class="keywordflow">if</span> (file_exists(<span class="stringliteral">&quot;fichiers/&quot;</span>.$row[<span class="stringliteral">&quot;nom_fichier&quot;</span>])) {
<a name="l00090"></a>00090                                 $this-&gt;nomFichier=$row[<span class="stringliteral">&quot;nom_fichier&quot;</span>];
<a name="l00091"></a>00091                                 $poidsKo=filesize(<span class="stringliteral">&quot;fichiers/&quot;</span>.$this-&gt;nomFichier)/1024;
<a name="l00092"></a>00092                                 <span class="keywordflow">if</span> ($poidsKo &lt; 100) $this-&gt;poidsFichier=round($poidsKo).<span class="stringliteral">&quot; Ko&quot;</span>;
<a name="l00093"></a>00093                                 <span class="keywordflow">else</span> $this-&gt;poidsFichier=number_format($poidsKo/1024, 1,<span class="stringliteral">&quot;,&quot;</span>,<span class="stringliteral">&quot;&quot;</span>).<span class="stringliteral">&quot; Mo&quot;</span>;
<a name="l00094"></a>00094                         }
<a name="l00095"></a>00095                 } <span class="keywordflow">else</span> {
<a name="l00096"></a>00096                         $row=SelectMultiple(<span class="stringliteral">&quot;if_fichier&quot;</span>,<span class="stringliteral">&quot;numfichier&quot;</span>,$this-&gt;numfichier);
<a name="l00097"></a>00097                         <span class="keywordflow">if</span> (file_exists(<span class="stringliteral">&quot;fichiers/&quot;</span>.$row[<span class="stringliteral">&quot;nom_fichier&quot;</span>])) {
<a name="l00098"></a>00098                                 $this-&gt;nomFichier=$row[<span class="stringliteral">&quot;nom_fichier&quot;</span>];
<a name="l00099"></a>00099                                 $poidsKo=filesize(<span class="stringliteral">&quot;fichiers/&quot;</span>.$this-&gt;nomFichier)/1024;
<a name="l00100"></a>00100                                 <span class="keywordflow">if</span> ($poidsKo &lt; 100) $this-&gt;poidsFichier=round($poidsKo).<span class="stringliteral">&quot; Ko&quot;</span>;
<a name="l00101"></a>00101                                 <span class="keywordflow">else</span> $this-&gt;poidsFichier=number_format($poidsKo/1024, 1,<span class="stringliteral">&quot;,&quot;</span>,<span class="stringliteral">&quot;&quot;</span>).<span class="stringliteral">&quot; Mo&quot;</span>;
<a name="l00102"></a>00102                         }
<a name="l00103"></a>00103                 }
<a name="l00104"></a>00104         }
<a name="l00105"></a>00105 }
<a name="l00106"></a>00106 
<a name="l00107"></a>00107 ?&gt;
</pre></div></div>
<hr size="1"/><address style="text-align: right;"><small>Généré par&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.2 </small></address>
</body>
</html>

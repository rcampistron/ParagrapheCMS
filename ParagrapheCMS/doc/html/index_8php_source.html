<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>CMSCroisix:  Fichier source de index.php</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- G√©n√©r√© par Doxygen 1.6.2 -->
<h1>index.php</h1><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 &lt;?php
<a name="l00025"></a>00025 include (<span class="stringliteral">&quot;connexion.php&quot;</span>);
<a name="l00026"></a>00026 session_start();
<a name="l00027"></a>00027 
<a name="l00028"></a>00028 
<a name="l00033"></a>00033 $result=mysql_query(<span class="stringliteral">&quot;SELECT * FROM if_site&quot;</span>);
<a name="l00034"></a>00034 $res_site=mysql_numrows($result);
<a name="l00035"></a>00035 $if_site=mysql_fetch_array($result);
<a name="l00036"></a>00036 $chem=$if_site[<span class="stringliteral">&quot;path&quot;</span>];   <span class="comment">//$chem=&quot;/home/web/croisix/ifip.croisix.com/www/&quot;;</span>
<a name="l00040"></a>00040 <span class="comment"></span>include (<span class="stringliteral">&quot;fonctions.php&quot;</span>);
<a name="l00041"></a>00041 
<a name="l00042"></a>00042 <span class="comment">/**********************************************</span>
<a name="l00043"></a>00043 <span class="comment">Controle sur les variables</span>
<a name="l00044"></a>00044 <span class="comment">**********************************************/</span>
<a name="l00052"></a>00052 <span class="keywordflow">if</span> (
<a name="l00053"></a>00053         isset($spec) &amp;&amp; $spec &amp;&amp; ($spec!=<span class="stringliteral">&quot;actualites-filiere-production-porc&quot;</span>  
<a name="l00054"></a>00054  &amp;&amp; $spec!=<span class="stringliteral">&quot;catalogue-ifip-institut-du-porc&quot;</span> &amp;&amp; $spec!=<span class="stringliteral">&quot;compte-ifip&quot;</span> &amp;&amp; $spec!=<span class="stringliteral">&quot;compte-ifip-profil&quot;</span> &amp;&amp; $spec!=<span class="stringliteral">&quot;contact&quot;</span> 
<a name="l00055"></a>00055  &amp;&amp; $spec!=<span class="stringliteral">&quot;equipes-ifip&quot;</span> &amp;&amp; $spec!=<span class="stringliteral">&quot;extranet-pro&quot;</span> &amp;&amp; $spec!=<span class="stringliteral">&quot;formation-inscription&quot;</span> &amp;&amp; $spec!=<span class="stringliteral">&quot;formations-ifip&quot;</span> 
<a name="l00056"></a>00056  &amp;&amp; $spec!=<span class="stringliteral">&quot;panier-ifip-institut-du-porc&quot;</span> &amp;&amp; $spec!=<span class="stringliteral">&quot;publications-ifip-institut-du-porc&quot;</span> &amp;&amp; $spec!=<span class="stringliteral">&quot;rechercher-ifip&quot;</span> 
<a name="l00057"></a>00057  &amp;&amp; $spec!=<span class="stringliteral">&quot;veille-economique-internationale-production-viande-porc&quot;</span> &amp;&amp; $spec!=<span class="stringliteral">&quot;oublie&quot;</span> &amp;&amp; $spec!=<span class="stringliteral">&quot;includes/home&quot;</span>)
<a name="l00058"></a>00058 ) {
<a name="l00059"></a>00059         $spec=<span class="stringliteral">&quot;&quot;</span>;
<a name="l00060"></a>00060         unset($_SESSION[<span class="stringliteral">&#39;numcom&#39;</span>]); 
<a name="l00061"></a>00061         unset($_SESSION[<span class="stringliteral">&#39;numclient&#39;</span>]);
<a name="l00062"></a>00062         unset($_SESSION[<span class="stringliteral">&#39;numprof&#39;</span>]);
<a name="l00063"></a>00063         header(<span class="stringliteral">&quot;Location:http://www.ifip.asso.fr&quot;</span>);
<a name="l00064"></a>00064 }
<a name="l00068"></a>00068 <span class="keywordflow">if</span> (isset($pg_admin) &amp;&amp; $pg_admin &amp;&amp; ($pg_admin!=<span class="stringliteral">&quot;accueil&quot;</span> &amp;&amp; $pg_admin!=<span class="stringliteral">&quot;admin-site&quot;</span> &amp;&amp; $pg_admin!=<span class="stringliteral">&quot;ajouter-actu&quot;</span> 
<a name="l00069"></a>00069 &amp;&amp; $pg_admin!=<span class="stringliteral">&quot;ajouter-arti&quot;</span> 
<a name="l00070"></a>00070  &amp;&amp; $pg_admin!=<span class="stringliteral">&quot;ajouter-breve&quot;</span> &amp;&amp; $pg_admin!=<span class="stringliteral">&quot;ajouter-contact&quot;</span> &amp;&amp; $pg_admin!=<span class="stringliteral">&quot;ajouter-doc&quot;</span> 
<a name="l00071"></a>00071  &amp;&amp; $pg_admin!=<span class="stringliteral">&quot;ajouter-forma&quot;</span> &amp;&amp; $pg_admin!=<span class="stringliteral">&quot;ajouter-menu&quot;</span> &amp;&amp; $pg_admin!=<span class="stringliteral">&quot;ajouter-page&quot;</span> &amp;&amp; $pg_admin!=<span class="stringliteral">&quot;ajouter-parag&quot;</span> 
<a name="l00072"></a>00072  &amp;&amp; $pg_admin!=<span class="stringliteral">&quot;ajouter-prof&quot;</span> &amp;&amp; $pg_admin!=<span class="stringliteral">&quot;ajouter-uti&quot;</span> &amp;&amp; $pg_admin!=<span class="stringliteral">&quot;content&quot;</span> 
<a name="l00073"></a>00073  &amp;&amp; $pg_admin!=<span class="stringliteral">&quot;lister-actu&quot;</span> &amp;&amp; $pg_admin!=<span class="stringliteral">&quot;lister-arti&quot;</span> 
<a name="l00074"></a>00074  &amp;&amp; $pg_admin!=<span class="stringliteral">&quot;lister-breve&quot;</span> &amp;&amp; $pg_admin!=<span class="stringliteral">&quot;lister-client&quot;</span> &amp;&amp; $pg_admin!=<span class="stringliteral">&quot;lister-com&quot;</span> &amp;&amp; $pg_admin!=<span class="stringliteral">&quot;lister-contact&quot;</span> 
<a name="l00075"></a>00075  &amp;&amp; $pg_admin!=<span class="stringliteral">&quot;lister-doc&quot;</span> &amp;&amp; $pg_admin!=<span class="stringliteral">&quot;lister-formation&quot;</span> &amp;&amp; $pg_admin!=<span class="stringliteral">&quot;lister-inscri&quot;</span> &amp;&amp; $pg_admin!=<span class="stringliteral">&quot;lister-menu&quot;</span> 
<a name="l00076"></a>00076  &amp;&amp; $pg_admin!=<span class="stringliteral">&quot;lister-page&quot;</span> &amp;&amp; $pg_admin!=<span class="stringliteral">&quot;lister-prof&quot;</span> &amp;&amp; $pg_admin!=<span class="stringliteral">&quot;lister-uti&quot;</span> &amp;&amp; $pg_admin!=<span class="stringliteral">&quot;modifier-client&quot;</span> 
<a name="l00077"></a>00077  &amp;&amp; $pg_admin!=<span class="stringliteral">&quot;modifier-com&quot;</span> &amp;&amp; $pg_admin!=<span class="stringliteral">&quot;modifier-page&quot;</span> &amp;&amp; $pg_admin!=<span class="stringliteral">&quot;modifier-parag&quot;</span>)) {
<a name="l00078"></a>00078         $pg_admin=<span class="stringliteral">&quot;&quot;</span>;
<a name="l00079"></a>00079         unset($_SESSION[<span class="stringliteral">&#39;numcom&#39;</span>]); 
<a name="l00080"></a>00080         unset($_SESSION[<span class="stringliteral">&#39;numclient&#39;</span>]);
<a name="l00081"></a>00081         unset($_SESSION[<span class="stringliteral">&#39;numprof&#39;</span>]);
<a name="l00082"></a>00082         header(<span class="stringliteral">&quot;Location:http://www.ifip.asso.fr&quot;</span>);
<a name="l00083"></a>00083 }
<a name="l00084"></a>00084 <span class="keywordflow">if</span> (
<a name="l00085"></a>00085         (isset($numpage) &amp;&amp; $numpage &amp;&amp; !is_numeric($numpage)) || 
<a name="l00086"></a>00086         (isset($numrub) &amp;&amp; $numrub &amp;&amp; !is_numeric($numrub)) || 
<a name="l00087"></a>00087         (isset($numcateg) &amp;&amp; $numcateg &amp;&amp; !is_numeric($numcateg)) || 
<a name="l00088"></a>00088         (isset($numsscateg) &amp;&amp; $numsscateg &amp;&amp; !is_numeric($numsscateg)) || 
<a name="l00089"></a>00089         (isset($numpara) &amp;&amp; $numpara &amp;&amp; !is_numeric($numpara)) || 
<a name="l00090"></a>00090         (isset($numdoc) &amp;&amp; $numdoc &amp;&amp; !is_numeric($numdoc)) || 
<a name="l00091"></a>00091         (isset($numcontact) &amp;&amp; $numcontact &amp;&amp; !is_numeric($numcontact)) || 
<a name="l00092"></a>00092         (isset($numpays) &amp;&amp; $numpays &amp;&amp; !is_numeric($numpays)) || 
<a name="l00093"></a>00093         (isset($lg) &amp;&amp; $lg &amp;&amp; $lg!=<span class="stringliteral">&quot;fr&quot;</span> &amp;&amp; $lg!=<span class="stringliteral">&quot;en&quot;</span>) || 
<a name="l00094"></a>00094         (isset($date_br) &amp;&amp; $date_br &amp;&amp; !is_numeric($date_br)) || 
<a name="l00095"></a>00095         (isset($dom) &amp;&amp; $dom &amp;&amp; !is_numeric($dom)) || 
<a name="l00096"></a>00096         (isset($ssdom) &amp;&amp; $ssdom &amp;&amp; !is_numeric($ssdom)) || 
<a name="l00097"></a>00097         (isset($type) &amp;&amp; $type &amp;&amp; $type!=<span class="stringliteral">&quot;accespro&quot;</span> &amp;&amp; $type!=<span class="stringliteral">&quot;infosformation&quot;</span> &amp;&amp; $type!=<span class="stringliteral">&quot;rubrique&quot;</span> &amp;&amp; $type!=<span class="stringliteral">&quot;categorie&quot;</span> 
<a name="l00098"></a>00098         &amp;&amp; $type!=<span class="stringliteral">&quot;sscateg&quot;</span>) || 
<a name="l00099"></a>00099         (isset($decon) &amp;&amp; $decon &amp;&amp; $decon!=<span class="charliteral">&#39;1&#39;</span>) || 
<a name="l00100"></a>00100         (isset($deconclient) &amp;&amp; $deconclient &amp;&amp; $deconclient!=<span class="charliteral">&#39;o&#39;</span>) ||
<a name="l00101"></a>00101         (isset($deconpro) &amp;&amp; $deconpro &amp;&amp; $deconpro!=<span class="charliteral">&#39;o&#39;</span>) 
<a name="l00102"></a>00102 ) {
<a name="l00103"></a>00103         unset($_SESSION[<span class="stringliteral">&#39;numcom&#39;</span>]); 
<a name="l00104"></a>00104         unset($_SESSION[<span class="stringliteral">&#39;numclient&#39;</span>]);
<a name="l00105"></a>00105         unset($_SESSION[<span class="stringliteral">&#39;numprof&#39;</span>]);
<a name="l00106"></a>00106         header(<span class="stringliteral">&quot;Location:http://www.ifip.asso.fr&quot;</span>);
<a name="l00107"></a>00107 
<a name="l00108"></a>00108 }
<a name="l00109"></a>00109 
<a name="l00110"></a>00110 include (<span class="stringliteral">&quot;includes/classes.php&quot;</span>);
<a name="l00115"></a>00115 include (<span class="stringliteral">&quot;fonctions_mails.php&quot;</span>); 
<a name="l00122"></a>00122 <span class="keywordflow">if</span> ($id) {
<a name="l00123"></a>00123   $uti=<span class="keyword">new</span> <a class="code" href="class_utilisateur.html">Utilisateur</a>();
<a name="l00124"></a>00124   $uti-&gt;id=$id;
<a name="l00125"></a>00125   <span class="keywordflow">if</span>(is_numeric($id)) {
<a name="l00126"></a>00126         $verifsession=$uti-&gt;Verif_Session($id,$cnx);  
<a name="l00127"></a>00127         <span class="keywordflow">if</span> ($verifsession==<span class="charliteral">&#39;0&#39;</span>) { <span class="comment">//pas bon donc retour automatique</span>
<a name="l00128"></a>00128                 header(<span class="stringliteral">&quot;Location: ../&quot;</span>);
<a name="l00129"></a>00129         }
<a name="l00130"></a>00130   } <span class="keywordflow">else</span> {
<a name="l00131"></a>00131                 header(<span class="stringliteral">&quot;Location: ../&quot;</span>);
<a name="l00132"></a>00132   }
<a name="l00133"></a>00133 }
<a name="l00134"></a>00134 <span class="comment">/* </span>
<a name="l00135"></a>00135 <span class="comment"> * On vÈrifie si on est dans le moteur de recherche</span>
<a name="l00136"></a>00136 <span class="comment"> * </span>
<a name="l00137"></a>00137 <span class="comment"> */</span>
<a name="l00138"></a>00138 <span class="keywordflow">if</span> ($moteur_rech || $rech_site_suite) {
<a name="l00139"></a>00139         <span class="keywordflow">if</span> ($rech_site_suite) $rech_site=$rech_site_suite ;
<a name="l00140"></a>00140         <span class="keywordflow">if</span> ($rech_site) {
<a name="l00141"></a>00141                 $parag=<span class="keyword">new</span> <a class="code" href="class_paragraphe.html" title="G&amp;egrave;re le traitement des paragraphes.">Paragraphe</a>();
<a name="l00142"></a>00142                 $parag-&gt;recherche=$rech_site;
<a name="l00143"></a>00143                 $parag-&gt;lg=$lg;
<a name="l00144"></a>00144                 $resultats=$parag-&gt;rechercherPara();
<a name="l00145"></a>00145                 <span class="comment">//print_r($resultats);</span>
<a name="l00146"></a>00146                 $spec=<span class="stringliteral">&quot;rechercher-ifip&quot;</span>;
<a name="l00147"></a>00147         }
<a name="l00148"></a>00148         <span class="comment">//Array ( [0] =&gt; Array ( [numpage] =&gt; 44 [titre] =&gt; R√©sultats des √©levages de porcs [lien] =&gt; resultats-economiques-elevages-de-porc.html [texte] =&gt; ) [1] =&gt; Array ( [numpage] =&gt; 56 [titre] =&gt; Expertise G√©n√©tique des porcs [lien] =&gt; genetique-races-porcs.html [texte] =&gt; ) [2] =&gt; Array ( [numpage] =&gt; 91 [titre] =&gt; Alimentation post-sevrage et des porcs charcutiers [lien] =&gt; alimentation-porcs-post-sevrage-et-charcutiers.html [texte] =&gt; ) ) </span>
<a name="l00149"></a>00149 }
<a name="l00157"></a>00157 <span class="keywordflow">if</span> ($id) {
<a name="l00158"></a>00158 <span class="comment">/* ************* On ajoute une page</span>
<a name="l00159"></a>00159 <span class="comment"> * **************************************** */</span>
<a name="l00160"></a>00160 <span class="keywordflow">if</span> ($pg_admin==<span class="stringliteral">&quot;ajouter-page&quot;</span>) {
<a name="l00161"></a>00161    <span class="keywordflow">if</span> ($textNomG) {
<a name="l00162"></a>00162                 $newPage=<span class="keyword">new</span> Page();   
<a name="l00163"></a>00163                 $newPage-&gt;aliasPage=$textAlias.<span class="stringliteral">&quot;.html&quot;</span>;
<a name="l00164"></a>00164                 <span class="keywordflow">if</span> ($newPage-&gt;verifierAlias()) {
<a name="l00165"></a>00165                         $newPage-&gt;lg=$selectLg;  
<a name="l00166"></a>00166                         $newPage-&gt;nomPageGoogle=$textNomG;
<a name="l00167"></a>00167                         $newPage-&gt;titrePage=$textTitre;
<a name="l00168"></a>00168                         $newPage-&gt;descrPage=$textDescr;
<a name="l00169"></a>00169                         $newPage-&gt;keywPage=$textKeyw;
<a name="l00170"></a>00170                         $newPage-&gt;nomFichier=$textFichier;
<a name="l00171"></a>00171                         $newPage-&gt;id_c=$id;
<a name="l00172"></a>00172                         $newPage-&gt;accueilPage=$radioAccueil;
<a name="l00173"></a>00173                         $newPage-&gt;accueilSite=$radioAccueilSite;  
<a name="l00174"></a>00174                         <span class="keywordflow">if</span> ($selectPhoto) {
<a name="l00175"></a>00175                           $newPage-&gt;numphoto=$selectPhoto;
<a name="l00176"></a>00176                         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (isset($_FILES[<span class="stringliteral">&quot;filePhoto&quot;</span>][<span class="stringliteral">&#39;tmp_name&#39;</span>]) &amp;&amp; $_FILES[<span class="stringliteral">&quot;filePhoto&quot;</span>][<span class="stringliteral">&#39;tmp_name&#39;</span>]!=<span class="stringliteral">&quot;&quot;</span>) {
<a name="l00177"></a>00177                           $newPhoto=<span class="keyword">new</span> <a class="code" href="class_photo.html">Photo</a>();
<a name="l00178"></a>00178                           $newPhoto-&gt;nomPhoto=basename($_FILES[<span class="stringliteral">&quot;filePhoto&quot;</span>][<span class="stringliteral">&#39;name&#39;</span>]);
<a name="l00179"></a>00179                           $newPhoto-&gt;tmp_name=$_FILES[<span class="stringliteral">&quot;filePhoto&quot;</span>][<span class="stringliteral">&#39;tmp_name&#39;</span>];
<a name="l00180"></a>00180                           $newPage-&gt;numphoto=$newPhoto-&gt;creerPhoto();
<a name="l00181"></a>00181                         }
<a name="l00182"></a>00182                         $newPage-&gt;publiePage=$radioPubliee;              
<a name="l00183"></a>00183                         
<a name="l00184"></a>00184                         $numpage=$newPage-&gt;creerPage();<span class="comment">// on cree la page          </span>
<a name="l00185"></a>00185                         
<a name="l00186"></a>00186                         <span class="keywordflow">if</span> (is_array($selectMenu)) {<span class="comment">//on associe la page √† un ou plusieurs menus</span>
<a name="l00187"></a>00187                           reset($selectMenu);
<a name="l00188"></a>00188                           <span class="keywordflow">while</span>(list(,$val) = each($selectMenu)) {
<a name="l00189"></a>00189                                           $list_menu=explode(<span class="stringliteral">&quot;-&quot;</span>,$val);
<a name="l00190"></a>00190                                           $leMenu=<span class="keyword">new</span> <a class="code" href="class_menu.html" title="cr√©ation, modification, suppression d&amp;#39;un menu">Menu</a>();
<a name="l00191"></a>00191                                           $leMenu-&gt;nummenu=$list_menu[0];
<a name="l00192"></a>00192                                           $leMenu-&gt;type=$list_menu[1];
<a name="l00193"></a>00193                                           $leMenu-&gt;numpage=$numpage;
<a name="l00194"></a>00194                                           $leMenu-&gt;associerPage();       
<a name="l00195"></a>00195                           }<span class="comment">//Fin du while</span>
<a name="l00196"></a>00196                         }
<a name="l00197"></a>00197                         
<a name="l00198"></a>00198                         <span class="keywordflow">if</span> ($radioPubliee==<span class="stringliteral">&quot;o&quot;</span>) $newPage-&gt;creerAlias();
<a name="l00199"></a>00199                         $creer_page=1;
<a name="l00200"></a>00200                         $pg_admin=<span class="stringliteral">&quot;ajouter-parag&quot;</span>;
<a name="l00201"></a>00201                 } <span class="keywordflow">else</span> {
<a name="l00202"></a>00202                    $mes=<span class="stringliteral">&quot;Attention, le nom du fichier existe d√©j√†. Vous devez choisir un autre nom pour cette page.&quot;</span>;
<a name="l00203"></a>00203                 }
<a name="l00204"></a>00204    }
<a name="l00205"></a>00205 <span class="comment">/* ************* On ajoute un paragraphe lors de la cr√©ation de la page (pg=&quot;ajouter-parag&quot;) ou </span>
<a name="l00206"></a>00206 <span class="comment"> ************* en modification de page (action=&quot;ajouter_parag&quot;) ****************</span>
<a name="l00207"></a>00207 <span class="comment"> **************************************************************** */</span>
<a name="l00208"></a>00208 } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ($pg_admin==<span class="stringliteral">&quot;ajouter-parag&quot;</span> || $action==<span class="stringliteral">&quot;ajouter_parag&quot;</span>) {
<a name="l00209"></a>00209    <span class="comment">//if ($textCont || is_array($checkPara)) {</span>
<a name="l00210"></a>00210                    $newParag=<span class="keyword">new</span> <a class="code" href="class_paragraphe.html" title="G&amp;egrave;re le traitement des paragraphes.">Paragraphe</a>();  
<a name="l00211"></a>00211            <span class="comment">//if ($textTitrePara) { //on cree un nouveau paragraphe</span>
<a name="l00212"></a>00212                    $newParag-&gt;titrePara=$textTitrePara;
<a name="l00213"></a>00213                    $newParag-&gt;contenuPara=$textCont;
<a name="l00214"></a>00214                    $numpara=$newParag-&gt;creerParagraphe();       <span class="comment">// On cr√©e le paragraphe</span>
<a name="l00215"></a>00215                    
<a name="l00216"></a>00216                    $laPage=<span class="keyword">new</span> Page();
<a name="l00217"></a>00217                    $laPage-&gt;numpage=$numpage;
<a name="l00218"></a>00218                    $laPage-&gt;id_m=$id;
<a name="l00219"></a>00219                    $laPage-&gt;numpara=$numpara;
<a name="l00220"></a>00220                    $laPage-&gt;ordre=$selectOrdre;  
<a name="l00221"></a>00221                    $laPage-&gt;colonne=$selectType;
<a name="l00222"></a>00222                    $laPage-&gt;liste=$radioListe;
<a name="l00223"></a>00223                    $laPage-&gt;typeTitre=$radioTypeTitre;
<a name="l00224"></a>00224                    $laPage-&gt;ajouterParagraphe();  <span class="comment">// On l&#39;ajoute √† la page</span>
<a name="l00225"></a>00225                    
<a name="l00226"></a>00226                    <span class="keywordflow">for</span> ($i=1;$i&lt;=$nbLiens;$i++) { <span class="comment">// On traite l&#39;ajout de liens</span>
<a name="l00227"></a>00227                          $valUrl=<span class="stringliteral">&quot;textUrlLien&quot;</span>.$i.<span class="stringliteral">&quot;_&quot;</span>;
<a name="l00228"></a>00228                          $valPage=<span class="stringliteral">&quot;selectPage&quot;</span>.$i.<span class="stringliteral">&quot;_&quot;</span>;
<a name="l00229"></a>00229                          <span class="keywordflow">if</span> ($$valUrl || $$valPage) {
<a name="l00230"></a>00230                                         $valLib=<span class="stringliteral">&quot;textLibLien&quot;</span>.$i.<span class="stringliteral">&quot;_&quot;</span>;
<a name="l00231"></a>00231                                         $valTexte=<span class="stringliteral">&quot;textTexteLien&quot;</span>.$i.<span class="stringliteral">&quot;_&quot;</span>;
<a name="l00232"></a>00232                                         $valOrdre=<span class="stringliteral">&quot;selectOrdreLien&quot;</span>.$i.<span class="stringliteral">&quot;_&quot;</span>;
<a name="l00233"></a>00233                                         $valFen=<span class="stringliteral">&quot;radioFen&quot;</span>.$i.<span class="stringliteral">&quot;_&quot;</span>;
<a name="l00234"></a>00234                                         $newLien=<span class="keyword">new</span> <a class="code" href="class_lien.html">Lien</a>(); 
<a name="l00235"></a>00235                                         $newLien-&gt;numpara=$numpara;
<a name="l00236"></a>00236                                         $newLien-&gt;libLien=$$valLib;
<a name="l00237"></a>00237                                         $newLien-&gt;texteLien=$$valTexte;
<a name="l00238"></a>00238                                         <span class="keywordflow">if</span> ($$valPage) {
<a name="l00239"></a>00239                                                 $pageLien= <span class="keyword">new</span> Page();
<a name="l00240"></a>00240                                                 $pageLien-&gt;numpage=$$valPage;
<a name="l00241"></a>00241                                                 $pageLien-&gt;infosPage();
<a name="l00242"></a>00242                                                 $newLien-&gt;numpage=$$valPage;
<a name="l00243"></a>00243                                                 $newLien-&gt;urlLien=$pageLien-&gt;aliasPage;
<a name="l00244"></a>00244                                          } <span class="keywordflow">else</span> {
<a name="l00245"></a>00245                                                 $newLien-&gt;urlLien=      $$valUrl;
<a name="l00246"></a>00246                                          }
<a name="l00247"></a>00247                                         $newLien-&gt;fenLien=$$valFen; 
<a name="l00248"></a>00248                                         $newLien-&gt;ordreLien=$$valOrdre; 
<a name="l00249"></a>00249                                         $newLien-&gt;creerLien();
<a name="l00250"></a>00250                          }<span class="comment">//fin if ($$valUrl)</span>
<a name="l00251"></a>00251                    }<span class="comment">//fin du for</span>
<a name="l00252"></a>00252                    
<a name="l00253"></a>00253                     <span class="keywordflow">for</span> ($i=1;$i&lt;=$nbPhotos;$i++) { <span class="comment">// On traite l&#39;association de photos</span>
<a name="l00254"></a>00254                          $valSelect=<span class="stringliteral">&quot;selectPhoto&quot;</span>.$i.<span class="stringliteral">&quot;_&quot;</span>;;
<a name="l00255"></a>00255                          $valFile=<span class="stringliteral">&quot;filePhoto&quot;</span>.$i.<span class="stringliteral">&quot;_&quot;</span>;;
<a name="l00256"></a>00256                          <span class="keywordflow">if</span> ($$valSelect || (isset($_FILES[$valFile][<span class="stringliteral">&#39;tmp_name&#39;</span>]) &amp;&amp; $_FILES[$valFile][<span class="stringliteral">&#39;tmp_name&#39;</span>]!=<span class="stringliteral">&quot;&quot;</span>)) {
<a name="l00257"></a>00257                                         $valLeg=<span class="stringliteral">&quot;textLegPh&quot;</span>.$i.<span class="stringliteral">&quot;_&quot;</span>;
<a name="l00258"></a>00258                                         $valOrdre=<span class="stringliteral">&quot;selectOrdrePhoto&quot;</span>.$i.<span class="stringliteral">&quot;_&quot;</span>;
<a name="l00259"></a>00259                                         $valTaille=<span class="stringliteral">&quot;radioTaille&quot;</span>.$i.<span class="stringliteral">&quot;_&quot;</span>; 
<a name="l00260"></a>00260                                         <span class="keywordflow">if</span> ($$valSelect) {<span class="comment">// on associe une photo existante</span>
<a name="l00261"></a>00261                                                   $newParag-&gt;numphoto=$$valSelect;
<a name="l00262"></a>00262                                                   $newParag-&gt;ordrePhoto=$$valOrdre;
<a name="l00263"></a>00263                                                   $newParag-&gt;legPhoto=$$valLeg;
<a name="l00264"></a>00264                                                   $newParag-&gt;associerPhoto(); 
<a name="l00265"></a>00265                                         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (isset($_FILES[$valFile][<span class="stringliteral">&#39;tmp_name&#39;</span>]) &amp;&amp; $_FILES[$valFile][<span class="stringliteral">&#39;tmp_name&#39;</span>]!=<span class="stringliteral">&quot;&quot;</span>) { <span class="comment">// on crÔøΩe une photo</span>
<a name="l00266"></a>00266                                           $newPhoto=<span class="keyword">new</span> <a class="code" href="class_photo.html">Photo</a>();
<a name="l00267"></a>00267                                           $newPhoto-&gt;nomPhoto=normaliza(basename($_FILES[$valFile][<span class="stringliteral">&#39;name&#39;</span>]));
<a name="l00268"></a>00268                                           $newPhoto-&gt;tmp_name=$_FILES[$valFile][<span class="stringliteral">&#39;tmp_name&#39;</span>];
<a name="l00269"></a>00269                                           $newPhoto-&gt;taille=$$valTaille;
<a name="l00270"></a>00270                                           $numphoto=$newPhoto-&gt;creerPhoto();
<a name="l00271"></a>00271                                           
<a name="l00272"></a>00272                                           <span class="comment">// On associe ensuite la photo au paragraphe</span>
<a name="l00273"></a>00273                                           $newParag-&gt;numphoto=$numphoto;
<a name="l00274"></a>00274                                           $newParag-&gt;ordrePhoto=$$valOrdre;
<a name="l00275"></a>00275                                           $newParag-&gt;legPhoto=$$valLeg;
<a name="l00276"></a>00276                                           $newParag-&gt;associerPhoto(); 
<a name="l00277"></a>00277                                         }
<a name="l00278"></a>00278                                         
<a name="l00279"></a>00279                          }<span class="comment">//fin if ($$valSelect || $$valFile)</span>
<a name="l00280"></a>00280                    }<span class="comment">//fin du for</span>
<a name="l00281"></a>00281                    
<a name="l00282"></a>00282                    <span class="keywordflow">for</span> ($i=1;$i&lt;=$nbVideos;$i++) { <span class="comment">// On traite l&#39;association de vid√©os</span>
<a name="l00283"></a>00283                          $valSelect=<span class="stringliteral">&quot;selectVideo&quot;</span>.$i.<span class="stringliteral">&quot;_&quot;</span>;
<a name="l00284"></a>00284                          $valFile=<span class="stringliteral">&quot;fileVideo&quot;</span>.$i.<span class="stringliteral">&quot;_&quot;</span>;
<a name="l00285"></a>00285                          
<a name="l00286"></a>00286                          <span class="keywordflow">if</span> ($$valSelect || (isset($_FILES[$valFile][<span class="stringliteral">&#39;tmp_name&#39;</span>]) &amp;&amp; $_FILES[$valFile][<span class="stringliteral">&#39;tmp_name&#39;</span>]!=<span class="stringliteral">&quot;&quot;</span>)) {
<a name="l00287"></a>00287                                         $valLeg=<span class="stringliteral">&quot;textLegVi&quot;</span>.$i.<span class="stringliteral">&quot;_&quot;</span>;
<a name="l00288"></a>00288                                         $valOrdre=<span class="stringliteral">&quot;selectOrdreVideo&quot;</span>.$i.<span class="stringliteral">&quot;_&quot;</span>;
<a name="l00289"></a>00289                                         <span class="keywordflow">if</span> ($$valSelect) {<span class="comment">// on associe une vid√©o existante</span>
<a name="l00290"></a>00290                                                   $newParag-&gt;numvideo=$$valSelect;
<a name="l00291"></a>00291                                                   $newParag-&gt;ordreVideo=$$valOrdre;
<a name="l00292"></a>00292                                                   $newParag-&gt;legVideo=$$valLeg;
<a name="l00293"></a>00293                                                   $newParag-&gt;associerVideo(); 
<a name="l00294"></a>00294                                         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (isset($_FILES[$valFile][<span class="stringliteral">&#39;tmp_name&#39;</span>]) &amp;&amp; $_FILES[$valFile][<span class="stringliteral">&#39;tmp_name&#39;</span>]!=<span class="stringliteral">&quot;&quot;</span>) { <span class="comment">// on cree une video</span>
<a name="l00295"></a>00295                                           $newVideo=<span class="keyword">new</span> <a class="code" href="class_video.html">Video</a>();
<a name="l00296"></a>00296                                           $newVideo-&gt;nomVideo=normaliza(basename($_FILES[$valFile][<span class="stringliteral">&#39;name&#39;</span>]));
<a name="l00297"></a>00297                                           $newVideo-&gt;tmp_name=$_FILES[$valFile][<span class="stringliteral">&#39;tmp_name&#39;</span>];
<a name="l00298"></a>00298                                           $numvideo=$newVideo-&gt;creerVideo();
<a name="l00299"></a>00299                                           
<a name="l00300"></a>00300                                           <span class="comment">// On associe ensuite la vid√©o au paragraphe</span>
<a name="l00301"></a>00301                                           $newParag-&gt;numvideo=$numvideo;
<a name="l00302"></a>00302                                           $newParag-&gt;ordreVideo=$$valOrdre;
<a name="l00303"></a>00303                                           $newParag-&gt;legVideo=$$valLeg;
<a name="l00304"></a>00304                                           $newParag-&gt;associerVideo(); 
<a name="l00305"></a>00305                                         }
<a name="l00306"></a>00306                                         
<a name="l00307"></a>00307                          }<span class="comment">//fin if ($$valSelect || $$valFile)</span>
<a name="l00308"></a>00308                    }<span class="comment">//fin du for</span>
<a name="l00309"></a>00309                    
<a name="l00310"></a>00310                     <span class="keywordflow">for</span> ($i=1;$i&lt;=$nbFichiers;$i++) { <span class="comment">// On traite l&#39;association de fichiers</span>
<a name="l00311"></a>00311                          <span class="comment">//$valSelect=&quot;selectFich&quot;.$i.&quot;_&quot;;</span>
<a name="l00312"></a>00312                          $valFile=<span class="stringliteral">&quot;fileFich&quot;</span>.$i.<span class="stringliteral">&quot;_&quot;</span>;
<a name="l00313"></a>00313                          
<a name="l00314"></a>00314                          <span class="keywordflow">if</span> (isset($_FILES[$valFile][<span class="stringliteral">&#39;tmp_name&#39;</span>]) &amp;&amp; $_FILES[$valFile][<span class="stringliteral">&#39;tmp_name&#39;</span>]!=<span class="stringliteral">&quot;&quot;</span>) {
<a name="l00315"></a>00315                                         $valOrdre=<span class="stringliteral">&quot;selectOrdreFich&quot;</span>.$i.<span class="stringliteral">&quot;_&quot;</span>;
<a name="l00316"></a>00316                                         $valLib=<span class="stringliteral">&quot;textLibFich&quot;</span>.$i.<span class="stringliteral">&quot;_&quot;</span>;
<a name="l00317"></a>00317                                           $newFichier=<span class="keyword">new</span> <a class="code" href="class_fichier.html">Fichier</a>();
<a name="l00318"></a>00318                                           $newFichier-&gt;nomFichier=normaliza(basename($_FILES[$valFile][<span class="stringliteral">&#39;name&#39;</span>]));
<a name="l00319"></a>00319                                           $newFichier-&gt;tmp_name=$_FILES[$valFile][<span class="stringliteral">&#39;tmp_name&#39;</span>];  
<a name="l00320"></a>00320                                           $numfichier=$newFichier-&gt;creerFichier();
<a name="l00321"></a>00321                                           
<a name="l00322"></a>00322                                           <span class="comment">// On associe ensuite le fichier au paragraphe</span>
<a name="l00323"></a>00323                                           $newParag-&gt;numfichier=$numfichier;
<a name="l00324"></a>00324                                           $newParag-&gt;ordreFichier=$$valOrdre;
<a name="l00325"></a>00325                                           $newParag-&gt;libFichier=$$valLib;
<a name="l00326"></a>00326                                           $newParag-&gt;associerFichier(); 
<a name="l00327"></a>00327                                         
<a name="l00328"></a>00328                          }<span class="comment">//fin if ($$valSelect || $$valFile)</span>
<a name="l00329"></a>00329                    }<span class="comment">//fin du for</span>
<a name="l00330"></a>00330            <span class="comment">//}//fin if ($textTitrePara)</span>
<a name="l00331"></a>00331            
<a name="l00332"></a>00332            <span class="comment">/* * Association des parag existants : mise en commentaire le 12/01/09 car cela perturbe Claude </span>
<a name="l00333"></a>00333 <span class="comment">           if (is_array($checkPara)) {//On associe un paragraphe existant         </span>
<a name="l00334"></a>00334 <span class="comment">                   reset($checkPara);</span>
<a name="l00335"></a>00335 <span class="comment">                   while(list(,$val) = each($checkPara)) {</span>
<a name="l00336"></a>00336 <span class="comment">                          $ordrepara=&quot;selectOrdrePara&quot;.$val;</span>
<a name="l00337"></a>00337 <span class="comment">                          $colpara=&quot;selectType&quot;.$val;</span>
<a name="l00338"></a>00338 <span class="comment">                          $listepara=&quot;radioListe&quot;.$val;</span>
<a name="l00339"></a>00339 <span class="comment">                          $laPage=new Page();</span>
<a name="l00340"></a>00340 <span class="comment">                          $laPage-&gt;numpage=$numpage;</span>
<a name="l00341"></a>00341 <span class="comment">                          $laPage-&gt;numpara=$val;</span>
<a name="l00342"></a>00342 <span class="comment">                          $laPage-&gt;ordre=$$ordrepara;</span>
<a name="l00343"></a>00343 <span class="comment">                          $laPage-&gt;colonne=$$colpara;</span>
<a name="l00344"></a>00344 <span class="comment">                          $laPage-&gt;liste=$$listepara;</span>
<a name="l00345"></a>00345 <span class="comment">                          $laPage-&gt;ajouterParagraphe();  // On l&#39;ajoute ÔøΩ la page</span>
<a name="l00346"></a>00346 <span class="comment">                   }//fin du while</span>
<a name="l00347"></a>00347 <span class="comment">           }//fin if (is_array($checkPara))</span>
<a name="l00348"></a>00348 <span class="comment">           * */</span>
<a name="l00349"></a>00349            
<a name="l00350"></a>00350            <span class="keywordflow">if</span> (!$action) {<span class="comment">//on est en cr√©ation de page</span>
<a name="l00351"></a>00351                         <span class="keywordflow">if</span> (!$paragraphe) $pg_admin=<span class="stringliteral">&quot;lister-page&quot;</span>;      <span class="keywordflow">else</span> $creer_page=1;        
<a name="l00352"></a>00352            } <span class="keywordflow">else</span> {     <span class="comment">//on est en modification de page</span>
<a name="l00353"></a>00353                     <span class="keywordflow">if</span> (!$paragraphe) $onglet=<span class="stringliteral">&quot;mod_para&quot;</span>; <span class="keywordflow">else</span> $onglet=<span class="stringliteral">&quot;aj_para&quot;</span>;  
<a name="l00354"></a>00354            } 
<a name="l00355"></a>00355    <span class="comment">//}//fin if ($textTitrePara || is_array($checkPara))  </span>
<a name="l00356"></a>00356    
<a name="l00357"></a>00357 <span class="comment">/* ************* On liste les pages = tableau de bord soit a partir du menu &quot;Les pages&quot;, soit a partir du menu &quot;Gerer la publication&quot; ********************* */</span>
<a name="l00358"></a>00358 } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ($pg_admin==<span class="stringliteral">&quot;lister-page&quot;</span>) {
<a name="l00359"></a>00359   
<a name="l00360"></a>00360   <span class="keywordflow">if</span> ($numpageP) {<span class="comment">//on publie ou pas la page</span>
<a name="l00361"></a>00361         $publiPage=<span class="keyword">new</span> Page();
<a name="l00362"></a>00362         $publiPage-&gt;numpage= $numpageP;
<a name="l00363"></a>00363         <span class="keywordflow">if</span> ($publiee==<span class="stringliteral">&quot;o&quot;</span>) $publiPage-&gt;publiePage=<span class="stringliteral">&quot;n&quot;</span>; <span class="keywordflow">else</span> $publiPage-&gt;publiePage=<span class="stringliteral">&quot;o&quot;</span>;
<a name="l00364"></a>00364         $publiPage-&gt;publierPage();
<a name="l00365"></a>00365         $mes=<span class="stringliteral">&quot;La publication de la page est modifi√©e&quot;</span>;
<a name="l00366"></a>00366         $publi=1;
<a name="l00367"></a>00367   }      <span class="keywordflow">else</span> <span class="keywordflow">if</span> ($supPage) {<span class="comment">// suppression de la page</span>
<a name="l00368"></a>00368          $laPage=<span class="keyword">new</span> Page();
<a name="l00369"></a>00369          $laPage-&gt;numpage=$supPage;
<a name="l00370"></a>00370          $laPage-&gt;supprimerPage(); 
<a name="l00371"></a>00371          $mes=<span class="stringliteral">&quot;La page a √©t√© supprim√©e ainsi que les liens vers cette page (champs de type liens uniquement - attention, pas les </span>
<a name="l00372"></a>00372 <span class="stringliteral">         liens √©crits directement dans le texte d&#39;un paragraphe&quot;</span>;
<a name="l00373"></a>00373   }
<a name="l00374"></a>00374   
<a name="l00375"></a>00375 <span class="comment">/* ************* On visualise une page en mod admin = &gt; on a les onglets &quot;voir&quot;, &quot;modifier parametres generaux&quot;, &quot;modifier les paragraphes&quot;, etc...******** */</span>
<a name="l00376"></a>00376 } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ($pg_admin==<span class="stringliteral">&quot;content&quot;</span>) { 
<a name="l00377"></a>00377   <span class="keywordflow">if</span> ($action==<span class="stringliteral">&quot;modifier_page&quot;</span>) { <span class="comment">//on modifie les param√®tres g√©n√©raux de la page</span>
<a name="l00378"></a>00378    <span class="keywordflow">if</span> ($textNomG) {
<a name="l00379"></a>00379            <span class="comment">// Infos de la page    </span>
<a name="l00380"></a>00380            $modifPage = <span class="keyword">new</span> Page();      
<a name="l00381"></a>00381            $modifPage-&gt;numpage=$numpage; 
<a name="l00382"></a>00382            $modifPage-&gt;aliasPage=$textAlias;
<a name="l00383"></a>00383             
<a name="l00384"></a>00384            <span class="keywordflow">if</span> ($modifPage-&gt;verifierAlias()) {
<a name="l00385"></a>00385                    $modifPage-&gt;nomPageGoogle=$textNomG;
<a name="l00386"></a>00386                    $modifPage-&gt;lg=$selectLg;  
<a name="l00387"></a>00387                    $modifPage-&gt;titrePage=$textTitre;
<a name="l00388"></a>00388                         $modifPage-&gt;descrPage=$textDescr;
<a name="l00389"></a>00389                         $modifPage-&gt;keywPage=$textKeyw;
<a name="l00390"></a>00390                         $modifPage-&gt;id_m=$id;
<a name="l00391"></a>00391                         $modifPage-&gt;accueilPage=$radioAccueil; 
<a name="l00392"></a>00392                         $modifPage-&gt;accueilSite=$radioAccueilSite;       
<a name="l00393"></a>00393                         $modifPage-&gt;nomFichier=$textFichier;
<a name="l00394"></a>00394                         <span class="keywordflow">if</span> ($selectPhoto) {
<a name="l00395"></a>00395                           $modifPage-&gt;numphoto=$selectPhoto;
<a name="l00396"></a>00396                         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (isset($_FILES[<span class="stringliteral">&quot;fileModifPhoto&quot;</span>][<span class="stringliteral">&#39;tmp_name&#39;</span>]) &amp;&amp; $_FILES[<span class="stringliteral">&quot;fileModifPhoto&quot;</span>][<span class="stringliteral">&#39;tmp_name&#39;</span>]!=<span class="stringliteral">&quot;&quot;</span>) {
<a name="l00397"></a>00397                           $newPhoto=<span class="keyword">new</span> <a class="code" href="class_photo.html">Photo</a>();
<a name="l00398"></a>00398                           $newPhoto-&gt;nomPhoto=basename($_FILES[<span class="stringliteral">&quot;fileModifPhoto&quot;</span>][<span class="stringliteral">&#39;name&#39;</span>]);
<a name="l00399"></a>00399                           $newPhoto-&gt;tmp_name=$_FILES[<span class="stringliteral">&quot;fileModifPhoto&quot;</span>][<span class="stringliteral">&#39;tmp_name&#39;</span>];
<a name="l00400"></a>00400                           $modifPage-&gt;numphoto=$newPhoto-&gt;creerPhoto();
<a name="l00401"></a>00401                         }
<a name="l00402"></a>00402                         $modifPage-&gt;publiePage=$radioPubliee;
<a name="l00403"></a>00403                     $modifPage-&gt;modifierPage(); 
<a name="l00404"></a>00404                         
<a name="l00405"></a>00405                         <span class="keywordflow">if</span> (is_array($selectMenu)) {<span class="comment">//on associe la page √† un ou plusieurs menus</span>
<a name="l00406"></a>00406                           reset($selectMenu);
<a name="l00407"></a>00407                           <span class="keywordflow">while</span>(list(,$val) = each($selectMenu)) {
<a name="l00408"></a>00408                                           $list_menu=explode(<span class="stringliteral">&quot;-&quot;</span>,$val);
<a name="l00409"></a>00409                                           $leMenu=<span class="keyword">new</span> <a class="code" href="class_menu.html" title="cr√©ation, modification, suppression d&amp;#39;un menu">Menu</a>();
<a name="l00410"></a>00410                                           $leMenu-&gt;nummenu=$list_menu[0];
<a name="l00411"></a>00411                                           $leMenu-&gt;type=$list_menu[1];
<a name="l00412"></a>00412                                           $leMenu-&gt;numpage=$numpage;
<a name="l00413"></a>00413                                           $leMenu-&gt;associerPage();       
<a name="l00414"></a>00414                           }<span class="comment">//Fin du while</span>
<a name="l00415"></a>00415                         }
<a name="l00416"></a>00416                         $modifPage-&gt;creerAlias();
<a name="l00417"></a>00417                     $onglet=<span class="stringliteral">&quot;voir&quot;</span>;
<a name="l00418"></a>00418                 } <span class="keywordflow">else</span> { <span class="comment">//fin if ($modifPage-&gt;verifierAlias())</span>
<a name="l00419"></a>00419                    $mes=<span class="stringliteral">&quot;Attention, le nom du fichier existe d√©j√†. Vous devez choisir un autre nom pour cette page.&quot;</span>;
<a name="l00420"></a>00420                 }
<a name="l00421"></a>00421                  
<a name="l00422"></a>00422    }<span class="comment">//fin if ($textNomG)  </span>
<a name="l00423"></a>00423    
<a name="l00424"></a>00424         <span class="comment">/* ************* On modifie un paragraphe **************************************************************** */</span>
<a name="l00425"></a>00425         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ($action==<span class="stringliteral">&quot;modifier_parag&quot;</span>) {
<a name="l00426"></a>00426                 <span class="comment">//Les paragraphes</span>
<a name="l00427"></a>00427                 $modifPage = <span class="keyword">new</span> Page();
<a name="l00428"></a>00428             $modifPage-&gt;numpage=$numpage;
<a name="l00429"></a>00429                 $modifPage-&gt;id_m=$id; 
<a name="l00430"></a>00430                 $listparas=<span class="keyword">new</span> <a class="code" href="class_liste_paragraphes.html" title="Sp&amp;eacute;cifique IFIP.">ListeParagraphes</a>();      
<a name="l00431"></a>00431                 $listparas-&gt;numpage=$numpage; 
<a name="l00432"></a>00432                 $listparas-&gt;afficherListeParas();
<a name="l00433"></a>00433                 <span class="keywordflow">foreach</span> ($listparas as $paras) {
<a name="l00434"></a>00434                    $sup=<span class="stringliteral">&quot;checkSupPara&quot;</span>.$paras-&gt;numpara;
<a name="l00435"></a>00435                    <span class="keywordflow">if</span> ($$sup) {<span class="comment">//on supprime le paragraphe</span>
<a name="l00436"></a>00436                                 $modifPage-&gt;numpara=$paras-&gt;numpara;
<a name="l00437"></a>00437                                 $modifPage-&gt;enleverParagraphe();
<a name="l00438"></a>00438                    } <span class="keywordflow">else</span> {     <span class="comment">//on modifie le paragraphe</span>
<a name="l00439"></a>00439                                    $paras-&gt;titrePara=${<span class="stringliteral">&quot;textTitrePara&quot;</span>.$paras-&gt;numpara};
<a name="l00440"></a>00440                                    $paras-&gt;contenuPara=${<span class="stringliteral">&quot;textCont&quot;</span>.$paras-&gt;numpara};
<a name="l00441"></a>00441                                    $paras-&gt;modifierParagraphe();        <span class="comment">// On modifie le paragraphe</span>
<a name="l00442"></a>00442                                    
<a name="l00443"></a>00443                                    $modifPage-&gt;numpara=$paras-&gt;numpara;
<a name="l00444"></a>00444                                    $modifPage-&gt;ordre=${<span class="stringliteral">&quot;selectOrdre&quot;</span>.$paras-&gt;numpara};  
<a name="l00445"></a>00445                                    $modifPage-&gt;colonne=${<span class="stringliteral">&quot;selectType&quot;</span>.$paras-&gt;numpara};
<a name="l00446"></a>00446                                    $modifPage-&gt;liste=${<span class="stringliteral">&quot;radioListe&quot;</span>.$paras-&gt;numpara}; 
<a name="l00447"></a>00447                                    $modifPage-&gt;typeTitre=${<span class="stringliteral">&quot;radioTypeTitre&quot;</span>.$paras-&gt;numpara}; 
<a name="l00448"></a>00448                                    $modifPage-&gt;modifierParagraphe();  <span class="comment">// On modifie l&#39;association √† la page</span>
<a name="l00449"></a>00449 
<a name="l00450"></a>00450                                    <span class="keywordflow">for</span> ($i=1;$i&lt;=${<span class="stringliteral">&quot;nbLiens&quot;</span>.$paras-&gt;numpara};$i++) { <span class="comment">// On traite l&#39;ajout de liens</span>
<a name="l00451"></a>00451                                          $valUrl=<span class="stringliteral">&quot;textUrlLien&quot;</span>.$i.<span class="stringliteral">&quot;_&quot;</span>.$paras-&gt;numpara;
<a name="l00452"></a>00452                                          $valPage=<span class="stringliteral">&quot;selectPage&quot;</span>.$i.<span class="stringliteral">&quot;_&quot;</span>.$paras-&gt;numpara;
<a name="l00453"></a>00453                                          <span class="keywordflow">if</span> ($$valUrl || $$valPage) {
<a name="l00454"></a>00454                                                         $valLib=<span class="stringliteral">&quot;textLibLien&quot;</span>.$i.<span class="stringliteral">&quot;_&quot;</span>.$paras-&gt;numpara;
<a name="l00455"></a>00455                                                         $valTexte=<span class="stringliteral">&quot;textTexteLien&quot;</span>.$i.<span class="stringliteral">&quot;_&quot;</span>.$paras-&gt;numpara;
<a name="l00456"></a>00456                                                         $valOrdre=<span class="stringliteral">&quot;selectOrdreLien&quot;</span>.$i.<span class="stringliteral">&quot;_&quot;</span>.$paras-&gt;numpara;
<a name="l00457"></a>00457                                                         $valFen=<span class="stringliteral">&quot;radioFen&quot;</span>.$i.<span class="stringliteral">&quot;_&quot;</span>.$paras-&gt;numpara;
<a name="l00458"></a>00458                                                         $newLien=<span class="keyword">new</span> <a class="code" href="class_lien.html">Lien</a>(); 
<a name="l00459"></a>00459                                                         $newLien-&gt;numpara=$paras-&gt;numpara;
<a name="l00460"></a>00460                                                         $newLien-&gt;libLien=$$valLib;
<a name="l00461"></a>00461                                                         $newLien-&gt;texteLien=$$valTexte;
<a name="l00462"></a>00462                                                         <span class="keywordflow">if</span> ($$valPage) {
<a name="l00463"></a>00463                                                                 $pageLien= <span class="keyword">new</span> Page();
<a name="l00464"></a>00464                                                                 $pageLien-&gt;numpage=$$valPage;
<a name="l00465"></a>00465                                                                 $pageLien-&gt;infosPage();
<a name="l00466"></a>00466                                                                 $newLien-&gt;numpage=$$valPage;
<a name="l00467"></a>00467                                                                 $newLien-&gt;urlLien=$pageLien-&gt;aliasPage;
<a name="l00468"></a>00468                                                          } <span class="keywordflow">else</span> {
<a name="l00469"></a>00469                                                                 $newLien-&gt;urlLien=      $$valUrl;
<a name="l00470"></a>00470                                                          }
<a name="l00471"></a>00471                                                         $newLien-&gt;fenLien=$$valFen; 
<a name="l00472"></a>00472                                                         $newLien-&gt;ordreLien=$$valOrdre; 
<a name="l00473"></a>00473                                                         $newLien-&gt;creerLien();
<a name="l00474"></a>00474                                          }<span class="comment">//fin if ($$valUrl)</span>
<a name="l00475"></a>00475                                    }<span class="comment">//fin du for</span>
<a name="l00476"></a>00476                                    
<a name="l00477"></a>00477                                     <span class="keywordflow">for</span> ($i=1;$i&lt;=${<span class="stringliteral">&quot;nbPhotos&quot;</span>.$paras-&gt;numpara};$i++) { <span class="comment">// On traite l&#39;association de photos</span>
<a name="l00478"></a>00478                                          $valSelect=<span class="stringliteral">&quot;selectPhoto&quot;</span>.$i.<span class="stringliteral">&quot;_&quot;</span>.$paras-&gt;numpara;
<a name="l00479"></a>00479                                          $valFile=<span class="stringliteral">&quot;filePhoto&quot;</span>.$i.<span class="stringliteral">&quot;_&quot;</span>.$paras-&gt;numpara;
<a name="l00480"></a>00480                                          $valTaille=<span class="stringliteral">&quot;radioTaille&quot;</span>.$i.<span class="stringliteral">&quot;_&quot;</span>.$paras-&gt;numpara;
<a name="l00481"></a>00481                                          <span class="keywordflow">if</span> ($$valSelect || (isset($_FILES[$valFile][<span class="stringliteral">&#39;tmp_name&#39;</span>]) &amp;&amp; $_FILES[$valFile][<span class="stringliteral">&#39;tmp_name&#39;</span>]!=<span class="stringliteral">&quot;&quot;</span>)) {
<a name="l00482"></a>00482                                                         $valLeg=<span class="stringliteral">&quot;textLegPh&quot;</span>.$i.<span class="stringliteral">&quot;_&quot;</span>.$paras-&gt;numpara;
<a name="l00483"></a>00483                                                         $valOrdre=<span class="stringliteral">&quot;selectOrdrePhoto&quot;</span>.$i.<span class="stringliteral">&quot;_&quot;</span>.$paras-&gt;numpara;
<a name="l00484"></a>00484                                                         <span class="keywordflow">if</span> ($$valSelect) {<span class="comment">// on associe une photo existante</span>
<a name="l00485"></a>00485                                                                   $paras-&gt;numphoto=$$valSelect;
<a name="l00486"></a>00486                                                                   $paras-&gt;ordrePhoto=$$valOrdre;
<a name="l00487"></a>00487                                                                   $paras-&gt;legPhoto=$$valLeg;     
<a name="l00488"></a>00488                                                                   $paras-&gt;associerPhoto(); 
<a name="l00489"></a>00489                                                         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (isset($_FILES[$valFile][<span class="stringliteral">&#39;tmp_name&#39;</span>]) &amp;&amp; $_FILES[$valFile][<span class="stringliteral">&#39;tmp_name&#39;</span>]!=<span class="stringliteral">&quot;&quot;</span>) { <span class="comment">// on crÔøΩe une photo</span>
<a name="l00490"></a>00490                                                           $newPhoto=<span class="keyword">new</span> <a class="code" href="class_photo.html">Photo</a>();
<a name="l00491"></a>00491                                                           $newPhoto-&gt;nomPhoto=normaliza(basename($_FILES[$valFile][<span class="stringliteral">&#39;name&#39;</span>]));
<a name="l00492"></a>00492                                                           $newPhoto-&gt;tmp_name=$_FILES[$valFile][<span class="stringliteral">&#39;tmp_name&#39;</span>];
<a name="l00493"></a>00493                                                           $newPhoto-&gt;taille=$$valTaille;
<a name="l00494"></a>00494                                                           $numphoto=$newPhoto-&gt;creerPhoto();
<a name="l00495"></a>00495                                                           
<a name="l00496"></a>00496                                                           <span class="comment">// On associe ensuite la photo au paragraphe</span>
<a name="l00497"></a>00497                                                           $paras-&gt;numphoto=$numphoto;
<a name="l00498"></a>00498                                                           $paras-&gt;ordrePhoto=$$valOrdre;
<a name="l00499"></a>00499                                                           $paras-&gt;legPhoto=$$valLeg;
<a name="l00500"></a>00500                                                           $paras-&gt;associerPhoto(); 
<a name="l00501"></a>00501                                                         }
<a name="l00502"></a>00502                                                         
<a name="l00503"></a>00503                                          }<span class="comment">//fin if ($$valSelect || $$valFile)</span>
<a name="l00504"></a>00504                                    }<span class="comment">//fin du for</span>
<a name="l00505"></a>00505                                    
<a name="l00506"></a>00506                                    <span class="keywordflow">for</span> ($i=1;$i&lt;=${<span class="stringliteral">&quot;nbVideos&quot;</span>.$paras-&gt;numpara};$i++) { <span class="comment">// On traite l&#39;association de vid√©os</span>
<a name="l00507"></a>00507                                          $valSelect=<span class="stringliteral">&quot;selectVideo&quot;</span>.$i.<span class="stringliteral">&quot;_&quot;</span>.$paras-&gt;numpara;
<a name="l00508"></a>00508                                          $valFile=<span class="stringliteral">&quot;fileVideo&quot;</span>.$i.<span class="stringliteral">&quot;_&quot;</span>.$paras-&gt;numpara;
<a name="l00509"></a>00509                                          
<a name="l00510"></a>00510                                          <span class="keywordflow">if</span> ($$valSelect || (isset($_FILES[$valFile][<span class="stringliteral">&#39;tmp_name&#39;</span>]) &amp;&amp; $_FILES[$valFile][<span class="stringliteral">&#39;tmp_name&#39;</span>]!=<span class="stringliteral">&quot;&quot;</span>)) {
<a name="l00511"></a>00511                                                         $valLeg=<span class="stringliteral">&quot;textLegVi&quot;</span>.$i.<span class="stringliteral">&quot;_&quot;</span>.$paras-&gt;numpara;
<a name="l00512"></a>00512                                                         $valOrdre=<span class="stringliteral">&quot;selectOrdreVideo&quot;</span>.$i.<span class="stringliteral">&quot;_&quot;</span>.$paras-&gt;numpara;
<a name="l00513"></a>00513                                                         <span class="keywordflow">if</span> ($$valSelect) {<span class="comment">// on associe une vid√©o existante</span>
<a name="l00514"></a>00514                                                                   $paras-&gt;numvideo=$$valSelect;
<a name="l00515"></a>00515                                                                   $paras-&gt;ordreVideo=$$valOrdre;
<a name="l00516"></a>00516                                                                   $paras-&gt;legVideo=$$valLeg;
<a name="l00517"></a>00517                                                                   $paras-&gt;associerVideo(); 
<a name="l00518"></a>00518                                                         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (isset($_FILES[$valFile][<span class="stringliteral">&#39;tmp_name&#39;</span>]) &amp;&amp; $_FILES[$valFile][<span class="stringliteral">&#39;tmp_name&#39;</span>]!=<span class="stringliteral">&quot;&quot;</span>) { <span class="comment">// on cr√©e une vid√©o</span>
<a name="l00519"></a>00519                                                           $newVideo=<span class="keyword">new</span> <a class="code" href="class_video.html">Video</a>();
<a name="l00520"></a>00520                                                           $newVideo-&gt;nomVideo=normaliza(basename($_FILES[$valFile][<span class="stringliteral">&#39;name&#39;</span>]));
<a name="l00521"></a>00521                                                           $newVideo-&gt;tmp_name=$_FILES[$valFile][<span class="stringliteral">&#39;tmp_name&#39;</span>];
<a name="l00522"></a>00522                                                           $numvideo=$newVideo-&gt;creerVideo();
<a name="l00523"></a>00523                                                           
<a name="l00524"></a>00524                                                           <span class="comment">// On associe ensuite la vidÔøΩo au paragraphe</span>
<a name="l00525"></a>00525                                                           $paras-&gt;numvideo=$numvideo;
<a name="l00526"></a>00526                                                           $paras-&gt;ordreVideo=$$valOrdre;
<a name="l00527"></a>00527                                                           $paras-&gt;legVideo=$$valLeg;
<a name="l00528"></a>00528                                                           $paras-&gt;associerVideo(); 
<a name="l00529"></a>00529                                                         }
<a name="l00530"></a>00530                                                         
<a name="l00531"></a>00531                                          }<span class="comment">//fin if ($$valSelect || $$valFile)</span>
<a name="l00532"></a>00532                                    }<span class="comment">//fin du for</span>
<a name="l00533"></a>00533                                    
<a name="l00534"></a>00534                                     <span class="keywordflow">for</span> ($i=1;$i&lt;=${<span class="stringliteral">&quot;nbFichiers&quot;</span>.$paras-&gt;numpara};$i++) { <span class="comment">// On traite l&#39;association de fichiers</span>
<a name="l00535"></a>00535                                                  $valFile=<span class="stringliteral">&quot;fileFich&quot;</span>.$i.<span class="stringliteral">&quot;_&quot;</span>.$paras-&gt;numpara;
<a name="l00536"></a>00536                                                  <span class="keywordflow">if</span> (isset($_FILES[$valFile][<span class="stringliteral">&#39;tmp_name&#39;</span>]) &amp;&amp; $_FILES[$valFile][<span class="stringliteral">&#39;tmp_name&#39;</span>]!=<span class="stringliteral">&quot;&quot;</span>) {
<a name="l00537"></a>00537                                                                 $valOrdre=<span class="stringliteral">&quot;selectOrdreFich&quot;</span>.$i.<span class="stringliteral">&quot;_&quot;</span>.$paras-&gt;numpara;
<a name="l00538"></a>00538                                                                 $valLib=<span class="stringliteral">&quot;textLibFich&quot;</span>.$i.<span class="stringliteral">&quot;_&quot;</span>.$paras-&gt;numpara;
<a name="l00539"></a>00539                                                                   $newFichier=<span class="keyword">new</span> <a class="code" href="class_fichier.html">Fichier</a>();
<a name="l00540"></a>00540                                                                   $newFichier-&gt;nomFichier=normaliza(basename($_FILES[$valFile][<span class="stringliteral">&#39;name&#39;</span>]));
<a name="l00541"></a>00541                                                                   $newFichier-&gt;tmp_name=$_FILES[$valFile][<span class="stringliteral">&#39;tmp_name&#39;</span>];  
<a name="l00542"></a>00542                                                                   $numfichier=$newFichier-&gt;creerFichier();
<a name="l00543"></a>00543                                                                   
<a name="l00544"></a>00544                                                                   <span class="comment">// On associe ensuite la vid√©o au paragraphe</span>
<a name="l00545"></a>00545                                                                   $paras-&gt;numfichier=$numfichier;
<a name="l00546"></a>00546                                                                   $paras-&gt;ordreFichier=$$valOrdre;
<a name="l00547"></a>00547                                                                   $paras-&gt;libFichier=$$valLib;
<a name="l00548"></a>00548                                                                   $paras-&gt;associerFichier(); 
<a name="l00549"></a>00549                                                                 
<a name="l00550"></a>00550                                                  }<span class="comment">//fin if (isset($_FILES[$valFile][&#39;tmp_name&#39;]) &amp;&amp; $_FILES[$valFile][&#39;tmp_name&#39;]!=&quot;&quot;)</span>
<a name="l00551"></a>00551                                    }<span class="comment">//fin du for</span>
<a name="l00552"></a>00552                    }<span class="comment">//fin du else</span>
<a name="l00553"></a>00553                 }<span class="comment">//fin du foreach ($listparas as $paras)</span>
<a name="l00554"></a>00554                 $onglet=<span class="stringliteral">&quot;mod_para&quot;</span>;  
<a name="l00555"></a>00555         }<span class="comment">//fin  if ($action==&quot;modifier_parag&quot;)  </span>
<a name="l00556"></a>00556          
<a name="l00557"></a>00557 <span class="comment">/* ************* On ajoute ou on modifie un menu **************************************************************** */</span>
<a name="l00558"></a>00558 } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ($pg_admin==<span class="stringliteral">&quot;ajouter-menu&quot;</span>) {
<a name="l00559"></a>00559    <span class="keywordflow">if</span> ($textLibMenu) {
<a name="l00560"></a>00560            $newMenu = <span class="keyword">new</span> <a class="code" href="class_menu.html" title="cr√©ation, modification, suppression d&amp;#39;un menu">Menu</a>();  
<a name="l00561"></a>00561            $newMenu-&gt;type=$cont;
<a name="l00562"></a>00562            $newMenu-&gt;nummenu=$nummenu;  
<a name="l00563"></a>00563            $newMenu-&gt;nomMenu=$textLibMenu;
<a name="l00564"></a>00564            $newMenu-&gt;zone=$selectZoneMenu;
<a name="l00565"></a>00565            $newMenu-&gt;ordre=$selectOrdreMenu;
<a name="l00566"></a>00566            $newMenu-&gt;affiche=$radioAffich;
<a name="l00567"></a>00567            $newMenu-&gt;lg=$selectLg;
<a name="l00568"></a>00568            <span class="comment">//$newMenu-&gt;nomFichier=$textFichier;</span>
<a name="l00569"></a>00569            <span class="comment">//$newMenu-&gt;nomAlias=$textAliasFichier;</span>
<a name="l00570"></a>00570            <span class="keywordflow">if</span> ($selectRub) $newMenu-&gt;numfkey=$selectRub;
<a name="l00571"></a>00571            <span class="keywordflow">else</span> <span class="keywordflow">if</span> ($selectCat) $newMenu-&gt;numfkey=$selectCat;
<a name="l00572"></a>00572            <span class="keywordflow">if</span> (!$nummenu) $newMenu-&gt;creerMenu(); <span class="keywordflow">else</span>  $newMenu-&gt;modifierMenu();   
<a name="l00573"></a>00573            <span class="keywordflow">if</span> (!$nummenu) $mes=<span class="stringliteral">&quot;Le menu est cr√©√©&quot;</span>; <span class="keywordflow">else</span> $mes=<span class="stringliteral">&quot;Le menu est modifi√© !&quot;</span>;         
<a name="l00574"></a>00574            $pg_admin=<span class="stringliteral">&quot;lister-menu&quot;</span>;
<a name="l00575"></a>00575    }            
<a name="l00576"></a>00576    
<a name="l00577"></a>00577 <span class="comment">/* ************* On liste les menus ********************* */</span>
<a name="l00578"></a>00578 } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ($pg_admin==<span class="stringliteral">&quot;lister-menu&quot;</span>) {  
<a name="l00579"></a>00579    <span class="keywordflow">if</span> ($affic) {<span class="comment">//On affiche ou pas le menu</span>
<a name="l00580"></a>00580            $leMenu = <span class="keyword">new</span> <a class="code" href="class_menu.html" title="cr√©ation, modification, suppression d&amp;#39;un menu">Menu</a>();
<a name="l00581"></a>00581            <span class="keywordflow">if</span> ($numrub) {
<a name="l00582"></a>00582                   $leMenu-&gt;type=<span class="stringliteral">&quot;rubrique&quot;</span>;  
<a name="l00583"></a>00583                   $leMenu-&gt;nomkey=<span class="stringliteral">&quot;numrub&quot;</span>;
<a name="l00584"></a>00584                   $leMenu-&gt;nummenu=$numrub;
<a name="l00585"></a>00585            } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ($numcateg) {
<a name="l00586"></a>00586                   $leMenu-&gt;type=<span class="stringliteral">&quot;categorie&quot;</span>; 
<a name="l00587"></a>00587                   $leMenu-&gt;nomkey=<span class="stringliteral">&quot;numcateg&quot;</span>; 
<a name="l00588"></a>00588                   $leMenu-&gt;nummenu=$numcateg;
<a name="l00589"></a>00589            } <span class="keywordflow">else</span> {
<a name="l00590"></a>00590                   $leMenu-&gt;type=<span class="stringliteral">&quot;sscateg&quot;</span>;
<a name="l00591"></a>00591                   $leMenu-&gt;nomkey=<span class="stringliteral">&quot;numsscateg&quot;</span>; 
<a name="l00592"></a>00592                   $leMenu-&gt;nummenu=$numsscateg;
<a name="l00593"></a>00593            }
<a name="l00594"></a>00594            <span class="keywordflow">if</span> ($affic==<span class="stringliteral">&quot;o&quot;</span>) $leMenu-&gt;affiche=<span class="stringliteral">&quot;n&quot;</span>; <span class="keywordflow">else</span> $leMenu-&gt;affiche=<span class="stringliteral">&quot;o&quot;</span>;
<a name="l00595"></a>00595            $leMenu-&gt;afficherMenu();             
<a name="l00596"></a>00596    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ($supMenu) {<span class="comment">//on supprime le menu (si admin)</span>
<a name="l00597"></a>00597                 $leMenu = <span class="keyword">new</span> <a class="code" href="class_menu.html" title="cr√©ation, modification, suppression d&amp;#39;un menu">Menu</a>();
<a name="l00598"></a>00598                 $leMenu-&gt;nummenu=$supMenu;
<a name="l00599"></a>00599                 $leMenu-&gt;type=$type; 
<a name="l00600"></a>00600                 $leMenu-&gt;supprimerMenu();
<a name="l00601"></a>00601                 $mes=<span class="stringliteral">&quot;Le menu est supprim√© !&quot;</span>;
<a name="l00602"></a>00602    }   
<a name="l00603"></a>00603    
<a name="l00604"></a>00604 <span class="comment">/* ************* Decrire le site ********************* */</span>
<a name="l00605"></a>00605 } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ($pg_admin==<span class="stringliteral">&quot;admin-site&quot;</span>) {  
<a name="l00606"></a>00606    <span class="keywordflow">if</span> ($textUrl) {
<a name="l00607"></a>00607                 <span class="keywordflow">if</span> ($res_site&gt;0) {                                      
<a name="l00608"></a>00608                         mysql_query(<span class="stringliteral">&quot;UPDATE if_site SET url=&#39;$textUrl&#39;, path=&#39;$textPath&#39;, pied_de_page=&#39;$textPied&#39;&quot;</span>);
<a name="l00609"></a>00609                 } <span class="keywordflow">else</span> {
<a name="l00610"></a>00610                    mysql_query(<span class="stringliteral">&quot;INSERT INTO if_site     (url,path,pied_de_page) VALUES (&#39;$textUrl&#39;,&#39;$textPath&#39;,&#39;$textPied&#39;)&quot;</span>);
<a name="l00611"></a>00611                 }
<a name="l00612"></a>00612                 $mes=<span class="stringliteral">&quot;Les param√®tres sont enregistr√©s&quot;</span>;
<a name="l00613"></a>00613    }     
<a name="l00614"></a>00614    
<a name="l00615"></a>00615 <span class="comment">/* ************* Liste des utilisateurs du backoffice (de l&#39;admin) ********************* */</span>
<a name="l00616"></a>00616 } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ($pg_admin==<span class="stringliteral">&quot;lister-uti&quot;</span>) {
<a name="l00617"></a>00617   <span class="keywordflow">if</span> ($act) {
<a name="l00618"></a>00618         $modifUti = <span class="keyword">new</span> <a class="code" href="class_utilisateur.html">Utilisateur</a>();
<a name="l00619"></a>00619         $modifUti-&gt;numuti=$numuti;
<a name="l00620"></a>00620         <span class="keywordflow">if</span> ($act==<span class="stringliteral">&quot;o&quot;</span>) $modifUti-&gt;actif=<span class="stringliteral">&quot;n&quot;</span>; <span class="keywordflow">else</span> $modifUti-&gt;actif=<span class="stringliteral">&quot;o&quot;</span>;
<a name="l00621"></a>00621         $modifUti-&gt;activerUti();        
<a name="l00622"></a>00622   }     
<a name="l00623"></a>00623   
<a name="l00624"></a>00624 <span class="comment">/* ************* Ajouter un utilisateur ********************* */</span>
<a name="l00625"></a>00625 } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ($pg_admin==<span class="stringliteral">&quot;ajouter-uti&quot;</span>) {
<a name="l00626"></a>00626    <span class="keywordflow">if</span> ($textLogin) {
<a name="l00627"></a>00627            $newUti = <span class="keyword">new</span> <a class="code" href="class_utilisateur.html">Utilisateur</a>(); 
<a name="l00628"></a>00628            $newUti-&gt;nom=$textNom;
<a name="l00629"></a>00629            $newUti-&gt;prenom=$textPrenom; 
<a name="l00630"></a>00630            $newUti-&gt;login=$textLogin;
<a name="l00631"></a>00631            $newUti-&gt;pwd=$textPwd;
<a name="l00632"></a>00632            $newUti-&gt;admin=$radioAdmin;   
<a name="l00633"></a>00633            $newUti-&gt;actif=$radioActif;  
<a name="l00634"></a>00634            $newUti-&gt;numuti=$numuti;  
<a name="l00635"></a>00635            <span class="keywordflow">if</span> (!$numuti) $newUti-&gt;creerUti(); <span class="keywordflow">else</span> $newUti-&gt;modifierUti();
<a name="l00636"></a>00636            <span class="keywordflow">if</span> (!$numuti) $mes=<span class="stringliteral">&quot;L\&#39;utilisateur est cr√©√©&quot;</span>; <span class="keywordflow">else</span> $mes=<span class="stringliteral">&quot;L\&#39;utilisateur est modifi√© !&quot;</span>;
<a name="l00637"></a>00637    } 
<a name="l00638"></a>00638    
<a name="l00639"></a>00639 <span class="comment">/* ************* Lister les contacts ********************* */</span>
<a name="l00640"></a>00640 } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ($pg_admin==<span class="stringliteral">&quot;lister-contact&quot;</span>) {
<a name="l00641"></a>00641   <span class="keywordflow">if</span> ($supcont) {
<a name="l00642"></a>00642         $supCont = <span class="keyword">new</span> <a class="code" href="class_contact.html" title="Gestion des contacts.">Contact</a>();
<a name="l00643"></a>00643         $supCont-&gt;numcontact=$supcont;
<a name="l00644"></a>00644         $supCont-&gt;supprimerContact();
<a name="l00645"></a>00645         $mes=<span class="stringliteral">&quot;Le contact est supprim√© !&quot;</span>;      
<a name="l00646"></a>00646   } 
<a name="l00647"></a>00647    
<a name="l00648"></a>00648 <span class="comment">/* ************* Ajouter un contact ********************* */</span>
<a name="l00649"></a>00649 } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ($pg_admin==<span class="stringliteral">&quot;ajouter-contact&quot;</span>) {
<a name="l00650"></a>00650    <span class="keywordflow">if</span> ($textNom) {
<a name="l00651"></a>00651            $newCont = <span class="keyword">new</span> <a class="code" href="class_contact.html" title="Gestion des contacts.">Contact</a>();    
<a name="l00652"></a>00652            $newCont-&gt;nom=$textNom;
<a name="l00653"></a>00653            $newCont-&gt;prenom=$textPrenom;        
<a name="l00654"></a>00654            $newCont-&gt;genre=$selectGenre;
<a name="l00655"></a>00655            $newCont-&gt;login=$textLogin;
<a name="l00656"></a>00656            $newCont-&gt;email=$textEmail;
<a name="l00657"></a>00657            $newCont-&gt;tel=$textTel;       
<a name="l00658"></a>00658            $newCont-&gt;fax=$textFax;      
<a name="l00659"></a>00659            $newCont-&gt;gsm=$textGsm;
<a name="l00660"></a>00660            $newCont-&gt;fonction=$textFonction;
<a name="l00661"></a>00661            $newCont-&gt;referent=$radioRefe;               
<a name="l00662"></a>00662            $newCont-&gt;numcontact=$numcontact;
<a name="l00663"></a>00663            
<a name="l00664"></a>00664            <span class="keywordflow">if</span> (is_array($selectCateg)) {
<a name="l00665"></a>00665                   $newCont-&gt;listcateg=$selectCateg;
<a name="l00666"></a>00666            } 
<a name="l00667"></a>00667             <span class="keywordflow">if</span> (is_array($selectSscateg)) {     
<a name="l00668"></a>00668                   $newCont-&gt;listsscateg=$selectSscateg;
<a name="l00669"></a>00669            }   
<a name="l00670"></a>00670            <span class="keywordflow">if</span> (!$numcontact) $newCont-&gt;creerContact(); <span class="keywordflow">else</span> $newCont-&gt;modifierContact();
<a name="l00671"></a>00671            <span class="keywordflow">if</span> (!$numcontact) $mes=<span class="stringliteral">&quot;Le contact est cr√©√©&quot;</span>; <span class="keywordflow">else</span> $mes=<span class="stringliteral">&quot;Le contact est modifi√©!&quot;</span>;        
<a name="l00672"></a>00672            $pg_admin=<span class="stringliteral">&quot;lister-contact&quot;</span>;
<a name="l00673"></a>00673    }
<a name="l00674"></a>00674 
<a name="l00675"></a>00675 <span class="comment">/* ************* Lister les formations ********************* */</span>
<a name="l00676"></a>00676 } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ($pg_admin==<span class="stringliteral">&quot;lister-formation&quot;</span>) {
<a name="l00677"></a>00677   <span class="keywordflow">if</span> ($supform) {
<a name="l00678"></a>00678         $supForm = <span class="keyword">new</span> <a class="code" href="class_formation.html" title="s&amp;eacute;pcifique IFIP">Formation</a>();
<a name="l00679"></a>00679         $supForm-&gt;numpara=$supform;
<a name="l00680"></a>00680         $supForm-&gt;numparafichier=$numparafichier;
<a name="l00681"></a>00681         $supForm-&gt;supprimerFormation();
<a name="l00682"></a>00682         $mes=<span class="stringliteral">&quot;La formation est supprim√©e !&quot;</span>;   
<a name="l00683"></a>00683   } 
<a name="l00684"></a>00684    
<a name="l00685"></a>00685 <span class="comment">/* ************* Ajouter ou modifier une formation ********************* */</span>
<a name="l00686"></a>00686 } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ($pg_admin==<span class="stringliteral">&quot;ajouter-forma&quot;</span>) {
<a name="l00687"></a>00687    <span class="keywordflow">if</span> ($textTitre) {
<a name="l00688"></a>00688            $cree=0;
<a name="l00689"></a>00689            $newForma = <span class="keyword">new</span> <a class="code" href="class_formation.html" title="s&amp;eacute;pcifique IFIP">Formation</a>(); 
<a name="l00690"></a>00690            $newForma-&gt;titrePara=$textTitre;     
<a name="l00691"></a>00691            $newForma-&gt;contenuPara=$textCont;
<a name="l00692"></a>00692            $newForma-&gt;datedeb_admin=$textDateDeb;       
<a name="l00693"></a>00693            $newForma-&gt;datefin_admin=$textDateFin;
<a name="l00694"></a>00694            $newForma-&gt;surMesure=$radioMesure;
<a name="l00695"></a>00695            $newForma-&gt;enligne=$radioEnligne;
<a name="l00696"></a>00696            $newForma-&gt;numpara=$numpara;
<a name="l00697"></a>00697            <span class="keywordflow">if</span> (!$numpara) {
<a name="l00698"></a>00698                  $numpara=$newForma-&gt;creerParagraphe(); 
<a name="l00699"></a>00699                  $newForma-&gt;creerFormation(); 
<a name="l00700"></a>00700                  $cree=1;
<a name="l00701"></a>00701            } <span class="keywordflow">else</span> {
<a name="l00702"></a>00702                  $newForma-&gt;modifierParagraphe();
<a name="l00703"></a>00703                  $newForma-&gt;modifierFormation();
<a name="l00704"></a>00704            } 
<a name="l00705"></a>00705            
<a name="l00706"></a>00706            <span class="keywordflow">if</span> (is_array($selectCateg)) {
<a name="l00707"></a>00707                   $newForma-&gt;listcateg=$selectCateg;
<a name="l00708"></a>00708                   $newForma-&gt;associerFormaCateg();
<a name="l00709"></a>00709            } 
<a name="l00710"></a>00710             <span class="keywordflow">if</span> (is_array($selectSscateg)) {     
<a name="l00711"></a>00711                   $newForma-&gt;listsscateg=$selectSscateg;
<a name="l00712"></a>00712                   $newForma-&gt;associerFormaSscateg();
<a name="l00713"></a>00713            }  
<a name="l00714"></a>00714            
<a name="l00715"></a>00715            
<a name="l00716"></a>00716            <span class="keywordflow">if</span> ($selectFich || (isset($_FILES[<span class="stringliteral">&quot;fileFiche&quot;</span>][<span class="stringliteral">&#39;tmp_name&#39;</span>]) &amp;&amp; $_FILES[<span class="stringliteral">&quot;fileFiche&quot;</span>][<span class="stringliteral">&#39;tmp_name&#39;</span>]!=<span class="stringliteral">&quot;&quot;</span>)) {
<a name="l00717"></a>00717                         <span class="keywordflow">if</span> ($selectFich) {<span class="comment">// on associe une fiche formation existante</span>
<a name="l00718"></a>00718                                   $newForma-&gt;numfichier=$selectFich;
<a name="l00719"></a>00719                                   $newForma-&gt;associerFichier(); 
<a name="l00720"></a>00720                         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (isset($_FILES[<span class="stringliteral">&quot;fileFiche&quot;</span>][<span class="stringliteral">&#39;tmp_name&#39;</span>]) &amp;&amp; $_FILES[<span class="stringliteral">&quot;fileFiche&quot;</span>][<span class="stringliteral">&#39;tmp_name&#39;</span>]!=<span class="stringliteral">&quot;&quot;</span>) { <span class="comment">// on cr√©e une formation</span>
<a name="l00721"></a>00721                           $newFiche=<span class="keyword">new</span> <a class="code" href="class_fichier.html">Fichier</a>();
<a name="l00722"></a>00722                           $newFiche-&gt;nomFichier=normaliza(basename($_FILES[<span class="stringliteral">&quot;fileFiche&quot;</span>][<span class="stringliteral">&#39;name&#39;</span>]));
<a name="l00723"></a>00723                           $newFiche-&gt;tmp_name=$_FILES[<span class="stringliteral">&quot;fileFiche&quot;</span>][<span class="stringliteral">&#39;tmp_name&#39;</span>]; 
<a name="l00724"></a>00724                           $numfichier=$newFiche-&gt;creerFichier();
<a name="l00725"></a>00725                           
<a name="l00726"></a>00726                           <span class="comment">// On associe ensuite la fiche √† la formation</span>
<a name="l00727"></a>00727                           $newForma-&gt;numfichier=$numfichier;
<a name="l00728"></a>00728                           $newForma-&gt;associerFichier(); 
<a name="l00729"></a>00729                         }
<a name="l00730"></a>00730          }<span class="comment">//fin if ($selectFich || (isset($_FILES[&quot;fileFiche&quot;][&#39;tmp_name&#39;]) &amp;&amp; $_FILES[&quot;fileFiche&quot;][&#39;tmp_name&#39;]!=&quot;&quot;))</span>
<a name="l00731"></a>00731                          
<a name="l00732"></a>00732            <span class="keywordflow">if</span> ($cree) $mes=<span class="stringliteral">&quot;La formation est cr√©√©e&quot;</span>; <span class="keywordflow">else</span> $mes=<span class="stringliteral">&quot;La formation est modifi√©e !&quot;</span>;        
<a name="l00733"></a>00733            $pg_admin=<span class="stringliteral">&quot;lister-formation&quot;</span>;
<a name="l00734"></a>00734    }<span class="comment">//fin if ($textTitre)</span>
<a name="l00735"></a>00735 
<a name="l00736"></a>00736 <span class="comment">/* ************* Lister les documentations ********************* */</span>
<a name="l00737"></a>00737 } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ($pg_admin==<span class="stringliteral">&quot;lister-doc&quot;</span>) {
<a name="l00738"></a>00738   <span class="keywordflow">if</span> ($supdoc) {
<a name="l00739"></a>00739         $supDoc = <span class="keyword">new</span> <a class="code" href="class_documentation.html" title="Classe Documentation : sp&amp;eacute;cifique IFIP.">Documentation</a>();
<a name="l00740"></a>00740         $supDoc-&gt;numpara=$supdoc;
<a name="l00741"></a>00741         $supDoc-&gt;numparafichier=$numparafichier;
<a name="l00742"></a>00742         $supDoc-&gt;supprimerDoc();
<a name="l00743"></a>00743         $mes=<span class="stringliteral">&quot;La documentation est supprim√©e !&quot;</span>;       
<a name="l00744"></a>00744   } 
<a name="l00745"></a>00745    
<a name="l00746"></a>00746 <span class="comment">/* ************* Ajouter ou modifier une documentation ********************* */</span>
<a name="l00747"></a>00747 } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ($pg_admin==<span class="stringliteral">&quot;ajouter-doc&quot;</span>) {
<a name="l00748"></a>00748    <span class="keywordflow">if</span> ($annuler) $pg_admin=<span class="stringliteral">&quot;lister-doc&quot;</span>;
<a name="l00749"></a>00749    <span class="keywordflow">else</span> <span class="keywordflow">if</span> ($selectType || $textNewType) {
<a name="l00750"></a>00750            $cree=0;
<a name="l00751"></a>00751            $newDoc = <span class="keyword">new</span> <a class="code" href="class_documentation.html" title="Classe Documentation : sp&amp;eacute;cifique IFIP.">Documentation</a>();       
<a name="l00752"></a>00752            <span class="keywordflow">if</span> ($textNewType) {
<a name="l00753"></a>00753                 $newDoc-&gt;new_type_doc=$textNewType;
<a name="l00754"></a>00754                 $type_doc=$newDoc-&gt;ajouterTypeDoc();
<a name="l00755"></a>00755                 $newDoc-&gt;type_doc=$type_doc;
<a name="l00756"></a>00756            } <span class="keywordflow">else</span> {
<a name="l00757"></a>00757                 $newDoc-&gt;type_doc=$selectType;  
<a name="l00758"></a>00758            }
<a name="l00759"></a>00759            $newDoc-&gt;titrePara=$textTitreFr;
<a name="l00760"></a>00760            $newDoc-&gt;titre_en=$textTitreEn;      
<a name="l00761"></a>00761            $newDoc-&gt;contenuPara=$textContFr;
<a name="l00762"></a>00762            $newDoc-&gt;contenu_en=$textContEn;
<a name="l00763"></a>00763            $newDoc-&gt;auteur=$textAuteur; 
<a name="l00764"></a>00764            $newDoc-&gt;ref_biblio=$textRefBib;     
<a name="l00765"></a>00765            $newDoc-&gt;date=$textDate;
<a name="l00766"></a>00766            $newDoc-&gt;date_libre=$textDateLibre;
<a name="l00767"></a>00767            $newDoc-&gt;reference=$textRef;
<a name="l00768"></a>00768            $newDoc-&gt;keyw=$textKeyw;
<a name="l00769"></a>00769            $newDoc-&gt;tarif=$textTarif;
<a name="l00770"></a>00770            $newDoc-&gt;poids=$textPoids;
<a name="l00771"></a>00771            <span class="comment">//d√©sactiv√© le 13/03/2009 $newDoc-&gt;pwd=$textPwd;</span>
<a name="l00772"></a>00772            $newDoc-&gt;acces_res=$radioAcces;
<a name="l00773"></a>00773            $newDoc-&gt;publiee=$radioPubliee;
<a name="l00774"></a>00774            $newDoc-&gt;une=$radioUne;
<a name="l00775"></a>00775            $newDoc-&gt;numpara=$numpara;
<a name="l00776"></a>00776            
<a name="l00777"></a>00777            <span class="keywordflow">if</span> (!$numpara) {
<a name="l00778"></a>00778                  $numpara=$newDoc-&gt;creerParagraphe(); 
<a name="l00779"></a>00779                  $newDoc-&gt;creerDoc(); 
<a name="l00780"></a>00780                  $cree=1;
<a name="l00781"></a>00781            } <span class="keywordflow">else</span> {
<a name="l00782"></a>00782                  $newDoc-&gt;modifierParagraphe();
<a name="l00783"></a>00783                  $newDoc-&gt;modifierDoc();
<a name="l00784"></a>00784            } 
<a name="l00785"></a>00785            
<a name="l00786"></a>00786            <span class="keywordflow">if</span> (is_array($selectCateg)) {
<a name="l00787"></a>00787                   $newDoc-&gt;listcateg=$selectCateg;
<a name="l00788"></a>00788                   $newDoc-&gt;associerFormaCateg();
<a name="l00789"></a>00789            } 
<a name="l00790"></a>00790             <span class="keywordflow">if</span> (is_array($selectSscateg)) {     
<a name="l00791"></a>00791                   $newDoc-&gt;listsscateg=$selectSscateg;
<a name="l00792"></a>00792                   $newDoc-&gt;associerFormaSscateg();
<a name="l00793"></a>00793            }  
<a name="l00794"></a>00794            
<a name="l00795"></a>00795            
<a name="l00796"></a>00796            <span class="comment">// Le fichier</span>
<a name="l00797"></a>00797            <span class="keywordflow">if</span> ($selectFich || (isset($_FILES[<span class="stringliteral">&quot;fileFiche&quot;</span>][<span class="stringliteral">&#39;tmp_name&#39;</span>]) &amp;&amp; $_FILES[<span class="stringliteral">&quot;fileFiche&quot;</span>][<span class="stringliteral">&#39;tmp_name&#39;</span>]!=<span class="stringliteral">&quot;&quot;</span>)) {
<a name="l00798"></a>00798                         <span class="keywordflow">if</span> ($selectFich) {<span class="comment">// on associe un fichier doc existant</span>
<a name="l00799"></a>00799                                   $newDoc-&gt;numfichier=$selectFich;
<a name="l00800"></a>00800                                   $newDoc-&gt;associerFichier(); 
<a name="l00801"></a>00801                         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (isset($_FILES[<span class="stringliteral">&quot;fileFiche&quot;</span>][<span class="stringliteral">&#39;tmp_name&#39;</span>]) &amp;&amp; $_FILES[<span class="stringliteral">&quot;fileFiche&quot;</span>][<span class="stringliteral">&#39;tmp_name&#39;</span>]!=<span class="stringliteral">&quot;&quot;</span>) { <span class="comment">// on cr√©e une formation</span>
<a name="l00802"></a>00802                           $newFiche=<span class="keyword">new</span> <a class="code" href="class_fichier.html">Fichier</a>();
<a name="l00803"></a>00803                           $newFiche-&gt;nomFichier=normaliza(basename($_FILES[<span class="stringliteral">&quot;fileFiche&quot;</span>][<span class="stringliteral">&#39;name&#39;</span>]));
<a name="l00804"></a>00804                           $newFiche-&gt;tmp_name=$_FILES[<span class="stringliteral">&quot;fileFiche&quot;</span>][<span class="stringliteral">&#39;tmp_name&#39;</span>]; 
<a name="l00805"></a>00805                           $numfichier=$newFiche-&gt;creerFichier();
<a name="l00806"></a>00806                           
<a name="l00807"></a>00807                           <span class="comment">// On associe ensuite la fiche √† la formation</span>
<a name="l00808"></a>00808                           $newDoc-&gt;numfichier=$numfichier;
<a name="l00809"></a>00809                           $newDoc-&gt;associerFichier(); 
<a name="l00810"></a>00810                         }
<a name="l00811"></a>00811          }<span class="comment">//fin if ($selectFich || (isset($_FILES[&quot;fileFiche&quot;][&#39;tmp_name&#39;]) &amp;&amp; $_FILES[&quot;fileFiche&quot;][&#39;tmp_name&#39;]!=&quot;&quot;))</span>
<a name="l00812"></a>00812           
<a name="l00813"></a>00813           <span class="comment">// La vignette (dont redimensionnement automatique des .jpg)</span>
<a name="l00814"></a>00814          <span class="keywordflow">if</span> ($selectPhoto || (isset($_FILES[<span class="stringliteral">&quot;filePhoto&quot;</span>][<span class="stringliteral">&#39;tmp_name&#39;</span>]) &amp;&amp; $_FILES[<span class="stringliteral">&quot;filePhoto&quot;</span>][<span class="stringliteral">&#39;tmp_name&#39;</span>]!=<span class="stringliteral">&quot;&quot;</span>)) {
<a name="l00815"></a>00815                                 <span class="keywordflow">if</span> ($selectPhoto) {<span class="comment">// on associe une photo existante</span>
<a name="l00816"></a>00816                                           $newDoc-&gt;numphoto=$selectPhoto;
<a name="l00817"></a>00817                                           $newDoc-&gt;associerPhoto(); 
<a name="l00818"></a>00818                                 } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (isset($_FILES[<span class="stringliteral">&quot;filePhoto&quot;</span>][<span class="stringliteral">&#39;tmp_name&#39;</span>]) &amp;&amp; $_FILES[<span class="stringliteral">&quot;filePhoto&quot;</span>][<span class="stringliteral">&#39;tmp_name&#39;</span>]!=<span class="stringliteral">&quot;&quot;</span>) { <span class="comment">// on cr√©e une photo</span>
<a name="l00819"></a>00819                                   $newPhoto=<span class="keyword">new</span> <a class="code" href="class_photo.html">Photo</a>();
<a name="l00820"></a>00820                                   $newPhoto-&gt;nomPhoto=normaliza(basename($_FILES[<span class="stringliteral">&quot;filePhoto&quot;</span>][<span class="stringliteral">&#39;name&#39;</span>]));
<a name="l00821"></a>00821                                   $newPhoto-&gt;tmp_name=$_FILES[<span class="stringliteral">&quot;filePhoto&quot;</span>][<span class="stringliteral">&#39;tmp_name&#39;</span>];
<a name="l00822"></a>00822                                   $valTaille=<span class="stringliteral">&quot;120&quot;</span>;
<a name="l00823"></a>00823                                   $newPhoto-&gt;taille=$$valTaille;
<a name="l00824"></a>00824                                   $numphoto=$newPhoto-&gt;creerPhoto();
<a name="l00825"></a>00825                                   
<a name="l00826"></a>00826                                   <span class="comment">// On associe ensuite la vignette √† la documentation</span>
<a name="l00827"></a>00827                                   $newDoc-&gt;numphoto=$numphoto;
<a name="l00828"></a>00828                                   $newDoc-&gt;associerPhoto(); 
<a name="l00829"></a>00829                                 }
<a name="l00830"></a>00830                                 
<a name="l00831"></a>00831                  }<span class="comment">//fin if ($selectPhoto || (isset($_FILES[&quot;filePhoto&quot;][&#39;tmp_name&#39;]) &amp;&amp; $_FILES[&quot;filePhoto&quot;][&#39;tmp_name&#39;]!=&quot;&quot;)) </span>
<a name="l00832"></a>00832                                                          
<a name="l00833"></a>00833            <span class="keywordflow">if</span> ($cree) $mes=<span class="stringliteral">&quot;La documentation est cr√©√©e&quot;</span>; <span class="keywordflow">else</span> $mes=<span class="stringliteral">&quot;La documentation est modifi√©e !&quot;</span>;        
<a name="l00834"></a>00834            $numpara=<span class="stringliteral">&quot;&quot;</span>;
<a name="l00835"></a>00835            $pg_admin=<span class="stringliteral">&quot;lister-doc&quot;</span>; 
<a name="l00836"></a>00836    }<span class="comment">//fin  else if ($selectType || $textNewType)</span>
<a name="l00837"></a>00837 
<a name="l00838"></a>00838 <span class="comment">/* ************* Lister les professionnels ********************* */</span>
<a name="l00839"></a>00839 } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ($pg_admin==<span class="stringliteral">&quot;lister-prof&quot;</span>) {
<a name="l00840"></a>00840   <span class="keywordflow">if</span> ($numclient &amp;&amp; $actif) {
<a name="l00841"></a>00841         $leClient= <span class="keyword">new</span> <a class="code" href="class_client.html" title="G&amp;egrave;re les diff&amp;eacute;rents clients.">Client</a>();
<a name="l00842"></a>00842         $leClient-&gt;numclient=$numclient;
<a name="l00843"></a>00843         <span class="keywordflow">if</span> ($actif==<span class="stringliteral">&quot;o&quot;</span>) $leClient-&gt;actif=<span class="stringliteral">&quot;n&quot;</span>; <span class="keywordflow">else</span> $leClient-&gt;actif=<span class="stringliteral">&quot;o&quot;</span>; 
<a name="l00844"></a>00844         $leClient-&gt;activerClient();
<a name="l00845"></a>00845   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ($supprof) {
<a name="l00846"></a>00846         $supProf = <span class="keyword">new</span> <a class="code" href="class_client.html" title="G&amp;egrave;re les diff&amp;eacute;rents clients.">Client</a>();
<a name="l00847"></a>00847         $supProf-&gt;numclient=$supprof;
<a name="l00848"></a>00848         $supProf-&gt;supprimerClient();
<a name="l00849"></a>00849         $mes=<span class="stringliteral">&quot;Le professionnel est supprim√© !&quot;</span>;        
<a name="l00850"></a>00850   } 
<a name="l00851"></a>00851    
<a name="l00852"></a>00852 <span class="comment">/* ************* Ajouter ou modifier un professionnel ********************* */</span>
<a name="l00853"></a>00853 } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ($pg_admin==<span class="stringliteral">&quot;ajouter-prof&quot;</span>) {
<a name="l00854"></a>00854   <span class="keywordflow">if</span> ($textNom) {
<a name="l00855"></a>00855            $newProf = <span class="keyword">new</span> <a class="code" href="class_client.html" title="G&amp;egrave;re les diff&amp;eacute;rents clients.">Client</a>();     
<a name="l00856"></a>00856            $newProf-&gt;raison=$textRaison;
<a name="l00857"></a>00857            $newProf-&gt;nom=$textNom;
<a name="l00858"></a>00858            $newProf-&gt;prenom=$textPrenom;
<a name="l00859"></a>00859            $newProf-&gt;email=$textEmail;
<a name="l00860"></a>00860            $newProf-&gt;pwd=$textPwd;
<a name="l00861"></a>00861            $newProf-&gt;actif=$radioActif;
<a name="l00862"></a>00862            $newProf-&gt;amont=$checkAmont;
<a name="l00863"></a>00863            $newProf-&gt;aval=$checkAval;
<a name="l00864"></a>00864            $newProf-&gt;adr1=$textAdr1;
<a name="l00865"></a>00865            $newProf-&gt;adr2=$textAdr2;
<a name="l00866"></a>00866            $newProf-&gt;cp=$textCp;
<a name="l00867"></a>00867            $newProf-&gt;ville=$textVille;
<a name="l00868"></a>00868            $newProf-&gt;pays=$selectPays;<span class="comment">//numpays</span>
<a name="l00869"></a>00869            $newProf-&gt;tel=$textTel;
<a name="l00870"></a>00870            $newProf-&gt;fax=$textFax;
<a name="l00871"></a>00871            $newProf-&gt;professionnel=<span class="stringliteral">&quot;o&quot;</span>;
<a name="l00872"></a>00872            $newProf-&gt;numclient=$numclient;
<a name="l00873"></a>00873              
<a name="l00874"></a>00874            <span class="comment">//note : attention $mes est en return de creerClient() et modifierClient() (a cause du site public)</span>
<a name="l00875"></a>00875            <span class="comment">//penser donc a gerer les ecrasements eventuels de variables</span>
<a name="l00876"></a>00876            <span class="comment">//par exemple : on ne veut pas $mes issu de modifierClient()</span>
<a name="l00877"></a>00877            <span class="keywordflow">if</span> (!$numclient) $mes=$newProf-&gt;creerClient(); <span class="keywordflow">else</span> $newProf-&gt;modifierClient(); 
<a name="l00878"></a>00878            <span class="keywordflow">if</span> (!$numclient &amp;&amp; !$mes) $mes=<span class="stringliteral">&quot;Le professionnel est cr√©√©&quot;</span>; <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!$numclient &amp;&amp; $mes) $mes=$mes; <span class="keywordflow">else</span> $mes=<span class="stringliteral">&quot;Le professionnel est modifi√©!&quot;</span>;   
<a name="l00879"></a>00879            $pg_admin=<span class="stringliteral">&quot;lister-prof&quot;</span>;
<a name="l00880"></a>00880    
<a name="l00881"></a>00881   } 
<a name="l00882"></a>00882 
<a name="l00883"></a>00883 <span class="comment">/* ************* Lister les clients ********************* */</span>
<a name="l00884"></a>00884 } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ($pg_admin==<span class="stringliteral">&quot;lister-client&quot;</span>) {
<a name="l00885"></a>00885   <span class="keywordflow">if</span> ($numclient &amp;&amp; $actif) {
<a name="l00886"></a>00886         $leClient= <span class="keyword">new</span> <a class="code" href="class_client.html" title="G&amp;egrave;re les diff&amp;eacute;rents clients.">Client</a>();
<a name="l00887"></a>00887         $leClient-&gt;numclient=$numclient;
<a name="l00888"></a>00888         <span class="keywordflow">if</span> ($actif==<span class="stringliteral">&quot;o&quot;</span>) $leClient-&gt;actif=<span class="stringliteral">&quot;n&quot;</span>; <span class="keywordflow">else</span> $leClient-&gt;actif=<span class="stringliteral">&quot;o&quot;</span>; 
<a name="l00889"></a>00889         $leClient-&gt;activerClient();
<a name="l00890"></a>00890   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ($supclient) {
<a name="l00891"></a>00891         $supClient = <span class="keyword">new</span> <a class="code" href="class_client.html" title="G&amp;egrave;re les diff&amp;eacute;rents clients.">Client</a>();
<a name="l00892"></a>00892         $supClient-&gt;numclient=$supclient;
<a name="l00893"></a>00893         $supClient-&gt;supprimerClient();
<a name="l00894"></a>00894         $mes=<span class="stringliteral">&quot;Le client est supprim√© !&quot;</span>;       
<a name="l00895"></a>00895   } 
<a name="l00896"></a>00896    
<a name="l00897"></a>00897 <span class="comment">/* ************* Modifier un client ********************* */</span>
<a name="l00898"></a>00898 } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ($pg_admin==<span class="stringliteral">&quot;modifier-client&quot;</span>) {
<a name="l00899"></a>00899   <span class="keywordflow">if</span> ($textNom) {
<a name="l00900"></a>00900            $modifClient = <span class="keyword">new</span> <a class="code" href="class_client.html" title="G&amp;egrave;re les diff&amp;eacute;rents clients.">Client</a>(); 
<a name="l00901"></a>00901            $modifClient-&gt;raison=$textRaison;
<a name="l00902"></a>00902            $modifClient-&gt;civilite=$selectCiv;
<a name="l00903"></a>00903            $modifClient-&gt;nom=$textNom;
<a name="l00904"></a>00904            $modifClient-&gt;prenom=$textPrenom;
<a name="l00905"></a>00905            $modifClient-&gt;fonction=$textFonction;
<a name="l00906"></a>00906            $modifClient-&gt;adr1=$textAdr1;
<a name="l00907"></a>00907            $modifClient-&gt;adr2=$textAdr2;
<a name="l00908"></a>00908            $modifClient-&gt;cp=$textCp;
<a name="l00909"></a>00909            $modifClient-&gt;ville=$textVille;
<a name="l00910"></a>00910            $modifClient-&gt;pays=$selectPays;
<a name="l00911"></a>00911            $modifClient-&gt;tel=$textTel;
<a name="l00912"></a>00912            $modifClient-&gt;fax=$textFax;
<a name="l00913"></a>00913            $modifClient-&gt;gsm=$textGsm;
<a name="l00914"></a>00914            $modifClient-&gt;email=$textEmail;
<a name="l00915"></a>00915            $modifClient-&gt;pwd=$textPwd;
<a name="l00916"></a>00916            $modifClient-&gt;actif=$radioActif;
<a name="l00917"></a>00917            $modifClient-&gt;numclient=$numclient;
<a name="l00918"></a>00918              
<a name="l00919"></a>00919            $modifClient-&gt;modifierClient();
<a name="l00920"></a>00920            $mes=<span class="stringliteral">&quot;Le client est modifi√©!&quot;</span>;      
<a name="l00921"></a>00921            $pg_admin=<span class="stringliteral">&quot;lister-client&quot;</span>;
<a name="l00922"></a>00922    
<a name="l00923"></a>00923   }     
<a name="l00924"></a>00924 
<a name="l00925"></a>00925 <span class="comment">/* ************* Lister les professionnels ********************* */</span>
<a name="l00926"></a>00926 } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ($pg_admin==<span class="stringliteral">&quot;lister-prof&quot;</span>) {
<a name="l00927"></a>00927   <span class="keywordflow">if</span> ($numclient &amp;&amp; $actif) {
<a name="l00928"></a>00928         $leClient= <span class="keyword">new</span> <a class="code" href="class_client.html" title="G&amp;egrave;re les diff&amp;eacute;rents clients.">Client</a>();
<a name="l00929"></a>00929         $leClient-&gt;numclient=$numclient;
<a name="l00930"></a>00930         <span class="keywordflow">if</span> ($actif==<span class="stringliteral">&quot;o&quot;</span>) $leClient-&gt;actif=<span class="stringliteral">&quot;n&quot;</span>; <span class="keywordflow">else</span> $leClient-&gt;actif=<span class="stringliteral">&quot;o&quot;</span>; 
<a name="l00931"></a>00931         $leClient-&gt;activerClient();
<a name="l00932"></a>00932   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ($supprof) {
<a name="l00933"></a>00933         $supProf = <span class="keyword">new</span> <a class="code" href="class_client.html" title="G&amp;egrave;re les diff&amp;eacute;rents clients.">Client</a>();
<a name="l00934"></a>00934         $supProf-&gt;numclient=$supprof;
<a name="l00935"></a>00935         $supProf-&gt;supprimerClient();
<a name="l00936"></a>00936         $mes=<span class="stringliteral">&quot;Le professionnel est supprim√© !&quot;</span>;        
<a name="l00937"></a>00937   } 
<a name="l00938"></a>00938    
<a name="l00939"></a>00939 <span class="comment">/* ************* Ajouter ou modifier une br√®ve internationale ********************* */</span>
<a name="l00940"></a>00940 } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ($pg_admin==<span class="stringliteral">&quot;ajouter-breve&quot;</span>) {
<a name="l00941"></a>00941   <span class="keywordflow">if</span> ($textTitre) {
<a name="l00942"></a>00942            $newBreve = <span class="keyword">new</span> <a class="code" href="class_breve.html" title="Sp√©cifique IFIP.">Breve</a>();     
<a name="l00943"></a>00943            $newBreve-&gt;titrePara=$textTitre;
<a name="l00944"></a>00944            $newBreve-&gt;contenuPara=$textCont;
<a name="l00945"></a>00945            $newBreve-&gt;date_breve=$textDate;
<a name="l00946"></a>00946            <span class="keywordflow">if</span> (!$selectPays) $newBreve-&gt;numpays=0; <span class="keywordflow">else</span> $newBreve-&gt;numpays=$selectPays;
<a name="l00947"></a>00947            $newBreve-&gt;source=$textSource;
<a name="l00948"></a>00948            
<a name="l00949"></a>00949            <span class="keywordflow">if</span> (!$numpara) {
<a name="l00950"></a>00950                 $numpara=$newBreve-&gt;creerParagraphe(); 
<a name="l00951"></a>00951                 $newBreve-&gt;creerBreve(); 
<a name="l00952"></a>00952                 $cree=1;
<a name="l00953"></a>00953            } <span class="keywordflow">else</span> {
<a name="l00954"></a>00954                  $newBreve-&gt;numpara=$numpara;
<a name="l00955"></a>00955                  $newBreve-&gt;modifierParagraphe();
<a name="l00956"></a>00956                 $newBreve-&gt;modifierBreve();
<a name="l00957"></a>00957            }
<a name="l00958"></a>00958            <span class="keywordflow">if</span> ($cree) $mes=<span class="stringliteral">&quot;La br√®ve est cr√©√©e&quot;</span>; <span class="keywordflow">else</span> $mes=<span class="stringliteral">&quot;La br√®ve est modifi√©e!&quot;</span>;       
<a name="l00959"></a>00959            $pg_admin=<span class="stringliteral">&quot;lister-breve&quot;</span>;
<a name="l00960"></a>00960    
<a name="l00961"></a>00961   } 
<a name="l00962"></a>00962   
<a name="l00963"></a>00963 <span class="comment">/* ************* Lister les br√®ves internationales ********************* */</span>
<a name="l00964"></a>00964 } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ($pg_admin==<span class="stringliteral">&quot;lister-breve&quot;</span>) {
<a name="l00965"></a>00965   <span class="keywordflow">if</span> ($supbreve) {
<a name="l00966"></a>00966         $supBreve = <span class="keyword">new</span> <a class="code" href="class_breve.html" title="Sp√©cifique IFIP.">Breve</a>();
<a name="l00967"></a>00967         $supBreve-&gt;numpara=$supbreve;
<a name="l00968"></a>00968         $supBreve-&gt;supprimerBreve();
<a name="l00969"></a>00969         $mes=<span class="stringliteral">&quot;La br√®ve est supprim√©e !&quot;</span>;      
<a name="l00970"></a>00970   } 
<a name="l00971"></a>00971 
<a name="l00972"></a>00972 <span class="comment">/* ************* Ajouter ou modifier une br√®ve d&#39;actualit√© ********************* */</span>
<a name="l00973"></a>00973 } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ($pg_admin==<span class="stringliteral">&quot;ajouter-actu&quot;</span>) {
<a name="l00974"></a>00974   <span class="keywordflow">if</span> ($textTitre) {
<a name="l00975"></a>00975            $newActu = <span class="keyword">new</span> <a class="code" href="class_actualite.html" title="Cette classe g&amp;egrave;re les actualit&amp;eacute;s.">Actualite</a>();  
<a name="l00976"></a>00976            $newActu-&gt;titrePara=$textTitre;
<a name="l00977"></a>00977            $newActu-&gt;contenuPara=$textCont;
<a name="l00978"></a>00978            $newActu-&gt;accueil=$radioAccueil;
<a name="l00979"></a>00979            $newActu-&gt;date_actu=$textDate;
<a name="l00980"></a>00980            
<a name="l00981"></a>00981            <span class="keywordflow">if</span> (!$numpara) {
<a name="l00982"></a>00982                 $numpara=$newActu-&gt;creerParagraphe(); 
<a name="l00983"></a>00983                 $newActu-&gt;creerActu(); 
<a name="l00984"></a>00984                 $cree=1;
<a name="l00985"></a>00985            } <span class="keywordflow">else</span> {
<a name="l00986"></a>00986                  $newActu-&gt;numpara=$numpara;
<a name="l00987"></a>00987                  $newActu-&gt;modifierParagraphe();
<a name="l00988"></a>00988                  $newActu-&gt;modifierActu();
<a name="l00989"></a>00989            }
<a name="l00990"></a>00990            
<a name="l00991"></a>00991            <span class="comment">//Le lien </span>
<a name="l00992"></a>00992                  <span class="keywordflow">if</span> ($textUrlLien) {
<a name="l00993"></a>00993                                 $newLien=<span class="keyword">new</span> <a class="code" href="class_lien.html">Lien</a>(); 
<a name="l00994"></a>00994                                 $newLien-&gt;numpara=$numpara;
<a name="l00995"></a>00995                                 $newLien-&gt;libLien=$textLibLien;
<a name="l00996"></a>00996                                 $newLien-&gt;texteLien=$textTexteLien;
<a name="l00997"></a>00997                                 $newLien-&gt;urlLien=$textUrlLien;
<a name="l00998"></a>00998                                 $newLien-&gt;fenLien=$radioFen; 
<a name="l00999"></a>00999                                 $newLien-&gt;creerLien();
<a name="l01000"></a>01000                  }
<a name="l01001"></a>01001           
<a name="l01002"></a>01002           <span class="comment">// La vignette</span>
<a name="l01003"></a>01003          <span class="keywordflow">if</span> ($selectPhoto || (isset($_FILES[<span class="stringliteral">&quot;filePhoto&quot;</span>][<span class="stringliteral">&#39;tmp_name&#39;</span>]) &amp;&amp; $_FILES[<span class="stringliteral">&quot;filePhoto&quot;</span>][<span class="stringliteral">&#39;tmp_name&#39;</span>]!=<span class="stringliteral">&quot;&quot;</span>)) {
<a name="l01004"></a>01004                         <span class="keywordflow">if</span> ($selectPhoto) {<span class="comment">// on associe une photo existante</span>
<a name="l01005"></a>01005                                   $newActu-&gt;numphoto=$selectPhoto;
<a name="l01006"></a>01006                                   $newActu-&gt;legPhoto=$textLegPh;
<a name="l01007"></a>01007                                   $newActu-&gt;associerPhoto(); 
<a name="l01008"></a>01008                         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (isset($_FILES[<span class="stringliteral">&quot;filePhoto&quot;</span>][<span class="stringliteral">&#39;tmp_name&#39;</span>]) &amp;&amp; $_FILES[<span class="stringliteral">&quot;filePhoto&quot;</span>][<span class="stringliteral">&#39;tmp_name&#39;</span>]!=<span class="stringliteral">&quot;&quot;</span>) { <span class="comment">// on crÔøΩe une photo</span>
<a name="l01009"></a>01009                           $newPhoto=<span class="keyword">new</span> <a class="code" href="class_photo.html">Photo</a>();
<a name="l01010"></a>01010                           $newPhoto-&gt;nomPhoto=normaliza(basename($_FILES[<span class="stringliteral">&quot;filePhoto&quot;</span>][<span class="stringliteral">&#39;name&#39;</span>]));
<a name="l01011"></a>01011                           $newPhoto-&gt;tmp_name=$_FILES[<span class="stringliteral">&quot;filePhoto&quot;</span>][<span class="stringliteral">&#39;tmp_name&#39;</span>];
<a name="l01012"></a>01012                           <span class="comment">// Quelle taille pour la vignette ? $newPhoto-&gt;taille=$$valTaille;</span>
<a name="l01013"></a>01013                           $numphoto=$newPhoto-&gt;creerPhoto();
<a name="l01014"></a>01014                           
<a name="l01015"></a>01015                           <span class="comment">// On associe ensuite la vignette √† l&#39;actualit√©</span>
<a name="l01016"></a>01016                           $newActu-&gt;numphoto=$numphoto;
<a name="l01017"></a>01017                           $newActu-&gt;legPhoto=$textLegPh;
<a name="l01018"></a>01018                           $newActu-&gt;associerPhoto(); 
<a name="l01019"></a>01019                         }
<a name="l01020"></a>01020                         
<a name="l01021"></a>01021          }<span class="comment">//fin if ($selectPhoto || (isset($_FILES[&quot;filePhoto&quot;][&#39;tmp_name&#39;]) &amp;&amp; $_FILES[&quot;filePhoto&quot;][&#39;tmp_name&#39;]!=&quot;&quot;)) </span>
<a name="l01022"></a>01022            
<a name="l01023"></a>01023            <span class="keywordflow">if</span> ($cree) $mes=<span class="stringliteral">&quot;La br√®ve d\&#39;actualit√© est cr√©√©e&quot;</span>; <span class="keywordflow">else</span> $mes=<span class="stringliteral">&quot;La br√®ve d\&#39;actualit√© est modifi√©e!&quot;</span>;   
<a name="l01024"></a>01024            $pg_admin=<span class="stringliteral">&quot;lister-actu&quot;</span>;
<a name="l01025"></a>01025    
<a name="l01026"></a>01026   } 
<a name="l01027"></a>01027   
<a name="l01028"></a>01028 <span class="comment">/* ************* Lister les br√®ves d&#39;actualit√© ********************* */</span>
<a name="l01029"></a>01029 } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ($pg_admin==<span class="stringliteral">&quot;lister-actu&quot;</span>) {
<a name="l01030"></a>01030   <span class="keywordflow">if</span> ($supactu) {
<a name="l01031"></a>01031         $supActu = <span class="keyword">new</span> <a class="code" href="class_actualite.html" title="Cette classe g&amp;egrave;re les actualit&amp;eacute;s.">Actualite</a>();
<a name="l01032"></a>01032         $supActu-&gt;numpara=$supactu;
<a name="l01033"></a>01033         $supActu-&gt;supprimerActu();
<a name="l01034"></a>01034         $mes=<span class="stringliteral">&quot;La br√®ve d\&#39;actualit√© est supprim√©e !&quot;</span>;        
<a name="l01035"></a>01035   } 
<a name="l01036"></a>01036 
<a name="l01037"></a>01037 <span class="comment">/* ************* Ajouter ou modifier un article ********************* */</span>
<a name="l01038"></a>01038 } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ($pg_admin==<span class="stringliteral">&quot;ajouter-arti&quot;</span>) {
<a name="l01039"></a>01039   <span class="keywordflow">if</span> ($textLibelle) {
<a name="l01040"></a>01040            $newArti = <span class="keyword">new</span> <a class="code" href="class_article.html" title="Sp√©cifique IFIP.">Article</a>();    
<a name="l01041"></a>01041            $newArti-&gt;libelle=$textLibelle;
<a name="l01042"></a>01042            
<a name="l01043"></a>01043            <span class="keywordflow">if</span> (!$numarticle) {
<a name="l01044"></a>01044                 $newArti-&gt;creerArti(); 
<a name="l01045"></a>01045                 $cree=1;
<a name="l01046"></a>01046            } <span class="keywordflow">else</span> {
<a name="l01047"></a>01047                  $newArti-&gt;numarticle=$numarticle;
<a name="l01048"></a>01048                  $newArti-&gt;modifierArti();
<a name="l01049"></a>01049            }
<a name="l01050"></a>01050            
<a name="l01051"></a>01051            <span class="keywordflow">if</span> ($cree) $mes=<span class="stringliteral">&quot;L\&#39;article est cr√©√© !&quot;</span>; <span class="keywordflow">else</span> $mes=<span class="stringliteral">&quot;L\&#39;article est modifi√© !&quot;</span>;    
<a name="l01052"></a>01052            $pg_admin=<span class="stringliteral">&quot;lister-arti&quot;</span>;
<a name="l01053"></a>01053    
<a name="l01054"></a>01054   } 
<a name="l01055"></a>01055   
<a name="l01056"></a>01056 <span class="comment">/* ************* Lister les articles ********************* */</span>
<a name="l01057"></a>01057 } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ($pg_admin==<span class="stringliteral">&quot;lister-arti&quot;</span>) {
<a name="l01058"></a>01058   <span class="keywordflow">if</span> ($suparti) {
<a name="l01059"></a>01059         $supArti = <span class="keyword">new</span> <a class="code" href="class_article.html" title="Sp√©cifique IFIP.">Article</a>();
<a name="l01060"></a>01060         $supArti-&gt;numarticle=$suparti;
<a name="l01061"></a>01061         $supArti-&gt;supprimerArti();
<a name="l01062"></a>01062         $mes=<span class="stringliteral">&quot;L\&#39;article est supprim√© !&quot;</span>;      
<a name="l01063"></a>01063   } 
<a name="l01064"></a>01064   
<a name="l01065"></a>01065 <span class="comment">/* ************* Voir/modifier une commande ********************* */</span>
<a name="l01066"></a>01066 } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ($pg_admin==<span class="stringliteral">&quot;modifier-com&quot;</span>) {
<a name="l01067"></a>01067   <span class="keywordflow">if</span> ($action==<span class="stringliteral">&quot;modifier&quot;</span>) {
<a name="l01068"></a>01068         $modifCom=<span class="keyword">new</span> <a class="code" href="class_commande.html" title="G&amp;egrave;re les commandes faites sur la boutique.">Commande</a>();
<a name="l01069"></a>01069         $modifCom-&gt;numcom=$numcom;
<a name="l01070"></a>01070         $modifCom-&gt;etat=$selectEtat;
<a name="l01071"></a>01071         $modifCom-&gt;suivi_coliposte=$textColiposte;   
<a name="l01072"></a>01072         $modifCom-&gt;modifierCommandeAdmin();
<a name="l01073"></a>01073         $modifCom-&gt;infosCommande();
<a name="l01074"></a>01074         <span class="comment">// envoi du mail</span>
<a name="l01075"></a>01075         <span class="keywordflow">if</span> ($selectEtat==<span class="stringliteral">&quot;2&quot;</span>) { <span class="comment">//commande validee (a reception du cheque / ou du virement)</span>
<a name="l01076"></a>01076                 $leClient = <span class="keyword">new</span> <a class="code" href="class_client.html" title="G&amp;egrave;re les diff&amp;eacute;rents clients.">Client</a>();
<a name="l01077"></a>01077                 $leClient-&gt;numclient = $modifCom-&gt;numclient;
<a name="l01078"></a>01078                 $leClient-&gt;infosClient();
<a name="l01079"></a>01079                 EnvoiMailCommandeChequeValidee($numcom,$leClient-&gt;email,<span class="stringliteral">&quot;&quot;</span>);
<a name="l01080"></a>01080                 $mes=<span class="stringliteral">&quot;La commande est modifi√©e ! Un mail de confirmation de la r√©ception du ch√®que a √©t√© envoy√© au client&quot;</span>;
<a name="l01081"></a>01081         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ($selectEtat==<span class="stringliteral">&quot;3&quot;</span>) { <span class="comment">// commande expediee</span>
<a name="l01082"></a>01082                 $leClient = <span class="keyword">new</span> <a class="code" href="class_client.html" title="G&amp;egrave;re les diff&amp;eacute;rents clients.">Client</a>();
<a name="l01083"></a>01083                 $leClient-&gt;numclient = $modifCom-&gt;numclient;
<a name="l01084"></a>01084                 $leClient-&gt;infosClient();
<a name="l01085"></a>01085                 EnvoiMailCommandeExpediee($numcom,$leClient-&gt;email,<span class="stringliteral">&quot;&quot;</span>);
<a name="l01086"></a>01086                 $mes=<span class="stringliteral">&quot;La commande est modifi√©e ! Un mail de d&#39;exp√©dition a √©t√© envoy√© au client&quot;</span>;
<a name="l01087"></a>01087         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ($selectEtat==<span class="stringliteral">&quot;4&quot;</span>) { <span class="comment">// commande archivee</span>
<a name="l01088"></a>01088                 $leClient = <span class="keyword">new</span> <a class="code" href="class_client.html" title="G&amp;egrave;re les diff&amp;eacute;rents clients.">Client</a>();
<a name="l01089"></a>01089                 $leClient-&gt;numclient = $modifCom-&gt;numclient;
<a name="l01090"></a>01090                 $leClient-&gt;infosClient();
<a name="l01091"></a>01091                 $mes=<span class="stringliteral">&quot;La commande a √©t√© archiv√©e&quot;</span>;
<a name="l01092"></a>01092         }
<a name="l01093"></a>01093         <span class="comment">//$mes=&quot;La commande est modifi√©e !&quot;;</span>
<a name="l01094"></a>01094         $pg_admin=<span class="stringliteral">&quot;lister-com&quot;</span>;
<a name="l01095"></a>01095   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ($action==<span class="stringliteral">&quot;annuler&quot;</span>) {
<a name="l01096"></a>01096         $pg_admin=<span class="stringliteral">&quot;lister-com&quot;</span>;
<a name="l01097"></a>01097   }
<a name="l01098"></a>01098 
<a name="l01099"></a>01099 <span class="comment">/* ************* Lister les commandes ********************* */</span>
<a name="l01100"></a>01100 } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ($pg_admin==<span class="stringliteral">&quot;lister-com&quot;</span>) {
<a name="l01101"></a>01101   <span class="keywordflow">if</span> ($supcom) {
<a name="l01102"></a>01102         $modifCom=<span class="keyword">new</span> <a class="code" href="class_commande.html" title="G&amp;egrave;re les commandes faites sur la boutique.">Commande</a>();
<a name="l01103"></a>01103         $modifCom-&gt;numcom=$supcom;         
<a name="l01104"></a>01104         $modifCom-&gt;supprimerCommande();
<a name="l01105"></a>01105         $mes=<span class="stringliteral">&quot;La commande est supprim√©e !&quot;</span>;
<a name="l01106"></a>01106         $pg_admin=<span class="stringliteral">&quot;lister-com&quot;</span>;
<a name="l01107"></a>01107   } 
<a name="l01108"></a>01108 
<a name="l01109"></a>01109 <span class="comment">/* ************* Lister les inscriptions aux formations ********************* */</span>
<a name="l01110"></a>01110 } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ($pg_admin==<span class="stringliteral">&quot;lister-inscri&quot;</span>) {
<a name="l01111"></a>01111   <span class="keywordflow">if</span> ($valide) {
<a name="l01112"></a>01112         $laForma=<span class="keyword">new</span> <a class="code" href="class_formation.html" title="s&amp;eacute;pcifique IFIP">Formation</a>();
<a name="l01113"></a>01113         $laForma-&gt;numpara=$valide;<span class="comment">//N¬∞ de la formation</span>
<a name="l01114"></a>01114         $laForma-&gt;datedeb_admin=$textDateDeb;
<a name="l01115"></a>01115         $laForma-&gt;datefin_admin=$textDateFin;
<a name="l01116"></a>01116         $laForma-&gt;validerForma($if_site[<span class="stringliteral">&quot;url&quot;</span>]);
<a name="l01117"></a>01117         
<a name="l01118"></a>01118         <span class="comment">//Mise √† jour des montants HT et TTC (IFIP =&gt; montantHT=montantTTC)</span>
<a name="l01119"></a>01119         $list_inscrits=$laForma-&gt;listerInscrits();
<a name="l01120"></a>01120         <span class="keywordflow">for</span> ($i=0; $i&lt;count($list_inscrits);$i++) {
<a name="l01121"></a>01121                 $list_detail=$list_inscrits[$i];
<a name="l01122"></a>01122                 $sesArticles=$list_detail[1];
<a name="l01123"></a>01123                 <span class="keywordflow">for</span> ($j=0; $j&lt;count($sesArticles);$j++) {
<a name="l01124"></a>01124                         $sonDetail=$sesArticles[$j];
<a name="l01125"></a>01125                         $tarif=<span class="stringliteral">&quot;textTarif&quot;</span>.$sonDetail[<span class="stringliteral">&quot;numcom&quot;</span>];
<a name="l01126"></a>01126                         $laCom = <span class="keyword">new</span> <a class="code" href="class_commande.html" title="G&amp;egrave;re les commandes faites sur la boutique.">Commande</a>();
<a name="l01127"></a>01127                         $laCom-&gt;numcom=$sonDetail[<span class="stringliteral">&quot;numcom&quot;</span>];
<a name="l01128"></a>01128                         $laCom-&gt;montantHT=$$tarif;
<a name="l01129"></a>01129                         $laCom-&gt;montantTTC=$$tarif;
<a name="l01130"></a>01130                         $laCom-&gt;modifierCommandeForma();
<a name="l01131"></a>01131                 }
<a name="l01132"></a>01132         }
<a name="l01133"></a>01133         
<a name="l01134"></a>01134         $mes=<span class="stringliteral">&quot;La formation est valid√©e !&quot;</span>;
<a name="l01135"></a>01135   } 
<a name="l01136"></a>01136 
<a name="l01137"></a>01137 <span class="comment">/* ************* On se d√©connecte **************************************************************** */</span>
<a name="l01138"></a>01138 } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ($decon) {
<a name="l01139"></a>01139         $uti-&gt;deconnecte();
<a name="l01140"></a>01140         mysql_close();
<a name="l01141"></a>01141         HEADER(<span class="stringliteral">&quot;Location: admin/index.php&quot;</span>);
<a name="l01142"></a>01142 }
<a name="l01143"></a>01143 <span class="comment">/* ************* On se d√©connecte de l&#39;espace pro ********************************************************* */</span>
<a name="l01144"></a>01144 
<a name="l01145"></a>01145 } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ($deconpro || $deconclient) { <span class="comment">// fin if ($id)</span>
<a name="l01146"></a>01146         unset($_SESSION[<span class="stringliteral">&#39;numprof&#39;</span>]);
<a name="l01147"></a>01147         unset($_SESSION[<span class="stringliteral">&#39;numclient&#39;</span>]);
<a name="l01148"></a>01148 
<a name="l01149"></a>01149 <span class="comment">//Toutes les pages sp√©cifiques</span>
<a name="l01150"></a>01150 } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ($spec) { <span class="comment">// fin if ($id) else if ($deconpro)</span>
<a name="l01151"></a>01151        
<a name="l01152"></a>01152 <span class="comment">/* ************* Page sp√©cifique contact.php du site public pour envoyer un courriel **************************************************************** */</span>
<a name="l01153"></a>01153  <span class="keywordflow">if</span> ($spec==<span class="stringliteral">&quot;contact&quot;</span>) {
<a name="l01154"></a>01154         <span class="keywordflow">if</span> ($action==<span class="stringliteral">&quot;seConnecter&quot;</span>) {
<a name="l01155"></a>01155                 $client=<span class="keyword">new</span> <a class="code" href="class_client.html" title="G&amp;egrave;re les diff&amp;eacute;rents clients.">Client</a>();
<a name="l01156"></a>01156                 $client-&gt;email=$textEmailCpte;
<a name="l01157"></a>01157                 $client-&gt;pwd=$textPwdCpte;
<a name="l01158"></a>01158                 $mes=$client-&gt;connecte();
<a name="l01159"></a>01159                 $client-&gt;numclient=$_SESSION[<span class="stringliteral">&#39;numclient&#39;</span>];
<a name="l01160"></a>01160                 $client-&gt;infosClient();
<a name="l01161"></a>01161                 <span class="keywordflow">if</span> ($mes) $action=<span class="stringliteral">&quot;&quot;</span>;
<a name="l01162"></a>01162         }
<a name="l01163"></a>01163         <span class="keywordflow">if</span> ($textMess) {
<a name="l01164"></a>01164                 $leContact= <span class="keyword">new</span> <a class="code" href="class_contact.html" title="Gestion des contacts.">Contact</a>();
<a name="l01165"></a>01165                 <span class="keywordflow">if</span>($numcontact) $leContact-&gt;numcontact=$numcontact;
<a name="l01166"></a>01166                 <span class="keywordflow">else</span> $leContact-&gt;numcontact=<span class="stringliteral">&quot;15&quot;</span>;  <span class="comment">//15 = siege social ifip</span>
<a name="l01167"></a>01167                 $leContact-&gt;infosContact();
<a name="l01168"></a>01168                 
<a name="l01169"></a>01169                 $prenom=Majuscules(strip_tags($textPrenom));
<a name="l01170"></a>01170                 $nom=Majuscules(strip_tags($textNom));
<a name="l01171"></a>01171                 $societe=Majuscules(strip_tags($textSociete));
<a name="l01172"></a>01172                 $ville=Majuscules(strip_tags($textVille));
<a name="l01173"></a>01173                 $pays=utf8_encode(SelectSimple(<span class="stringliteral">&quot;pays&quot;</span>,<span class="stringliteral">&quot;if_pays&quot;</span>,<span class="stringliteral">&quot;numpays&quot;</span>,$selectPays));
<a name="l01174"></a>01174                 $objet=Majuscules(strip_tags($textObjet));
<a name="l01175"></a>01175                 
<a name="l01176"></a>01176                 $corps.=<span class="stringliteral">&quot;Bonjour &quot;</span>.$leContact-&gt;prenom.<span class="stringliteral">&quot; &quot;</span>.$leContact-&gt;nom.<span class="stringliteral">&quot;,&lt;br /&gt;&quot;</span>;
<a name="l01177"></a>01177                 $corps.=<span class="stringliteral">&quot;Voici un message en provenance de ifip.asso.fr&lt;br /&gt;&lt;br /&gt;&quot;</span>;
<a name="l01178"></a>01178                 $corps.=<span class="stringliteral">&quot;-------------------------------------------------------------&lt;br /&gt;&quot;</span>;
<a name="l01179"></a>01179                 $corps.=<span class="stringliteral">&quot;DEMANDEUR : &quot;</span>.$prenom.<span class="stringliteral">&quot; &quot;</span>.$nom.<span class="stringliteral">&quot;&lt;br /&gt;&quot;</span>;
<a name="l01180"></a>01180                 <span class="keywordflow">if</span> ($societe) $corps.=<span class="stringliteral">&quot;SOCIETE / ORGANISME : &quot;</span>.$societe.<span class="stringliteral">&quot;&lt;br /&gt;&quot;</span>;
<a name="l01181"></a>01181                 <span class="keywordflow">if</span> ($textAdr1) $corps.=<span class="stringliteral">&quot;ADRESSE : &lt;br /&gt;&quot;</span>.$textAdr1.<span class="stringliteral">&quot;&lt;br /&gt;&quot;</span>;
<a name="l01182"></a>01182                 <span class="keywordflow">if</span> ($textAdr2) $corps.=$textAdr1.<span class="stringliteral">&quot;&lt;br /&gt;&quot;</span>;
<a name="l01183"></a>01183                 $corps.=$textCp.<span class="stringliteral">&quot; &quot;</span>.$ville.<span class="stringliteral">&quot;&lt;br /&gt;&quot;</span>.$pays.<span class="stringliteral">&quot;&lt;br /&gt;&quot;</span>;
<a name="l01184"></a>01184                 <span class="keywordflow">if</span> ($textTel) $corps.=<span class="stringliteral">&quot;TEL : &quot;</span>.$textTel.<span class="stringliteral">&quot;&lt;br /&gt;&quot;</span>;
<a name="l01185"></a>01185                 <span class="keywordflow">if</span> ($textFax) $corps.=<span class="stringliteral">&quot;FAX : &quot;</span>.$textFax.<span class="stringliteral">&quot;&lt;br /&gt;&quot;</span>;
<a name="l01186"></a>01186                 <span class="keywordflow">if</span> ($textEmail) $corps.=<span class="stringliteral">&quot;email : &quot;</span>.$textEmail.<span class="stringliteral">&quot;&lt;br /&gt;&quot;</span>;
<a name="l01187"></a>01187                 $corps.=<span class="stringliteral">&quot;-------------------------------------------------------------&lt;br /&gt;&quot;</span>;
<a name="l01188"></a>01188                 $corps.=$textMess;
<a name="l01189"></a>01189                 
<a name="l01190"></a>01190                 <span class="comment">//EnvoiMail($recipients,$From,$Bcc,$To,$ReturnPath,$ReplyTo,$Subject,$corps)</span>
<a name="l01191"></a>01191                 <span class="keywordflow">if</span> ($leContact-&gt;email) EnvoiMail($leContact-&gt;email,$prenom.<span class="stringliteral">&quot; &quot;</span>.$nom.<span class="stringliteral">&quot; &lt;&quot;</span>.($textEmail).<span class="stringliteral">&quot;&gt;&quot;</span>,<span class="stringliteral">&quot;&quot;</span>,$leContact-&gt;email,$textEmail,$textEmail,$objet,$corps);
<a name="l01192"></a>01192                 EnvoiMail(<span class="stringliteral">&quot;henriette.cuny@croisix.net&quot;</span>,$prenom.<span class="stringliteral">&quot; &quot;</span>.$nom.<span class="stringliteral">&quot; &lt;&quot;</span>.($textEmail).<span class="stringliteral">&quot;&gt;&quot;</span>,<span class="stringliteral">&quot;&quot;</span>,<span class="stringliteral">&quot;henriette.cuny@croisix.net&quot;</span>,$textEmail,$textEmail,$objet,$corps);
<a name="l01193"></a>01193                 $mes=<span class="stringliteral">&quot;Nous vous remercions pour votre message qui a bien √©t√© envoy√© √† &quot;</span>.$leContact-&gt;prenom.<span class="stringliteral">&quot; &quot;</span>.$leContact-&gt;nom;
<a name="l01194"></a>01194                 
<a name="l01195"></a>01195         }       
<a name="l01196"></a>01196         
<a name="l01197"></a>01197 <span class="comment">/* ************* Page sp√©cifique catalogue-ifip-institut-du-porc.php du site public pour ajouter une documentation au panier **************************************************************** */</span>
<a name="l01198"></a>01198 } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ($spec==<span class="stringliteral">&quot;catalogue-ifip-institut-du-porc&quot;</span>) {
<a name="l01199"></a>01199         <span class="comment">/* *if ($numdoc &amp;&amp; $textQte) {</span>
<a name="l01200"></a>01200 <span class="comment">                $laDoc=new Documentation();</span>
<a name="l01201"></a>01201 <span class="comment">                $laDoc-&gt;numpara=$numdoc;</span>
<a name="l01202"></a>01202 <span class="comment">                $laDoc-&gt;infosDoc();</span>
<a name="l01203"></a>01203 <span class="comment">                $ajoutPanier= new Panier();</span>
<a name="l01204"></a>01204 <span class="comment">                if ($_SESSION[&#39;numcom&#39;]) $ajoutPanier-&gt;numcom=$_SESSION[&#39;numcom&#39;];</span>
<a name="l01205"></a>01205 <span class="comment">                $ajoutPanier-&gt;ajouterArticle($numdoc,$textQte,$laDoc-&gt;reference,$laDoc-&gt;tarif);</span>
<a name="l01206"></a>01206 <span class="comment">                if (!$_SESSION[&#39;numcom&#39;])  $_SESSION[&#39;numcom&#39;]=$ajoutPanier-&gt;numcom;</span>
<a name="l01207"></a>01207 <span class="comment">                $spec=&quot;panier-ifip-institut-du-porc&quot;;</span>
<a name="l01208"></a>01208 <span class="comment">        }* */</span>
<a name="l01209"></a>01209 
<a name="l01210"></a>01210 <span class="comment">/* ************* Page sp√©cifique panier-ifip-institut-du-porc.php du site public pour visualiser le panier **************************************************************** */</span>
<a name="l01211"></a>01211 } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ($spec==<span class="stringliteral">&quot;panier-ifip-institut-du-porc&quot;</span>) {
<a name="l01212"></a>01212         <span class="comment">/* ***************** ETAPE 1 ************************************************************** */</span>
<a name="l01213"></a>01213         
<a name="l01214"></a>01214         <span class="keywordflow">if</span> ($numdoc &amp;&amp; $textQte &amp;&amp; !$action) {
<a name="l01215"></a>01215                 $laDoc=<span class="keyword">new</span> <a class="code" href="class_documentation.html" title="Classe Documentation : sp&amp;eacute;cifique IFIP.">Documentation</a>();
<a name="l01216"></a>01216                 $laDoc-&gt;numpara=$numdoc;
<a name="l01217"></a>01217                 $laDoc-&gt;infosDoc();
<a name="l01218"></a>01218                 
<a name="l01219"></a>01219                 $ajoutPanier= <span class="keyword">new</span> <a class="code" href="class_panier.html">Panier</a>();
<a name="l01220"></a>01220                 <span class="keywordflow">if</span> ($_SESSION[<span class="stringliteral">&#39;numcom&#39;</span>]) $ajoutPanier-&gt;numcom=$_SESSION[<span class="stringliteral">&#39;numcom&#39;</span>];
<a name="l01221"></a>01221                 <span class="keywordflow">for</span> ($i=0;$i&lt;1;$i++) $ajoutPanier-&gt;ajouterArticle($numdoc,<span class="stringliteral">&quot;Achat documentation&quot;</span>,$textQte,$laDoc-&gt;reference,$laDoc-&gt;tarif,0);
<a name="l01222"></a>01222                 <span class="keywordflow">if</span> (!$_SESSION[<span class="stringliteral">&#39;numcom&#39;</span>])  $_SESSION[<span class="stringliteral">&#39;numcom&#39;</span>]=$ajoutPanier-&gt;numcom;
<a name="l01223"></a>01223                 
<a name="l01224"></a>01224  
<a name="l01225"></a>01225         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ($supArt) {<span class="comment">// On supprime un article du panier</span>
<a name="l01226"></a>01226                 $supPanier=<span class="keyword">new</span> <a class="code" href="class_panier.html">Panier</a>();
<a name="l01227"></a>01227                 $supPanier-&gt;numdetail=$supArt;
<a name="l01228"></a>01228                 $supPanier-&gt;supprimerArticle();
<a name="l01229"></a>01229                 
<a name="l01230"></a>01230         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ($action==<span class="stringliteral">&quot;maj&quot;</span>) {<span class="comment">//on met √† jour la quantit√© d&#39;articles dans le panier</span>
<a name="l01231"></a>01231                 $modifPanier=<span class="keyword">new</span> <a class="code" href="class_panier.html">Panier</a>();
<a name="l01232"></a>01232                 $modifPanier-&gt;numcom=$_SESSION[<span class="stringliteral">&#39;numcom&#39;</span>];
<a name="l01233"></a>01233                 $list_art=$modifPanier-&gt;listerArticles();
<a name="l01234"></a>01234                 <span class="keywordflow">for</span> ($i=0;$i&lt;count($list_art);$i++) {
<a name="l01235"></a>01235                         $article=$list_art[$i];
<a name="l01236"></a>01236                         $modifQte=<span class="stringliteral">&quot;textQte&quot;</span>.$article[<span class="stringliteral">&quot;numdetail&quot;</span>];
<a name="l01237"></a>01237                         $modifPanier-&gt;numdetail=$article[<span class="stringliteral">&quot;numdetail&quot;</span>];
<a name="l01238"></a>01238                         $modifPanier-&gt;miseAJourQteArticle($$modifQte);
<a name="l01239"></a>01239                 }
<a name="l01240"></a>01240                 $mes=<span class="stringliteral">&quot;Votre panier a √©t√© mis √† jour&quot;</span>;
<a name="l01241"></a>01241         
<a name="l01242"></a>01242         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ($action==<span class="stringliteral">&quot;confirmerCom&quot;</span>) {<span class="comment">//clic sur bouton Etape2</span>
<a name="l01243"></a>01243                 $laCom= <span class="keyword">new</span> <a class="code" href="class_commande.html" title="G&amp;egrave;re les commandes faites sur la boutique.">Commande</a>();
<a name="l01244"></a>01244                 $laCom-&gt;numcom=$_SESSION[<span class="stringliteral">&#39;numcom&#39;</span>];
<a name="l01245"></a>01245                 <span class="keywordflow">if</span> (!$prix) {<span class="comment">//Ce n&#39;est pas un article cr√©√© √† la vol√©e</span>
<a name="l01246"></a>01246                         $laCom-&gt;pays=$selectPays;
<a name="l01247"></a>01247                         $laCom-&gt;modifierPays();
<a name="l01248"></a>01248                 }
<a name="l01249"></a>01249                 <span class="comment">//if ($_SESSION[&#39;numclient&#39;]) $etape=3; else $etape=2;</span>
<a name="l01250"></a>01250                 <span class="comment">//if (($prix &amp;&amp;!$_SESSION[&#39;numclient&#39;])  || !$_SESSION[&#39;numclient&#39;]) $etape=2; else $etape=3;</span>
<a name="l01251"></a>01251                 <span class="keywordflow">if</span> (!$_SESSION[<span class="stringliteral">&#39;numclient&#39;</span>]) $etape=2;
<a name="l01252"></a>01252                 <span class="keywordflow">else</span> <span class="keywordflow">if</span> ($_SESSION[<span class="stringliteral">&#39;numclient&#39;</span>] &amp;&amp; $prix) { unset($_SESSION[<span class="stringliteral">&#39;numclient&#39;</span>]); $etape=2;}
<a name="l01253"></a>01253                 <span class="keywordflow">else</span> $etape=3;
<a name="l01254"></a>01254 
<a name="l01255"></a>01255         <span class="comment">/* ***************** ETAPE 2 ******************************************************************** */</span>    
<a name="l01256"></a>01256         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ($action==<span class="stringliteral">&quot;seConnecter&quot;</span>) {<span class="comment">// Connexion du client</span>
<a name="l01257"></a>01257                 $client=<span class="keyword">new</span> <a class="code" href="class_client.html" title="G&amp;egrave;re les diff&amp;eacute;rents clients.">Client</a>();
<a name="l01258"></a>01258                 $client-&gt;email=$textEmailCpte;
<a name="l01259"></a>01259                 $client-&gt;pwd=$textPwdCpte;
<a name="l01260"></a>01260                 $mes=$client-&gt;connecte();
<a name="l01261"></a>01261 
<a name="l01262"></a>01262                 <span class="keywordflow">if</span> (!$mes) {
<a name="l01263"></a>01263                         $client-&gt;infosClient();
<a name="l01264"></a>01264                         <span class="keywordflow">if</span> (!$prix) {<span class="comment">//Ce n&#39;est pas un article cr√©√© √† la vol√©e</span>
<a name="l01265"></a>01265                                 $etape=3;               
<a name="l01266"></a>01266                         } <span class="keywordflow">else</span> {<span class="comment">//C&#39;est un article cr√©√© √† la vol√©e =&gt; redirection vers le choix du paiement</span>
<a name="l01267"></a>01267                                 $lePanier=<span class="keyword">new</span> <a class="code" href="class_panier.html">Panier</a>();
<a name="l01268"></a>01268                                 $lePanier-&gt;numcom=$_SESSION[<span class="stringliteral">&#39;numcom&#39;</span>];
<a name="l01269"></a>01269                                 
<a name="l01270"></a>01270                                 $laCom=<span class="keyword">new</span> <a class="code" href="class_commande.html" title="G&amp;egrave;re les commandes faites sur la boutique.">Commande</a>();
<a name="l01271"></a>01271                                 $laCom-&gt;numcom=$_SESSION[<span class="stringliteral">&#39;numcom&#39;</span>];
<a name="l01272"></a>01272                                 $laCom-&gt;numclient=$_SESSION[<span class="stringliteral">&#39;numclient&#39;</span>];
<a name="l01273"></a>01273                                 $laCom-&gt;modifierCommande(); <span class="comment">//association de la commande au client</span>
<a name="l01274"></a>01274                                 $etape=4;
<a name="l01275"></a>01275                                 
<a name="l01276"></a>01276                         }<span class="comment">//fin if ($prix)</span>
<a name="l01277"></a>01277                 } <span class="keywordflow">else</span> {
<a name="l01278"></a>01278                           $etape=2;
<a name="l01279"></a>01279                 }
<a name="l01280"></a>01280         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ($action==<span class="stringliteral">&quot;creerCompte&quot;</span>) {<span class="comment">// Cr√©er compte du client</span>
<a name="l01281"></a>01281                 $client=<span class="keyword">new</span> <a class="code" href="class_client.html" title="G&amp;egrave;re les diff&amp;eacute;rents clients.">Client</a>();
<a name="l01282"></a>01282                 $client-&gt;raison=$textSociete;
<a name="l01283"></a>01283                 $client-&gt;nom=$textNom;
<a name="l01284"></a>01284                 $client-&gt;prenom=$textPrenom;
<a name="l01285"></a>01285                 $client-&gt;civilite=$selectCiv;
<a name="l01286"></a>01286                 $client-&gt;adr1=$textAdr1;
<a name="l01287"></a>01287                 $client-&gt;adr2=$textAdr2;
<a name="l01288"></a>01288                 $client-&gt;cp=$textCp;
<a name="l01289"></a>01289                 $client-&gt;ville=$textVille;
<a name="l01290"></a>01290                 $client-&gt;pays=$selectPays;
<a name="l01291"></a>01291                 $client-&gt;tel=$textTel;
<a name="l01292"></a>01292                 $client-&gt;fax=$textFax;
<a name="l01293"></a>01293                 $client-&gt;email=$textEmail;
<a name="l01294"></a>01294                 $client-&gt;pwd=$textPwd;
<a name="l01295"></a>01295                 $client-&gt;actif=<span class="stringliteral">&quot;o&quot;</span>;
<a name="l01296"></a>01296                 $mes=$client-&gt;creerClient();
<a name="l01297"></a>01297                 <span class="keywordflow">if</span> (!$mes) {
<a name="l01298"></a>01298                         $client-&gt;connecte();
<a name="l01299"></a>01299                         $client-&gt;infosClient();
<a name="l01300"></a>01300                         <span class="keywordflow">if</span> (!$prix) {<span class="comment">//Ce n&#39;est pas un article cr√©√© √† la vol√©e</span>
<a name="l01301"></a>01301                                 $etape=3;
<a name="l01302"></a>01302                         } <span class="keywordflow">else</span> {<span class="comment">//C&#39;est un article cr√©√© √† la vol√©e =&gt; redirection vers choix du paiement</span>
<a name="l01303"></a>01303                                 $lePanier=<span class="keyword">new</span> <a class="code" href="class_panier.html">Panier</a>();
<a name="l01304"></a>01304                                 $lePanier-&gt;numcom=$_SESSION[<span class="stringliteral">&#39;numcom&#39;</span>];
<a name="l01305"></a>01305                                 
<a name="l01306"></a>01306                                 $laCom=<span class="keyword">new</span> <a class="code" href="class_commande.html" title="G&amp;egrave;re les commandes faites sur la boutique.">Commande</a>();
<a name="l01307"></a>01307                                 $laCom-&gt;numcom=$_SESSION[<span class="stringliteral">&#39;numcom&#39;</span>];
<a name="l01308"></a>01308                                 $laCom-&gt;numclient=$_SESSION[<span class="stringliteral">&#39;numclient&#39;</span>];
<a name="l01309"></a>01309                                 $laCom-&gt;modifierCommande(); <span class="comment">//association de la commande au client</span>
<a name="l01310"></a>01310                                 $etape=4;
<a name="l01311"></a>01311                                 
<a name="l01312"></a>01312                                 <span class="comment">// Ins√©rer ici redirection vers la banque </span>
<a name="l01313"></a>01313                                 
<a name="l01314"></a>01314                                 <span class="comment">/* * En retour de banque:</span>
<a name="l01315"></a>01315 <span class="comment">                                1. Utiliser la m√©thode $laCom-&gt;validerCommandeCB($CHAMP200,$CHAMP901,$CHAMP904,$CHAMP201) de l&#39;objet Commande pour modifier la commande dans la BD </span>
<a name="l01316"></a>01316 <span class="comment">                                2. Envoyer un mail au client - le mail peut √™tre envoy√© directement dans la m√©thode validerCommandeCB() de l&#39;objet Commande ou bien dans l&#39;objet Client (m√©thode √† cr√©er)</span>
<a name="l01317"></a>01317 <span class="comment">                                3. Envoyer un mail √† l&#39;admin IFIP</span>
<a name="l01318"></a>01318 <span class="comment">                                4. unset($_SESSION[&#39;numcom&#39;]);</span>
<a name="l01319"></a>01319 <span class="comment">                                * */</span>
<a name="l01320"></a>01320                         }<span class="comment">//fin if ($prix)</span>
<a name="l01321"></a>01321                 }
<a name="l01322"></a>01322         <span class="comment">/* ***************** ETAPE 3 ******************************************************************** */</span>    
<a name="l01323"></a>01323         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ($action==<span class="stringliteral">&quot;validerLivraison&quot;</span>) {<span class="comment">// Valide les infos sur la livraison et la Facturation</span>
<a name="l01324"></a>01324                 $laCom= <span class="keyword">new</span> <a class="code" href="class_commande.html" title="G&amp;egrave;re les commandes faites sur la boutique.">Commande</a>();
<a name="l01325"></a>01325                 $laCom-&gt;numclient=$_SESSION[<span class="stringliteral">&#39;numclient&#39;</span>];
<a name="l01326"></a>01326                 $laCom-&gt;numcom=$_SESSION[<span class="stringliteral">&#39;numcom&#39;</span>];
<a name="l01327"></a>01327                 $numpays=$laCom-&gt;getNumPays();
<a name="l01328"></a>01328                 $laCom-&gt;modifierCommande(); <span class="comment">//association de la commande au client</span>
<a name="l01329"></a>01329                 
<a name="l01330"></a>01330                 $leClient=<span class="keyword">new</span> <a class="code" href="class_client.html" title="G&amp;egrave;re les diff&amp;eacute;rents clients.">Client</a>();
<a name="l01331"></a>01331                 $leClient-&gt;numclient=$_SESSION[<span class="stringliteral">&#39;numclient&#39;</span>];
<a name="l01332"></a>01332                 
<a name="l01333"></a>01333                 $laCom-&gt;nom_f=$textNom_f;
<a name="l01334"></a>01334                 $laCom-&gt;prenom_f=$textPrenom_f;
<a name="l01335"></a>01335                 $laCom-&gt;tel_f=$textTel_f;
<a name="l01336"></a>01336                 $laCom-&gt;fax_f=$textFax_f;
<a name="l01337"></a>01337                 $laCom-&gt;raison_f=$textSociete_f;
<a name="l01338"></a>01338                 $laCom-&gt;adr1_f=$textAdr1_f;
<a name="l01339"></a>01339                 $laCom-&gt;adr2_f=$textAdr2_f;
<a name="l01340"></a>01340                 $laCom-&gt;cp_f=$textCp_f;
<a name="l01341"></a>01341                 $laCom-&gt;ville_f=$textVille_f;
<a name="l01342"></a>01342                 $laCom-&gt;pays_f=$selectPays_f;
<a name="l01343"></a>01343                 
<a name="l01344"></a>01344                 <span class="comment">/* On ne met plus √† jour les infos du client a partir des infos de facturation</span>
<a name="l01345"></a>01345 <span class="comment">                $leClient-&gt;nom=$textNom_f;</span>
<a name="l01346"></a>01346 <span class="comment">                $leClient-&gt;prenom=$textPrenom_f;</span>
<a name="l01347"></a>01347 <span class="comment">                $leClient-&gt;tel=$textTel_f;</span>
<a name="l01348"></a>01348 <span class="comment">                $leClient-&gt;fax=$textFax_f;</span>
<a name="l01349"></a>01349 <span class="comment">                $leClient-&gt;raison=$textSociete_f;</span>
<a name="l01350"></a>01350 <span class="comment">                $leClient-&gt;adr1=$textAdr1_f;</span>
<a name="l01351"></a>01351 <span class="comment">                $leClient-&gt;adr2=$textAdr2_f;</span>
<a name="l01352"></a>01352 <span class="comment">                $leClient-&gt;cp=$textCp_f;</span>
<a name="l01353"></a>01353 <span class="comment">                $leClient-&gt;ville=$textVille_f;</span>
<a name="l01354"></a>01354 <span class="comment">                $leClient-&gt;pays=$selectPays_f;</span>
<a name="l01355"></a>01355 <span class="comment">                </span>
<a name="l01356"></a>01356 <span class="comment">                $leClient-&gt;actif=&quot;o&quot;;</span>
<a name="l01357"></a>01357 <span class="comment">                $leClient-&gt;modifierClient();</span>
<a name="l01358"></a>01358 <span class="comment">                */</span>
<a name="l01359"></a>01359                 
<a name="l01360"></a>01360                 $laCom-&gt;nom_l=$textNom_l;
<a name="l01361"></a>01361                 $laCom-&gt;prenom_l=$textPrenom_l;
<a name="l01362"></a>01362                 $laCom-&gt;tel_l=$textTel_l;
<a name="l01363"></a>01363                 $laCom-&gt;fax_l=$textFax_l;
<a name="l01364"></a>01364                 $laCom-&gt;raison_l=$textSociete_l;
<a name="l01365"></a>01365                 $laCom-&gt;adr1_l=$textAdr1_l;
<a name="l01366"></a>01366                 $laCom-&gt;adr2_l=$textAdr2_l;
<a name="l01367"></a>01367                 $laCom-&gt;cp_l=$textCp_l;
<a name="l01368"></a>01368                 $laCom-&gt;ville_l=$textVille_l;
<a name="l01369"></a>01369                 $laCom-&gt;pays_l=$selectPays_l;
<a name="l01370"></a>01370                 
<a name="l01371"></a>01371                 <span class="keywordflow">if</span> ($numpays!=$selectPays_l) {
<a name="l01372"></a>01372                         $laCom-&gt;pays=$selectPays_l;
<a name="l01373"></a>01373                         $laCom-&gt;modifierPays();
<a name="l01374"></a>01374                 }
<a name="l01375"></a>01375                 $laCom-&gt;enregistrerLivraison(); <span class="comment">//enregistrement des infos de livraison facturation</span>
<a name="l01376"></a>01376                 
<a name="l01377"></a>01377                 <span class="comment">//la commande se transforme eventuellement en demande de devis</span>
<a name="l01378"></a>01378                 $lePanier=<span class="keyword">new</span> <a class="code" href="class_panier.html">Panier</a>();
<a name="l01379"></a>01379                 $lePanier-&gt;numcom=$_SESSION[<span class="stringliteral">&#39;numcom&#39;</span>];
<a name="l01380"></a>01380                 $lePanier-&gt;pays=$laCom-&gt;getNumPays();
<a name="l01381"></a>01381                 $lePanier-&gt;infosPanier();
<a name="l01382"></a>01382                 <span class="keywordflow">if</span> ($lePanier-&gt;pays!=<span class="stringliteral">&quot;247&quot;</span> &amp;&amp; $lePanier-&gt;totalPoids!=<span class="stringliteral">&quot;0,00&quot;</span>) {
<a name="l01383"></a>01383                         $laCom-&gt;montantHT=$lePanier-&gt;totalHT;
<a name="l01384"></a>01384                         $laCom-&gt;montantTTC=$lePanier-&gt;totalTTC;
<a name="l01385"></a>01385                         $laCom-&gt;fraisPort=$lePanier-&gt;fraisPort;
<a name="l01386"></a>01386                         $laCom-&gt;totalPoids=$lePanier-&gt;totalPoids;
<a name="l01387"></a>01387                         $montantDevis=$lePanier-&gt;totalTTC;
<a name="l01388"></a>01388                         
<a name="l01389"></a>01389                         $laCom-&gt;enregistrerDemandeDevis();
<a name="l01390"></a>01390                                 
<a name="l01391"></a>01391                         <span class="comment">//envoi du mail de demande de devis</span>
<a name="l01392"></a>01392                         $clientValide=<span class="keyword">new</span> <a class="code" href="class_client.html" title="G&amp;egrave;re les diff&amp;eacute;rents clients.">Client</a>();
<a name="l01393"></a>01393                         $clientValide-&gt;numclient=$_SESSION[<span class="stringliteral">&#39;numclient&#39;</span>];
<a name="l01394"></a>01394                         $clientValide-&gt;infosClient(); 
<a name="l01395"></a>01395                                                                                         
<a name="l01396"></a>01396                         EnvoiMailDevis($_SESSION[<span class="stringliteral">&#39;numcom&#39;</span>],$clientValide-&gt;email,$montantDevis);
<a name="l01397"></a>01397                         $etape=6;
<a name="l01398"></a>01398                 } <span class="keywordflow">else</span> $etape=4;<span class="comment">// !!!IMPORTANT : cette variable va modifier l&#39;action du form general qui va aller vers paiement.php</span>
<a name="l01399"></a>01399                                                 <span class="comment">//                                au lieu de index.php comme pour les autres etapes</span>
<a name="l01400"></a>01400                 
<a name="l01401"></a>01401         <span class="comment">/* ***************** ETAPE 4 ******************************************************************** */</span>    
<a name="l01402"></a>01402         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ($trans) { <span class="comment">// attention, la partie ci-dessous s&#39;execute apres lecture de paiement.php         </span>
<a name="l01403"></a>01403                 <span class="comment">// On est oblige a cause du fonctionnement specifique au Credit Agricole (lancement de leur ex√©cutable)</span>
<a name="l01404"></a>01404                 
<a name="l01405"></a>01405                         <span class="keywordflow">if</span>($auto) { <span class="comment">// r√®glement par cb, si il y a un numero d&#39;autorisation</span>
<a name="l01406"></a>01406                         
<a name="l01407"></a>01407                         <span class="comment">// VERIFICATION DE LA SIGNATURE DU PAIEMENT             </span>
<a name="l01408"></a>01408                 
<a name="l01409"></a>01409                         <span class="comment">//require(&quot;pbxtestsign.lib.php&quot;);</span>
<a name="l01410"></a>01410                         <span class="comment">//$CheckSig = pbxtestsign($auto,&quot;pubkey.pem&quot;);</span>
<a name="l01411"></a>01411                                 
<a name="l01412"></a>01412                         <span class="comment">//if( $CheckSig == 1 ) { //la signature du paiement est bonne, il s&#39;agit bien de e-transaction</span>
<a name="l01413"></a>01413                         
<a name="l01414"></a>01414                         
<a name="l01415"></a>01415                         <span class="comment">// pour eviter d&#39;envoyer le mail 2 fois en cas de retour sur le site</span>
<a name="l01416"></a>01416                         <span class="comment">//on recupere le numbq pour voir si la transaction a deja ete enregistree dans la base</span>
<a name="l01417"></a>01417                         <span class="comment">// si c&#39;est le cas pas besoin d&#39;enregistrer une 2eme fois et d&#39;envoyer le mail une 2eme fois    </span>
<a name="l01418"></a>01418                          $numbq=SelectSimple(<span class="stringliteral">&quot;numbq&quot;</span>,<span class="stringliteral">&quot;if_bo_bq&quot;</span>,<span class="stringliteral">&quot;numcom&quot;</span>,$ref,<span class="stringliteral">&quot;&quot;</span>);
<a name="l01419"></a>01419                          
<a name="l01420"></a>01420                          <span class="keywordflow">if</span>($numbq==<span class="stringliteral">&quot;&quot;</span>) {
<a name="l01421"></a>01421                                 $laComValide= <span class="keyword">new</span> <a class="code" href="class_commande.html" title="G&amp;egrave;re les commandes faites sur la boutique.">Commande</a>();
<a name="l01422"></a>01422                                 $laComValide-&gt;numcom=$ref;                      
<a name="l01423"></a>01423                                 $laComValide-&gt;etat=<span class="stringliteral">&quot;2&quot;</span>;
<a name="l01424"></a>01424                                 $laComValide-&gt;numerop=$trans;
<a name="l01425"></a>01425                                 $laComValide-&gt;auto=$auto;
<a name="l01426"></a>01426                                 $laComValide-&gt;montant=$montant;
<a name="l01427"></a>01427                                 $laComValide-&gt;validerCommandeCBBanque();<span class="comment">//enregistrement dans la table banque</span>
<a name="l01428"></a>01428                                                                                                                         
<a name="l01429"></a>01429                                 $clientValide=<span class="keyword">new</span> <a class="code" href="class_client.html" title="G&amp;egrave;re les diff&amp;eacute;rents clients.">Client</a>();
<a name="l01430"></a>01430                                 $clientValide-&gt;numclient=SelectSimple(<span class="stringliteral">&quot;numclient&quot;</span>,<span class="stringliteral">&quot;if_bo_com&quot;</span>,<span class="stringliteral">&quot;numcom&quot;</span>,$ref,<span class="stringliteral">&quot;&quot;</span>);
<a name="l01431"></a>01431                                 $clientValide-&gt;infosClient(); 
<a name="l01432"></a>01432                                                                                         
<a name="l01433"></a>01433                                 EnvoiMailCommande($laComValide-&gt;numcom,$clientValide-&gt;email,<span class="charliteral">&#39;o&#39;</span>);                                                                                       
<a name="l01434"></a>01434                                                                                                                                                                                 
<a name="l01435"></a>01435                                 $pageSpecMonCompte=<span class="keyword">new</span> Page();
<a name="l01436"></a>01436                                 $pageSpecMonCompte-&gt;pageSpecifique(<span class="stringliteral">&quot;compte-ifip&quot;</span>);
<a name="l01437"></a>01437                          }
<a name="l01438"></a>01438                 <span class="comment">//}  else { // la signature n&#39;est pas bonne, donc bug ou piratage</span>
<a name="l01439"></a>01439                         <span class="comment">//echo &quot;cl√© invalide&quot;;</span>
<a name="l01440"></a>01440                         <span class="comment">/*$laComValide= new Commande();</span>
<a name="l01441"></a>01441 <span class="comment">                        $laComValide-&gt;numcom=$_SESSION[&#39;numcom&#39;];</span>
<a name="l01442"></a>01442 <span class="comment">                        $laComValide-&gt;numclient=$_SESSION[&#39;numclient&#39;];         </span>
<a name="l01443"></a>01443 <span class="comment">                                                                                        </span>
<a name="l01444"></a>01444 <span class="comment">                        $clientValide=new Client();</span>
<a name="l01445"></a>01445 <span class="comment">                        $clientValide-&gt;numclient=$_SESSION[&#39;numclient&#39;];</span>
<a name="l01446"></a>01446 <span class="comment">                        $clientValide-&gt;infosClient(); </span>
<a name="l01447"></a>01447 <span class="comment">                                                                                        </span>
<a name="l01448"></a>01448 <span class="comment">                        EnvoiMailCommande($laComValide-&gt;numcom,$clientValide-&gt;email,&#39;&#39;);</span>
<a name="l01449"></a>01449 <span class="comment">                        $laComValide-&gt;supprimerCommande();              </span>
<a name="l01450"></a>01450 <span class="comment">                }*/</span>
<a name="l01451"></a>01451                         
<a name="l01452"></a>01452                         } <span class="keywordflow">else</span> { <span class="comment">// fin if ($auto)</span>
<a name="l01453"></a>01453                                         $laComValide= <span class="keyword">new</span> <a class="code" href="class_commande.html" title="G&amp;egrave;re les commandes faites sur la boutique.">Commande</a>();
<a name="l01454"></a>01454                                         $laComValide-&gt;numcom=$ref;              
<a name="l01455"></a>01455                                                                                         
<a name="l01456"></a>01456                                         $clientValide=<span class="keyword">new</span> <a class="code" href="class_client.html" title="G&amp;egrave;re les diff&amp;eacute;rents clients.">Client</a>();
<a name="l01457"></a>01457                                         $clientValide-&gt;numclient=SelectSimple(<span class="stringliteral">&quot;numclient&quot;</span>,<span class="stringliteral">&quot;if_bo_com&quot;</span>,<span class="stringliteral">&quot;numcom&quot;</span>,$ref,<span class="stringliteral">&quot;&quot;</span>);
<a name="l01458"></a>01458                                         $clientValide-&gt;infosClient(); 
<a name="l01459"></a>01459                                                                                         
<a name="l01460"></a>01460                                         EnvoiMailCommande($laComValide-&gt;numcom,$clientValide-&gt;email,<span class="stringliteral">&#39;&#39;</span>);
<a name="l01461"></a>01461                                         <span class="comment">//$laComValide-&gt;supprimerCommande();</span>
<a name="l01462"></a>01462                                         $laComValide-&gt;erreur=<span class="stringliteral">&quot;oui&quot;</span>;
<a name="l01463"></a>01463                                         $laComValide-&gt;validerCommandeCBErreur();                
<a name="l01464"></a>01464                         }
<a name="l01465"></a>01465                 <span class="comment">//Les infos concernant le panier (total du panier HT, total du panier TTC) sont dans l&#39;objet Panier (classe Panier.inc.php) pour les docs et dans l&#39;objet Commande (classe Commande.inc.php pour les formations) - voir Reglement par ch√®que ci- dessous</span>
<a name="l01466"></a>01466                         
<a name="l01467"></a>01467                         <span class="comment">/* * Achat de docs</span>
<a name="l01468"></a>01468 <span class="comment">                        $lePanier=new Panier();</span>
<a name="l01469"></a>01469 <span class="comment">                        $lePanier-&gt;numcom=$_SESSION[&#39;numcom&#39;];</span>
<a name="l01470"></a>01470 <span class="comment">                        $lePanier-&gt;infosPanier();</span>
<a name="l01471"></a>01471 <span class="comment">                        $montantHT=lePanier-&gt;totalHT;</span>
<a name="l01472"></a>01472 <span class="comment">                        $montantTTC=$lePanier-&gt;totalTTC;</span>
<a name="l01473"></a>01473 <span class="comment">                        $laCom= new Commande();</span>
<a name="l01474"></a>01474 <span class="comment">                        $laCom-&gt;numcom=$_SESSION[&#39;numcom&#39;];</span>
<a name="l01475"></a>01475 <span class="comment">                        $laCom-&gt;numclient=$_SESSION[&#39;numclient&#39;];</span>
<a name="l01476"></a>01476 <span class="comment">                        $laCom-&gt;montantTTC=$montantTTC;</span>
<a name="l01477"></a>01477 <span class="comment">                        $laCom-&gt;montantHT=$montantHT;</span>
<a name="l01478"></a>01478 <span class="comment">                        $laCom-&gt;fraisPort=lePanier-&gt;fraisPort;</span>
<a name="l01479"></a>01479 <span class="comment">                        etc...</span>
<a name="l01480"></a>01480 <span class="comment">                        * */</span>
<a name="l01481"></a>01481                         
<a name="l01482"></a>01482                         <span class="comment">/* * R√©glement de la formation = if ($forma)</span>
<a name="l01483"></a>01483 <span class="comment">                        $laCom= new Commande();</span>
<a name="l01484"></a>01484 <span class="comment">                        $laCom-&gt;numclient=$_SESSION[&#39;numclient&#39;];</span>
<a name="l01485"></a>01485 <span class="comment">                        $laCom-&gt;numcom=$_SESSION[&#39;numcom&#39;];</span>
<a name="l01486"></a>01486 <span class="comment">                        $laCom-&gt;infosCommande();</span>
<a name="l01487"></a>01487 <span class="comment">                        $montantTTC=$laCom-&gt;montantTTC;</span>
<a name="l01488"></a>01488 <span class="comment">                        etc..</span>
<a name="l01489"></a>01489 <span class="comment">                        * */</span>
<a name="l01490"></a>01490                         
<a name="l01491"></a>01491                         <span class="comment">/* * Les infos concernant le client sont dans l&#39;objet Client (classe Client.inc.php)</span>
<a name="l01492"></a>01492 <span class="comment">                        $leClient-&gt;numclient=$_SESSION[&#39;numclient&#39;];</span>
<a name="l01493"></a>01493 <span class="comment">                        $leClient-&gt;infosClient();</span>
<a name="l01494"></a>01494 <span class="comment">                        $leClient-&gt;nom;</span>
<a name="l01495"></a>01495 <span class="comment">                        $leClient-&gt;prenom;</span>
<a name="l01496"></a>01496 <span class="comment">                        $leClient-&gt;$raison;</span>
<a name="l01497"></a>01497 <span class="comment">                        etc...</span>
<a name="l01498"></a>01498 <span class="comment">                        * */</span>
<a name="l01499"></a>01499                         
<a name="l01500"></a>01500                         <span class="comment">// Ins√©rer ici redirection vers la banque </span>
<a name="l01501"></a>01501                         
<a name="l01502"></a>01502                         <span class="comment">/* * En retour de banque:</span>
<a name="l01503"></a>01503 <span class="comment">                        1. Utiliser la m√©thode $laCom-&gt;validerCommandeCB($CHAMP200,$CHAMP901,$CHAMP904,$CHAMP201) de l&#39;objet Commande pour modifier la commande dans la BD </span>
<a name="l01504"></a>01504 <span class="comment">                        2. Envoyer un mail au client - le mail peut √™tre envoy√© directement dans la m√©thode validerCommandeCB() de l&#39;objet Commande ou bien dans l&#39;objet Client (m√©thode √† cr√©er)</span>
<a name="l01505"></a>01505 <span class="comment">                        3. Envoyer un mail √† l&#39;admin IFIP</span>
<a name="l01506"></a>01506 <span class="comment">                        4. unset($_SESSION[&#39;numcom&#39;]);</span>
<a name="l01507"></a>01507 <span class="comment">                        * */</span>    
<a name="l01508"></a>01508                         
<a name="l01509"></a>01509         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ($action==<span class="stringliteral">&quot;validerReg&quot;</span>){<span class="comment">//r√®glement par ch√®que ou virement (dans panier-ifip transmis dans paiement.php)</span>
<a name="l01510"></a>01510                         
<a name="l01511"></a>01511                         <span class="keywordflow">if</span> ($radioReg==<span class="stringliteral">&quot;ch&quot;</span> || $radioReg==<span class="stringliteral">&quot;vi&quot;</span>) {
<a name="l01512"></a>01512                                 $laCom= <span class="keyword">new</span> <a class="code" href="class_commande.html" title="G&amp;egrave;re les commandes faites sur la boutique.">Commande</a>();
<a name="l01513"></a>01513                                 $laCom-&gt;numclient=$_SESSION[<span class="stringliteral">&#39;numclient&#39;</span>];
<a name="l01514"></a>01514                                 $laCom-&gt;numcom=$_SESSION[<span class="stringliteral">&#39;numcom&#39;</span>];
<a name="l01515"></a>01515                         
<a name="l01516"></a>01516                         
<a name="l01517"></a>01517                                 <span class="keywordflow">if</span> ($forma) {<span class="comment">//Le client r√®gle une formation suite au mail re√ßu par l&#39;admin</span>
<a name="l01518"></a>01518                                         $laCom-&gt;infosCommande();
<a name="l01519"></a>01519                                         $montantCh=$laCom-&gt;montantTTC;
<a name="l01520"></a>01520                                         <span class="comment">//$laCom-&gt;montantTTC=$laCom-&gt;montantTTC; // modif julien decembre 2009</span>
<a name="l01521"></a>01521                                         <span class="keywordflow">if</span> ($radioReg==<span class="stringliteral">&quot;ch&quot;</span>) $laCom-&gt;validerCommandeCheque();
<a name="l01522"></a>01522                                         <span class="keywordflow">else</span> <span class="keywordflow">if</span> ($radioReg==<span class="stringliteral">&quot;vi&quot;</span>) $laCom-&gt;validerCommandeVirement();<span class="comment">//ajout HC janvier 2010 : paiement par virement</span>
<a name="l01523"></a>01523                                         
<a name="l01524"></a>01524                                 } <span class="keywordflow">else</span> {<span class="comment">//Le client r√®gle des docs (ouvrage,article, etc...)</span>
<a name="l01525"></a>01525                                         $numpays=$laCom-&gt;getNumPays();
<a name="l01526"></a>01526                                         $lePanier=<span class="keyword">new</span> <a class="code" href="class_panier.html">Panier</a>();
<a name="l01527"></a>01527                                         $lePanier-&gt;numcom=$_SESSION[<span class="stringliteral">&#39;numcom&#39;</span>];
<a name="l01528"></a>01528                                         $lePanier-&gt;pays=$numpays;
<a name="l01529"></a>01529                                         $lePanier-&gt;infosPanier();
<a name="l01530"></a>01530                                         $laCom-&gt;montantHT=$lePanier-&gt;totalHT;
<a name="l01531"></a>01531                                         $laCom-&gt;montantTTC=$lePanier-&gt;totalTTC;
<a name="l01532"></a>01532                                         $laCom-&gt;fraisPort=$lePanier-&gt;fraisPort;
<a name="l01533"></a>01533                                         $montantCh=$lePanier-&gt;totalTTC;
<a name="l01534"></a>01534                                 
<a name="l01535"></a>01535                                         <span class="comment">//envoi du mail de confirmation de commande</span>
<a name="l01536"></a>01536                                         $clientValide=<span class="keyword">new</span> <a class="code" href="class_client.html" title="G&amp;egrave;re les diff&amp;eacute;rents clients.">Client</a>();
<a name="l01537"></a>01537                                         $clientValide-&gt;numclient=$_SESSION[<span class="stringliteral">&#39;numclient&#39;</span>];
<a name="l01538"></a>01538                                         $clientValide-&gt;infosClient(); 
<a name="l01539"></a>01539                                         
<a name="l01540"></a>01540                                         <span class="keywordflow">if</span> ($radioReg==<span class="stringliteral">&quot;ch&quot;</span>) $laCom-&gt;validerCommandeCheque();
<a name="l01541"></a>01541                                         <span class="keywordflow">else</span> <span class="keywordflow">if</span> ($radioReg==<span class="stringliteral">&quot;vi&quot;</span>) $laCom-&gt;validerCommandeVirement();
<a name="l01542"></a>01542                                                                                         
<a name="l01543"></a>01543                                         <span class="keywordflow">if</span> ($radioReg==<span class="stringliteral">&quot;ch&quot;</span>) EnvoiMailCommandeCheque($_SESSION[<span class="stringliteral">&#39;numcom&#39;</span>],$clientValide-&gt;email,$montantCh);
<a name="l01544"></a>01544                                         <span class="keywordflow">else</span> <span class="keywordflow">if</span> ($radioReg==<span class="stringliteral">&quot;vi&quot;</span>) EnvoiMailCommandeVirement($_SESSION[<span class="stringliteral">&#39;numcom&#39;</span>],$clientValide-&gt;email,$montantCh);
<a name="l01545"></a>01545                                 
<a name="l01546"></a>01546                                 }
<a name="l01547"></a>01547                         
<a name="l01548"></a>01548                                 
<a name="l01549"></a>01549                                 $etape=4;
<a name="l01550"></a>01550                         } <span class="comment">//fin du if radioreg=ch</span>
<a name="l01551"></a>01551                 <span class="comment">//}</span>
<a name="l01552"></a>01552         
<a name="l01553"></a>01553         }
<a name="l01554"></a>01554 
<a name="l01555"></a>01555 <span class="comment">/* ************* Page sp√©cifique formation-inscription.php du site public pour s&#39;inscrire √† une formation **************************************************************** */</span>
<a name="l01556"></a>01556 } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ($spec==<span class="stringliteral">&quot;formation-inscription&quot;</span>) {
<a name="l01557"></a>01557         <span class="keywordflow">if</span> ($action==<span class="stringliteral">&quot;seConnecter&quot;</span>) {
<a name="l01558"></a>01558                 $client=<span class="keyword">new</span> <a class="code" href="class_client.html" title="G&amp;egrave;re les diff&amp;eacute;rents clients.">Client</a>();
<a name="l01559"></a>01559                 $client-&gt;email=$textEmailCpte;
<a name="l01560"></a>01560                 $client-&gt;pwd=$textPwdCpte;
<a name="l01561"></a>01561                 $mes=$client-&gt;connecte();
<a name="l01562"></a>01562                 $client-&gt;numclient=$_SESSION[<span class="stringliteral">&#39;numclient&#39;</span>];
<a name="l01563"></a>01563                 $client-&gt;infosClient();
<a name="l01564"></a>01564                 <span class="keywordflow">if</span> ($mes) $action=<span class="stringliteral">&quot;&quot;</span>;
<a name="l01565"></a>01565                 
<a name="l01566"></a>01566         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ($action==<span class="stringliteral">&quot;creerCompte&quot;</span>) {
<a name="l01567"></a>01567                 $client=<span class="keyword">new</span> <a class="code" href="class_client.html" title="G&amp;egrave;re les diff&amp;eacute;rents clients.">Client</a>();
<a name="l01568"></a>01568                 $client-&gt;civilite=$selectCiv;
<a name="l01569"></a>01569                 $client-&gt;nom=$textNom;
<a name="l01570"></a>01570                 $client-&gt;prenom=$textPrenom;
<a name="l01571"></a>01571                 $client-&gt;raison=$textSociete;
<a name="l01572"></a>01572                 $client-&gt;adr1=$textAdr1;
<a name="l01573"></a>01573                 $client-&gt;adr2=$textAdr2;
<a name="l01574"></a>01574                 $client-&gt;cp=$textCp;
<a name="l01575"></a>01575                 $client-&gt;ville=$textVille;
<a name="l01576"></a>01576                 $client-&gt;pays=$selectPays;
<a name="l01577"></a>01577                 $client-&gt;tel=$textTel;
<a name="l01578"></a>01578                 $client-&gt;fax=$textFax;
<a name="l01579"></a>01579                 $client-&gt;email=$textEmail;
<a name="l01580"></a>01580                 $client-&gt;pwd=$textPwd;
<a name="l01581"></a>01581                 $client-&gt;actif=<span class="stringliteral">&quot;o&quot;</span>;
<a name="l01582"></a>01582 
<a name="l01583"></a>01583                 $mes=$client-&gt;creerClient();
<a name="l01584"></a>01584                 <span class="keywordflow">if</span> ($mes) $action=<span class="stringliteral">&quot;&quot;</span>;
<a name="l01585"></a>01585                 
<a name="l01586"></a>01586         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ($action==<span class="stringliteral">&quot;sinscrire&quot;</span>) {
<a name="l01587"></a>01587                 $leClient=<span class="keyword">new</span> <a class="code" href="class_client.html" title="G&amp;egrave;re les diff&amp;eacute;rents clients.">Client</a>();
<a name="l01588"></a>01588                 $leClient-&gt;numclient=$_SESSION[<span class="stringliteral">&#39;numclient&#39;</span>];
<a name="l01589"></a>01589                 $leClient-&gt;infosClient();<span class="comment">//infos du client pour ne pas √©craser nom, pr√©nom, civilit√©</span>
<a name="l01590"></a>01590                 $leClient-&gt;raison=$textRaison;
<a name="l01591"></a>01591                 $leClient-&gt;adr1=$textAdr1;
<a name="l01592"></a>01592                 $leClient-&gt;adr2=$textAdr2;
<a name="l01593"></a>01593                 $leClient-&gt;cp=$textCp;
<a name="l01594"></a>01594                 $leClient-&gt;ville=$textVille;
<a name="l01595"></a>01595                 $leClient-&gt;pays=$selectPays;
<a name="l01596"></a>01596                 $leClient-&gt;tel=$textTel;
<a name="l01597"></a>01597                 $leClient-&gt;gsm=$textGsm;
<a name="l01598"></a>01598                 $leClient-&gt;fax=$textFax;
<a name="l01599"></a>01599                 <span class="keywordflow">if</span> ($textAutreFonct) $leClient-&gt;fonction=$textAutreFonct; <span class="keywordflow">else</span> $leClient-&gt;fonction=$radioFonct;
<a name="l01600"></a>01600                 $leClient-&gt;modifierClient();
<a name="l01601"></a>01601                 
<a name="l01602"></a>01602                 $laForma=<span class="keyword">new</span> <a class="code" href="class_formation.html" title="s&amp;eacute;pcifique IFIP">Formation</a>();
<a name="l01603"></a>01603                 $laForma-&gt;numpara=$numpara;
<a name="l01604"></a>01604                 $laForma-&gt;infosFormation();
<a name="l01605"></a>01605                 $ajoutPanier= <span class="keyword">new</span> <a class="code" href="class_panier.html">Panier</a>();
<a name="l01606"></a>01606                 $ajoutPanier-&gt;numclient=$_SESSION[<span class="stringliteral">&#39;numclient&#39;</span>];
<a name="l01607"></a>01607                 $ajoutPanier-&gt;ajouterArticle($numpara,<span class="stringliteral">&quot;Inscription formation&quot;</span>,<span class="stringliteral">&quot;1&quot;</span>,$laForma-&gt;titrePara,<span class="stringliteral">&quot;&quot;</span>);
<a name="l01608"></a>01608                 <span class="keywordflow">if</span> ($checkVeille) $ajoutPanier-&gt;ajouterArticle($numpara,$checkVeille,<span class="stringliteral">&quot;1&quot;</span>,$laForma-&gt;titrePara,<span class="stringliteral">&quot;&quot;</span>);
<a name="l01609"></a>01609                 <span class="keywordflow">if</span> ($checkDiner) $ajoutPanier-&gt;ajouterArticle($numpara,$checkDiner,<span class="stringliteral">&quot;1&quot;</span>,$laForma-&gt;titrePara,<span class="stringliteral">&quot;&quot;</span>);
<a name="l01610"></a>01610                 <span class="keywordflow">if</span> ($checkPendant) $ajoutPanier-&gt;ajouterArticle($numpara,$checkPendant,<span class="stringliteral">&quot;1&quot;</span>,$laForma-&gt;titrePara,<span class="stringliteral">&quot;&quot;</span>);
<a name="l01611"></a>01611                 <span class="keywordflow">if</span> ($textPedag &amp;&amp; $textPedagTva) $ajoutPanier-&gt;ajouterArticle($numpara,<span class="stringliteral">&quot;facturer p√©dagogie √† &quot;</span>.$textPedag.<span class="stringliteral">&quot; tva=&quot;</span>.$textPedagTva,<span class="stringliteral">&quot;1&quot;</span>,$laForma-&gt;titrePara,<span class="stringliteral">&quot;&quot;</span>);
<a name="l01612"></a>01612                 <span class="keywordflow">if</span> ($textHeberg &amp;&amp; $textHebergTva) $ajoutPanier-&gt;ajouterArticle($numpara,<span class="stringliteral">&quot;facturer h√©bergement √† &quot;</span>.$textHeberg.<span class="stringliteral">&quot; tva=&quot;</span>.$textHebergTva,<span class="stringliteral">&quot;1&quot;</span>,$laForma-&gt;titrePara,<span class="stringliteral">&quot;&quot;</span>);
<a name="l01613"></a>01613                 
<a name="l01614"></a>01614                 <span class="comment">//On avertit l&#39;administrateur de l&#39;inscription</span>
<a name="l01615"></a>01615                 $laForma-&gt;numclient=$_SESSION[<span class="stringliteral">&#39;numclient&#39;</span>];
<a name="l01616"></a>01616                 $laForma-&gt;avertirAdmin();
<a name="l01617"></a>01617         }
<a name="l01618"></a>01618 
<a name="l01619"></a>01619 <span class="comment">/* ************* Page sp√©cifique extranet-pro.php du site public pour s&#39;inscrire √† l&#39;espace professionnel **************************************************************** */</span>
<a name="l01620"></a>01620 } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ($spec==<span class="stringliteral">&quot;extranet-pro&quot;</span>) {
<a name="l01621"></a>01621         <span class="keywordflow">if</span> ($action==<span class="stringliteral">&quot;seConnecter&quot;</span>) {
<a name="l01622"></a>01622                 $leProf= <span class="keyword">new</span> <a class="code" href="class_client.html" title="G&amp;egrave;re les diff&amp;eacute;rents clients.">Client</a>();
<a name="l01623"></a>01623                 $leProf-&gt;email=$textEmailCpte;
<a name="l01624"></a>01624                 $leProf-&gt;pwd=$textPwdCpte;
<a name="l01625"></a>01625                 $leProf-&gt;professionnel=<span class="stringliteral">&quot;o&quot;</span>;
<a name="l01626"></a>01626                 $mes=$leProf-&gt;connecte();
<a name="l01627"></a>01627                 $leProf-&gt;numclient=$_SESSION[<span class="stringliteral">&#39;numprof&#39;</span>];
<a name="l01628"></a>01628                 $leProf-&gt;infosClient();
<a name="l01629"></a>01629                 
<a name="l01630"></a>01630                 <span class="keywordflow">if</span> ($numdoc) {<span class="comment">// L&#39;utilisateur vient de la Base Documentaire Ifip, le document est en acc√®s r√©serv√© aux professionnels et il est payant =&gt; apr√®s connexion, il sera redirig√© vers le panier</span>
<a name="l01631"></a>01631                         <span class="comment">//Modif HC juillet 2009, il n&#39;y a plus de redirection vers le panier afin que le pro puisse consulter le resume</span>
<a name="l01632"></a>01632                         $numpara=$numdoc; <span class="comment">//on repart sur numpara car c&#39;est ce qui permet l&#39;affichage du detail d&#39;une doc</span>
<a name="l01633"></a>01633                         <span class="comment">/*</span>
<a name="l01634"></a>01634 <span class="comment">                        $laDoc=new Documentation();</span>
<a name="l01635"></a>01635 <span class="comment">                        $laDoc-&gt;numpara=$numdoc;</span>
<a name="l01636"></a>01636 <span class="comment">                        $laDoc-&gt;infosDoc();</span>
<a name="l01637"></a>01637 <span class="comment">                        $ajoutPanier= new Panier();</span>
<a name="l01638"></a>01638 <span class="comment">                        if ($_SESSION[&#39;numcom&#39;]) $ajoutPanier-&gt;numcom=$_SESSION[&#39;numcom&#39;];</span>
<a name="l01639"></a>01639 <span class="comment">                        $ajoutPanier-&gt;ajouterArticle($numdoc,&quot;Achat documentation&quot;,1,$laDoc-&gt;reference,$laDoc-&gt;tarif);</span>
<a name="l01640"></a>01640 <span class="comment">                        if (!$_SESSION[&#39;numcom&#39;])  $_SESSION[&#39;numcom&#39;]=$ajoutPanier-&gt;numcom;</span>
<a name="l01641"></a>01641 <span class="comment">                        $pageSpec=new Page();</span>
<a name="l01642"></a>01642 <span class="comment">                        $pageSpec-&gt;pageSpecifique(&quot;panier-ifip-institut-du-porc.php&quot;);</span>
<a name="l01643"></a>01643 <span class="comment">                        $spec=$pageSpec-&gt;nomFichier;</span>
<a name="l01644"></a>01644 <span class="comment">                        $numrub=$pageSpec-&gt;numrub;</span>
<a name="l01645"></a>01645 <span class="comment">                        $numcateg=$pageSpec-&gt;numcateg;</span>
<a name="l01646"></a>01646 <span class="comment">                        $numsscateg=$pageSpec-&gt;numsscateg;</span>
<a name="l01647"></a>01647 <span class="comment">                        $numpage=$pageSpec-&gt;numpage;</span>
<a name="l01648"></a>01648 <span class="comment">                        */</span>
<a name="l01649"></a>01649                 }
<a name="l01650"></a>01650                 
<a name="l01651"></a>01651         }
<a name="l01652"></a>01652 
<a name="l01653"></a>01653 <span class="comment">/* ************* Page sp√©cifique compte-ifip.php du site public pour acc√©der √† son compte ou s&#39;inscrire **************************************************************** */</span>
<a name="l01654"></a>01654 } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ($spec==<span class="stringliteral">&quot;compte-ifip&quot;</span>) {
<a name="l01655"></a>01655         <span class="keywordflow">if</span> ($action==<span class="stringliteral">&quot;seConnecter&quot;</span>) {
<a name="l01656"></a>01656                 $client=<span class="keyword">new</span> <a class="code" href="class_client.html" title="G&amp;egrave;re les diff&amp;eacute;rents clients.">Client</a>();
<a name="l01657"></a>01657                 $client-&gt;email=$textEmailCpte;
<a name="l01658"></a>01658                 $client-&gt;pwd=$textPwdCpte;
<a name="l01659"></a>01659                 $mes=$client-&gt;connecte();
<a name="l01660"></a>01660                 $client-&gt;numclient=$_SESSION[<span class="stringliteral">&#39;numclient&#39;</span>];
<a name="l01661"></a>01661                 $client-&gt;infosClient();
<a name="l01662"></a>01662                 <span class="keywordflow">if</span> ($mes) $action=<span class="stringliteral">&quot;&quot;</span>;
<a name="l01663"></a>01663         }  <span class="keywordflow">else</span> <span class="keywordflow">if</span> ($action==<span class="stringliteral">&quot;creerCompte&quot;</span>) {
<a name="l01664"></a>01664                 $client=<span class="keyword">new</span> <a class="code" href="class_client.html" title="G&amp;egrave;re les diff&amp;eacute;rents clients.">Client</a>();
<a name="l01665"></a>01665                 $client-&gt;civilite=$selectCiv;
<a name="l01666"></a>01666                 $client-&gt;nom=$textNom;
<a name="l01667"></a>01667                 $client-&gt;prenom=$textPrenom;
<a name="l01668"></a>01668                 $client-&gt;raison=$textSociete;
<a name="l01669"></a>01669                 $client-&gt;adr1=$textAdr1;
<a name="l01670"></a>01670                 $client-&gt;adr2=$textAdr2;
<a name="l01671"></a>01671                 $client-&gt;cp=$textCp;
<a name="l01672"></a>01672                 $client-&gt;ville=$textVille;
<a name="l01673"></a>01673                 $client-&gt;pays=$selectPays;
<a name="l01674"></a>01674                 $client-&gt;tel=$textTel;
<a name="l01675"></a>01675                 $client-&gt;fax=$textFax;
<a name="l01676"></a>01676                 $client-&gt;email=$textEmail;
<a name="l01677"></a>01677                 $client-&gt;pwd=$textPwd;
<a name="l01678"></a>01678                 $client-&gt;actif=<span class="stringliteral">&quot;o&quot;</span>;
<a name="l01679"></a>01679 
<a name="l01680"></a>01680                 $mes=$client-&gt;creerClient();
<a name="l01681"></a>01681                 <span class="keywordflow">if</span> ($mes) $action=<span class="stringliteral">&quot;&quot;</span>;
<a name="l01682"></a>01682                 
<a name="l01683"></a>01683         } 
<a name="l01684"></a>01684 <span class="comment">/* ************* Page sp√©cifique compte-ifip.php du site public pour acc√©der √† son compte ou s&#39;inscrire **************************************************************** */</span>
<a name="l01685"></a>01685 } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ($spec==<span class="stringliteral">&quot;compte-ifip-profil&quot;</span>) {
<a name="l01686"></a>01686         <span class="keywordflow">if</span> ($action==<span class="stringliteral">&quot;modifierCompte&quot;</span>) {
<a name="l01687"></a>01687                 $modifClient = <span class="keyword">new</span> <a class="code" href="class_client.html" title="G&amp;egrave;re les diff&amp;eacute;rents clients.">Client</a>();    
<a name="l01688"></a>01688                 $modifClient-&gt;raison=$textSociete;
<a name="l01689"></a>01689                 $modifClient-&gt;civilite=$selectCiv;
<a name="l01690"></a>01690                 $modifClient-&gt;nom=$textNom;
<a name="l01691"></a>01691                 $modifClient-&gt;prenom=$textPrenom;
<a name="l01692"></a>01692                 $modifClient-&gt;fonction=$textFonction;
<a name="l01693"></a>01693                 $modifClient-&gt;adr1=$textAdr1;
<a name="l01694"></a>01694                 $modifClient-&gt;adr2=$textAdr2;
<a name="l01695"></a>01695                 $modifClient-&gt;cp=$textCp;
<a name="l01696"></a>01696                 $modifClient-&gt;ville=$textVille;
<a name="l01697"></a>01697                 $modifClient-&gt;pays=$selectPays;
<a name="l01698"></a>01698                 $modifClient-&gt;tel=$textTel;
<a name="l01699"></a>01699                 $modifClient-&gt;fax=$textFax;
<a name="l01700"></a>01700                 $modifClient-&gt;email=$textEmail;
<a name="l01701"></a>01701                 <span class="comment">//$modifClient-&gt;pwd=$textPwd;</span>
<a name="l01702"></a>01702                 $modifClient-&gt;actif=<span class="stringliteral">&quot;o&quot;</span>;
<a name="l01703"></a>01703                 $modifClient-&gt;numclient=$_SESSION[<span class="stringliteral">&#39;numclient&#39;</span>];
<a name="l01704"></a>01704             
<a name="l01705"></a>01705                 $modifClient-&gt;modifierClient();
<a name="l01706"></a>01706    
<a name="l01707"></a>01707   }
<a name="l01708"></a>01708         
<a name="l01709"></a>01709 <span class="comment">/* ************* Page sp√©cifique oublie.php du site public pour mot de passe oubli√© **************************************************************** */</span>
<a name="l01710"></a>01710 } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ($spec==<span class="stringliteral">&quot;oublie&quot;</span>) {
<a name="l01711"></a>01711         <span class="keywordflow">if</span> ($textLoginOublie) {
<a name="l01712"></a>01712                 $oubliClient= <span class="keyword">new</span> <a class="code" href="class_client.html" title="G&amp;egrave;re les diff&amp;eacute;rents clients.">Client</a>();
<a name="l01713"></a>01713                 $oubliClient-&gt;email=$textLoginOublie;
<a name="l01714"></a>01714                 <span class="keywordflow">if</span> ($type==<span class="stringliteral">&quot;accespro&quot;</span>) $oubliClient-&gt;professionnel=<span class="stringliteral">&quot;o&quot;</span>;
<a name="l01715"></a>01715                 $mes=$oubliClient-&gt;envoyerPwd();
<a name="l01716"></a>01716                 
<a name="l01717"></a>01717                 <span class="keywordflow">if</span> ($prix) {<span class="comment">//cas d&#39;un article cr√©e √† la vol√©e (l&#39;utilisateur vient de la page panier-ifip-institut-du-porc.php)</span>
<a name="l01718"></a>01718                         $pageSpec=<span class="keyword">new</span> Page();
<a name="l01719"></a>01719                         $pageSpec-&gt;pageSpecifique(<span class="stringliteral">&quot;panier-ifip-institut-du-porc&quot;</span>);
<a name="l01720"></a>01720                         $spec=$pageSpec-&gt;nomFichier;
<a name="l01721"></a>01721                         $numrub=$pageSpec-&gt;numrub;
<a name="l01722"></a>01722                         $numcateg=$pageSpec-&gt;numcateg;
<a name="l01723"></a>01723                         $numsscateg=$pageSpec-&gt;numsscateg;
<a name="l01724"></a>01724                         $numpage=$pageSpec-&gt;numpage;
<a name="l01725"></a>01725                         $etape=2;
<a name="l01726"></a>01726                 }
<a name="l01727"></a>01727         }
<a name="l01728"></a>01728               
<a name="l01729"></a>01729 } <span class="comment">//fin if ($spec==&quot;oublie&quot;) </span>
<a name="l01730"></a>01730 
<a name="l01731"></a>01731 } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ($t6mpnh) { <span class="comment">// fin if ($spec) =&gt; lien direct vers le panier pour l&#39;inscription d√©finitive √† la formation (ce lien apparait dans le mail envoy√© au client lorque l&#39;admin a valid√© les dates de la formation sur mesure (m√©thode validerForma($url) de l&#39;objet Formation)</span>
<a name="l01732"></a>01732     
<a name="l01733"></a>01733                 
<a name="l01734"></a>01734         $args=explode(<span class="stringliteral">&quot;&amp;&quot;</span>,base64_decode($t6mpnh));
<a name="l01735"></a>01735         <span class="keywordflow">foreach</span>($args as $arg) {
<a name="l01736"></a>01736                 $parts=explode(<span class="stringliteral">&quot;=&quot;</span>,$arg);
<a name="l01737"></a>01737                 <span class="keywordflow">if</span> ($parts[0]==<span class="stringliteral">&quot;lien&quot;</span>) $lien=$parts[1]; <span class="keywordflow">else</span> <span class="keywordflow">if</span> ($parts[0]==<span class="stringliteral">&quot;email&quot;</span>) $email=$parts[1]; <span class="keywordflow">else</span> <span class="keywordflow">if</span> ($parts[0]==<span class="stringliteral">&quot;pwd&quot;</span>) $pwd=$parts[1];
<a name="l01738"></a>01738         } 
<a name="l01739"></a>01739         
<a name="l01740"></a>01740         $leClient= <span class="keyword">new</span> <a class="code" href="class_client.html" title="G&amp;egrave;re les diff&amp;eacute;rents clients.">Client</a>();
<a name="l01741"></a>01741         $leClient-&gt;email=$email;
<a name="l01742"></a>01742         $leClient-&gt;pwd=$pwd;
<a name="l01743"></a>01743         $numcli=$leClient-&gt;getNumclient();
<a name="l01744"></a>01744         
<a name="l01745"></a>01745         $laCom= <span class="keyword">new</span> <a class="code" href="class_commande.html" title="G&amp;egrave;re les commandes faites sur la boutique.">Commande</a>();
<a name="l01746"></a>01746         $laCom-&gt;numcom=$lien;
<a name="l01747"></a>01747         $laCom-&gt;infosCommande();
<a name="l01748"></a>01748         <span class="keywordflow">if</span> ($numcli==$laCom-&gt;numclient) {<span class="comment">//on v√©rifie que la commande correspond bien au client</span>
<a name="l01749"></a>01749                 $_SESSION[<span class="stringliteral">&#39;numcom&#39;</span>]=$lien;
<a name="l01750"></a>01750                 
<a name="l01751"></a>01751                 <span class="comment">//Connexion du client √† son compte</span>
<a name="l01752"></a>01752                 $leClient-&gt;connecte();
<a name="l01753"></a>01753                 
<a name="l01754"></a>01754                 <span class="comment">//Redirection vers le panier</span>
<a name="l01755"></a>01755                 $pageSpec=<span class="keyword">new</span> Page();
<a name="l01756"></a>01756                 $pageSpec-&gt;pageSpecifique(<span class="stringliteral">&quot;panier-ifip-institut-du-porc&quot;</span>);
<a name="l01757"></a>01757                 $spec=$pageSpec-&gt;nomFichier;
<a name="l01758"></a>01758                 $numrub=$pageSpec-&gt;numrub;
<a name="l01759"></a>01759                 $numcateg=$pageSpec-&gt;numcateg;
<a name="l01760"></a>01760                 $numsscateg=$pageSpec-&gt;numsscateg;
<a name="l01761"></a>01761                 $numpage=$pageSpec-&gt;numpage;
<a name="l01762"></a>01762                 $etape=4;<span class="comment">//R√©glement</span>
<a name="l01763"></a>01763         } <span class="keywordflow">else</span> {
<a name="l01764"></a>01764                 $mes=<span class="stringliteral">&quot;D√©sol√©, vous ne pouvez pas vous connecter √† votre compte !&quot;</span>;
<a name="l01765"></a>01765         }
<a name="l01766"></a>01766 } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ($numarticle) {<span class="comment">// =&gt; lien direct vers le panier pour r√©gler un article </span>
<a name="l01767"></a>01767         
<a name="l01768"></a>01768         <span class="keywordflow">if</span> ($prix) {            
<a name="l01769"></a>01769                 <span class="comment">//Infos sur l&#39;article</span>
<a name="l01770"></a>01770                 $arti= <span class="keyword">new</span> <a class="code" href="class_article.html" title="Sp√©cifique IFIP.">Article</a>();
<a name="l01771"></a>01771                 $arti-&gt;numarticle=$numarticle;
<a name="l01772"></a>01772                 
<a name="l01773"></a>01773                 <span class="keywordflow">if</span> ($arti-&gt;infosArti()) {
<a name="l01774"></a>01774                                 
<a name="l01775"></a>01775                         <span class="comment">//On ajoute au panier</span>
<a name="l01776"></a>01776                         $ajoutPanier= <span class="keyword">new</span> <a class="code" href="class_panier.html">Panier</a>();
<a name="l01777"></a>01777                         $ajoutPanier-&gt;ajouterArticle($numarticle,$arti-&gt;libelle,<span class="stringliteral">&quot;1&quot;</span>,<span class="stringliteral">&quot;&quot;</span>,$prix,<span class="stringliteral">&quot;1&quot;</span>);
<a name="l01778"></a>01778                                           
<a name="l01779"></a>01779                         <span class="comment">//Redirection vers le panier</span>
<a name="l01780"></a>01780                         $pageSpec=<span class="keyword">new</span> Page();
<a name="l01781"></a>01781                         $pageSpec-&gt;pageSpecifique(<span class="stringliteral">&quot;panier-ifip-institut-du-porc&quot;</span>);
<a name="l01782"></a>01782                         $spec=$pageSpec-&gt;nomFichier;
<a name="l01783"></a>01783                         $numrub=$pageSpec-&gt;numrub;
<a name="l01784"></a>01784                         $numcateg=$pageSpec-&gt;numcateg;
<a name="l01785"></a>01785                         $numsscateg=$pageSpec-&gt;numsscateg;
<a name="l01786"></a>01786                         $numpage=$pageSpec-&gt;numpage;
<a name="l01787"></a>01787                 } <span class="keywordflow">else</span> {
<a name="l01788"></a>01788                         $mes=<span class="stringliteral">&quot;D√©sol√©, cet article n\&#39;existe plus !&quot;</span>;
<a name="l01789"></a>01789                         $accueilP=<span class="keyword">new</span> Page();
<a name="l01790"></a>01790                         $accueilP-&gt;lg=$lg;
<a name="l01791"></a>01791                         $numpage=$accueilP-&gt;rechercherAccueil();
<a name="l01792"></a>01792                         $spec=<span class="stringliteral">&quot;includes/home&quot;</span>;
<a name="l01793"></a>01793                 }
<a name="l01794"></a>01794         } <span class="keywordflow">else</span> {<span class="comment">//pas de prix dans l&#39;url</span>
<a name="l01795"></a>01795                 $accueilP=<span class="keyword">new</span> Page();
<a name="l01796"></a>01796                 $accueilP-&gt;lg=$lg;
<a name="l01797"></a>01797                 $numpage=$accueilP-&gt;rechercherAccueil();
<a name="l01798"></a>01798                 $spec=<span class="stringliteral">&quot;includes/home&quot;</span>;
<a name="l01799"></a>01799         }
<a name="l01800"></a>01800 }
<a name="l01801"></a>01801 ?&gt;
<a name="l01802"></a>01802 
<a name="l01803"></a>01803 
<a name="l01804"></a>01804 &lt;!DOCTYPE html PUBLIC <span class="stringliteral">&quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot;</span> <span class="stringliteral">&quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;</span>&gt;
<a name="l01805"></a>01805 
<a name="l01806"></a>01806 &lt;html xmlns=<span class="stringliteral">&quot;http://www.w3.org/1999/xhtml&quot;</span>&gt;
<a name="l01807"></a>01807 
<a name="l01808"></a>01808 &lt;head&gt;
<a name="l01809"></a>01809 
<a name="l01810"></a>01810 &lt;meta http-equiv=<span class="stringliteral">&quot;Content-Type&quot;</span> content=<span class="stringliteral">&quot;text/html; charset=utf-8&quot;</span> /&gt;
<a name="l01811"></a>01811 &lt;title&gt;
<a name="l01812"></a>01812 &lt;?php
<a name="l01813"></a>01813 
<a name="l01814"></a>01814 <span class="keywordflow">if</span> ($numpage) {<span class="comment">//$numpage est initialise par la regle d&#39;ecriture dans .htaccess (accueil : numpage=86)</span>
<a name="l01815"></a>01815     $accueilPage=<span class="keyword">new</span> Page();
<a name="l01816"></a>01816         $accueilPage-&gt;lg=$lg;
<a name="l01817"></a>01817         $numpage_accueil=$accueilPage-&gt;rechercherAccueil();
<a name="l01818"></a>01818         <span class="keywordflow">if</span>  ($numpage_accueil==$numpage &amp;&amp; !$pg_admin) {
<a name="l01819"></a>01819                 $accueilPage-&gt;numpage=$numpage;
<a name="l01820"></a>01820                 $accueilPage-&gt;infosPage();
<a name="l01821"></a>01821                 echo $accueilPage-&gt;nomPageGoogle;
<a name="l01822"></a>01822                 $accueil=1;
<a name="l01823"></a>01823         } <span class="keywordflow">else</span> {
<a name="l01824"></a>01824                 $titrePage = <span class="keyword">new</span> Page();
<a name="l01825"></a>01825                 $titrePage-&gt;numpage=$numpage;
<a name="l01826"></a>01826                 $titrePage-&gt;infosPage();
<a name="l01827"></a>01827                 echo $titrePage-&gt;nomPageGoogle;
<a name="l01828"></a>01828         }
<a name="l01829"></a>01829 } 
<a name="l01830"></a>01830 
<a name="l01831"></a>01831 ?&gt;
<a name="l01832"></a>01832 &lt;/title&gt; 
<a name="l01833"></a>01833 &lt;META NAME=<span class="stringliteral">&quot;keywords&quot;</span> CONTENT=<span class="stringliteral">&quot;&lt;?php if ($numpage &amp;&amp; $accueil) echo $accueilPage-&gt;keywPage; else if ($numpage) echo $titrePage-&gt;keywPage;?&gt;&quot;</span>&gt;
<a name="l01834"></a>01834 &lt;META NAME=<span class="stringliteral">&quot;description&quot;</span> CONTENT=<span class="stringliteral">&quot;&lt;?php if ($numpage &amp;&amp; $accueil) echo $accueilPage-&gt;descrPage; else if ($numpage) echo $titrePage-&gt;descrPage; ?&gt;&quot;</span>&gt;
<a name="l01835"></a>01835 &lt;!-- <a class="code" href="class_lien.html">Lien</a> vers feuille de style pour Dreamweaver qui ne gere pas bien le inlude(<span class="stringliteral">&quot;styles.php&quot;</span>) --&gt;
<a name="l01836"></a>01836 &lt;link rel=<span class="stringliteral">&quot;stylesheet&quot;</span> href=<span class="stringliteral">&quot;css/ifip.css&quot;</span> type=<span class="stringliteral">&quot;text/css&quot;</span> media=<span class="stringliteral">&quot;screen&quot;</span> /&gt;
<a name="l01837"></a>01837 &lt;link rel=<span class="stringliteral">&quot;shortcut icon&quot;</span> href=<span class="stringliteral">&quot;http://www.ifip.asso.fr/favicon.ico&quot;</span> /&gt;
<a name="l01838"></a>01838 &lt;?php 
<a name="l01839"></a>01839 include (<span class="stringliteral">&quot;javascript.php&quot;</span>);   
<a name="l01840"></a>01840 include (<span class="stringliteral">&quot;styles.php&quot;</span>);
<a name="l01841"></a>01841 ?&gt;       
<a name="l01842"></a>01842 &lt;/head&gt;
<a name="l01843"></a>01843 
<a name="l01844"></a>01844 &lt;body&gt;
<a name="l01845"></a>01845 &lt;form action=<span class="stringliteral">&quot;</span>
<a name="l01846"></a>01846 <span class="stringliteral">        &lt;? </span>
<a name="l01847"></a>01847 <span class="stringliteral">        // changement de l&#39;action du form au moment du choix de paiement</span>
<a name="l01848"></a>01848 <span class="stringliteral">        </span>
<a name="l01849"></a>01849 <span class="stringliteral">        if ($etape==&quot;</span>4<span class="stringliteral">&quot;) {                                                                               </span>
<a name="l01850"></a>01850 <span class="stringliteral">        ?&gt;</span>
<a name="l01851"></a>01851 <span class="stringliteral">        paiement.php?id=&lt;?=$id?&gt;&amp;cnx=&lt;?=$cnx?&gt;&amp;pg_admin=&lt;?=$pg_admin?&gt;&amp;spec=&lt;?=$spec?&gt;&amp;numpage=&lt;?=$numpage?&gt;&amp;numrub=&lt;?=$numrub?&gt;&amp;numcateg=&lt;?=$numcateg?&gt;&amp;numsscateg=&lt;?=$numsscateg?&gt;&amp;cont=&lt;?=$cont?&gt;&amp;lg=&lt;?=$lg?&gt;&amp;action=&lt;?=$action?&gt;</span>
<a name="l01852"></a>01852 <span class="stringliteral">        &lt;? </span>
<a name="l01853"></a>01853 <span class="stringliteral">        } else { </span>
<a name="l01854"></a>01854 <span class="stringliteral">        ?&gt;</span>
<a name="l01855"></a>01855 <span class="stringliteral">        index.php?id=&lt;?=$id?&gt;&amp;cnx=&lt;?=$cnx?&gt;&amp;pg_admin=&lt;?=$pg_admin?&gt;&amp;spec=&lt;?=$spec?&gt;&amp;numpage=&lt;?=$numpage?&gt;&amp;numrub=&lt;?=$numrub?&gt;&amp;numcateg=&lt;?=$numcateg?&gt;&amp;numsscateg=&lt;?=$numsscateg?&gt;&amp;cont=&lt;?=$cont?&gt;&amp;lg=&lt;?=$lg?&gt;</span>
<a name="l01856"></a>01856 <span class="stringliteral">        &lt;? </span>
<a name="l01857"></a>01857 <span class="stringliteral">        } </span>
<a name="l01858"></a>01858 <span class="stringliteral">        ?&gt;&quot;</span> name=<span class="stringliteral">&quot;testform&quot;</span> method=<span class="stringliteral">&quot;post&quot;</span> <span class="keyword">class</span>=<span class="stringliteral">&quot;adminform&quot;</span> enctype=<span class="stringliteral">&quot;multipart/form-data&quot;</span>&gt;
<a name="l01859"></a>01859 
<a name="l01860"></a>01860 &lt;!-- menu principal Zone 2 (zone1 traite dans header.php et homeheadr.php--&gt;
<a name="l01861"></a>01861 &lt;div <span class="keywordtype">id</span>=<span class="stringliteral">&quot;menugeneral&quot;</span>&gt;
<a name="l01862"></a>01862 &lt;ul <span class="keywordtype">id</span>=<span class="stringliteral">&quot;MenuBarTop&quot;</span> <span class="keyword">class</span>=<span class="stringliteral">&quot;MenuBarHorizontal&quot;</span>&gt;
<a name="l01863"></a>01863 
<a name="l01864"></a>01864                         &lt;?php
<a name="l01865"></a>01865                         <span class="comment">//rubriques principales (zone 2)</span>
<a name="l01866"></a>01866                         $listrub=<span class="keyword">new</span> <a class="code" href="class_liste_menus.html">ListeMenus</a>();        
<a name="l01867"></a>01867                         $listrub-&gt;type=<span class="stringliteral">&quot;rubrique&quot;</span>;
<a name="l01868"></a>01868                         $listrub-&gt;nomkey=<span class="stringliteral">&quot;numrub&quot;</span>;
<a name="l01869"></a>01869                         $listrub-&gt;zone=<span class="stringliteral">&quot;2&quot;</span>;       
<a name="l01870"></a>01870                         $listrub-&gt;lg=$lg;
<a name="l01871"></a>01871                         $listrub-&gt;afficherListeMenus();   
<a name="l01872"></a>01872                         <span class="keywordflow">foreach</span> ($listrub as $menus) {                          
<a name="l01873"></a>01873                         ?&gt;
<a name="l01874"></a>01874                         
<a name="l01875"></a>01875                                 &lt;li&gt;&lt;a href=<span class="stringliteral">&quot;&lt;?php if ($id) echo &quot;</span>index.php?<span class="keywordtype">id</span>=$id&amp;cnx=$cnx&amp;pg_admin=content&amp;numpage=$menus-&gt;numpage&amp;numrub=$menus-&gt;nummenu&amp;onglet=voir<span class="stringliteral">&quot;; else echo $menus-&gt;url;?&gt;&quot;</span> <span class="keyword">class</span>=<span class="stringliteral">&quot;&lt;? if ($menus-&gt;nummenu==$numrub) echo&quot;</span>actif<span class="stringliteral">&quot;;?&gt;&quot;</span>&gt;&lt;?php echo $menus-&gt;nomMenu;?&gt;&lt;/a&gt;
<a name="l01876"></a>01876         
<a name="l01877"></a>01877                         &lt;?php
<a name="l01878"></a>01878                                 <span class="comment">//Categories</span>
<a name="l01879"></a>01879                                 $listcategmenu=<span class="keyword">new</span> <a class="code" href="class_liste_menus.html">ListeMenus</a>();          
<a name="l01880"></a>01880                                 $listcategmenu-&gt;type=<span class="stringliteral">&quot;categorie&quot;</span>;
<a name="l01881"></a>01881                                 $listcategmenu-&gt;nomkey=<span class="stringliteral">&quot;numcateg&quot;</span>;
<a name="l01882"></a>01882                                 $listcategmenu-&gt;zone=<span class="stringliteral">&quot;3&quot;</span>;
<a name="l01883"></a>01883                                 $listcategmenu-&gt;numfkey=$menus-&gt;nummenu; <span class="comment">// c&#39;est le numrub de ce menu</span>
<a name="l01884"></a>01884                                 $listcategmenu-&gt;lg=$lg;  
<a name="l01885"></a>01885                                 $listcategmenu-&gt;afficherListeMenus();
<a name="l01886"></a>01886                         ?&gt;
<a name="l01887"></a>01887                                 &lt;ul&gt;
<a name="l01888"></a>01888                         &lt;?php   
<a name="l01889"></a>01889                                 <span class="keywordflow">foreach</span> ($listcategmenu as $menus) {
<a name="l01890"></a>01890                                         $numcatmenu=$menus-&gt;nummenu;
<a name="l01891"></a>01891                         ?&gt;
<a name="l01892"></a>01892                                         
<a name="l01893"></a>01893                                         &lt;li&gt;
<a name="l01894"></a>01894                                         &lt;a href=<span class="stringliteral">&quot;&lt;?php if ($id) echo &quot;</span>index.php?<span class="keywordtype">id</span>=$id&amp;cnx=$cnx&amp;pg_admin=content&amp;numpage=$menus-&gt;numpage&amp;numrub=$menus-&gt;nummenu&amp;numcateg=$numcatmenu&amp;onglet=voir<span class="stringliteral">&quot;; else echo $menus-&gt;url;?&gt;&quot;</span> <span class="keyword">class</span>=<span class="stringliteral">&quot;MenuBarItemSubmenu&quot;</span>&gt;&lt;?=$menus-&gt;nomMenu?&gt;&lt;/a&gt;
<a name="l01895"></a>01895                                         &lt;/li&gt;
<a name="l01896"></a>01896                                         
<a name="l01897"></a>01897                         &lt;?php
<a name="l01898"></a>01898                                 } <span class="comment">// fin du foreach (categ)     </span>
<a name="l01899"></a>01899                         ?&gt;
<a name="l01900"></a>01900                                         &lt;/ul&gt;
<a name="l01901"></a>01901                                 &lt;/li&gt;
<a name="l01902"></a>01902                         &lt;?php
<a name="l01903"></a>01903                         } <span class="comment">//fin du foreach</span>
<a name="l01904"></a>01904                         ?&gt;
<a name="l01905"></a>01905                 &lt;/ul&gt; 
<a name="l01906"></a>01906 &lt;/div&gt;
<a name="l01907"></a>01907 &lt;!-- fin du menu principal --&gt;
<a name="l01908"></a>01908 
<a name="l01909"></a>01909 &lt;div <span class="keywordtype">id</span>=<span class="stringliteral">&quot;container&quot;</span>&gt;
<a name="l01910"></a>01910 &lt;!-- debut header --&gt;
<a name="l01911"></a>01911 &lt;?php <span class="keywordflow">if</span> ($numpage &amp;&amp; $accueil) { <span class="comment">// c&#39;est la page d&#39;accueil du site (en FR ou en EN) ?&gt;</span>
<a name="l01912"></a>01912 &lt;div <span class="keywordtype">id</span>=<span class="stringliteral">&quot;indexHeader&quot;</span> <span class="keyword">class</span>=<span class="stringliteral">&quot;line&quot;</span>&gt;&lt;?php include (<span class="stringliteral">&quot;includes/homeheader.php&quot;</span>); ?&gt;&lt;/div&gt;
<a name="l01913"></a>01913 &lt;?php } <span class="keywordflow">else</span> { <span class="comment">// les autres pages ?&gt;</span>
<a name="l01914"></a>01914 &lt;div <span class="keywordtype">id</span>=<span class="stringliteral">&quot;header&quot;</span> <span class="keyword">class</span>=<span class="stringliteral">&quot;line&quot;</span>&gt;&lt;?php include (<span class="stringliteral">&quot;includes/header.php&quot;</span>); ?&gt;&lt;/div&gt;
<a name="l01915"></a>01915 &lt;?php } ?&gt;
<a name="l01916"></a>01916 &lt;!-- end of header --&gt;
<a name="l01917"></a>01917 
<a name="l01918"></a>01918 
<a name="l01919"></a>01919 
<a name="l01920"></a>01920 &lt;!-- breadcrumbs = chemin --&gt;
<a name="l01921"></a>01921 &lt;?php 
<a name="l01922"></a>01922 <span class="keywordflow">if</span> (!$accueil) { <span class="comment">// pas de chemin en page d&#39;accueil</span>
<a name="l01923"></a>01923 ?&gt;
<a name="l01924"></a>01924         &lt;div <span class="keyword">class</span>=<span class="stringliteral">&quot;line&quot;</span>&gt;              
<a name="l01925"></a>01925                   &lt;div <span class="keyword">class</span>=<span class="stringliteral">&quot;item&quot;</span> <span class="keywordtype">id</span>=<span class="stringliteral">&quot;breadcrumbs&quot;</span>&gt;
<a name="l01926"></a>01926                         &lt;div <span class="keyword">class</span>=<span class="stringliteral">&quot;sap-content&quot;</span>&gt;
<a name="l01927"></a>01927                         &lt;?php
<a name="l01928"></a>01928                         <span class="comment">//bouton de deconnexion de la session</span>
<a name="l01929"></a>01929                         <span class="keywordflow">if</span> ($_SESSION[<span class="stringliteral">&quot;numclient&quot;</span>]) {
<a name="l01930"></a>01930                         ?&gt;
<a name="l01931"></a>01931                         &lt;div <span class="keyword">class</span>=<span class="stringliteral">&quot;breadcrumbs&quot;</span> style=<span class="stringliteral">&quot;float:right;width:150px;text-align:right;padding-right:15px;&quot;</span> &gt;&lt;a href=<span class="stringliteral">&quot;index.php?spec=&lt;?=$spec?&gt;&amp;numpage=&lt;?=$numpage?&gt;&amp;numrub=&lt;?=$numrub?&gt;&amp;numcateg=&lt;?=$numcateg?&gt;&amp;numsscateg=&lt;?=$numsscateg?&gt;&amp;lg=&lt;?=$lg?&gt;&amp;deconclient=o&quot;</span> <span class="keyword">class</span>=<span class="stringliteral">&quot;deconnexion&quot;</span>&gt;Se d√©connecter&lt;/a&gt;&lt;/div&gt;
<a name="l01932"></a>01932                         &lt;?php
<a name="l01933"></a>01933                         }
<a name="l01934"></a>01934                         ?&gt;
<a name="l01935"></a>01935                         &lt;div&gt;&lt;p <span class="keyword">class</span>=<span class="stringliteral">&quot;breadcrumbs&quot;</span>&gt;&lt;a href=<span class="stringliteral">&quot;&lt;?=$pageAccueil-&gt;url?&gt;&quot;</span>&gt;Accueil Ifip&lt;/a&gt; &gt; &lt;!--rubrique &gt; sous rubrique &gt; page--&gt;
<a name="l01936"></a>01936                         &lt;?php
<a name="l01937"></a>01937                         <span class="keywordflow">if</span> ($numrub) {
<a name="l01938"></a>01938                                 $menuRub=<span class="keyword">new</span> <a class="code" href="class_menu.html" title="cr√©ation, modification, suppression d&amp;#39;un menu">Menu</a>();
<a name="l01939"></a>01939                                 $menuRub-&gt;type=<span class="stringliteral">&quot;rubrique&quot;</span>;
<a name="l01940"></a>01940                                 $menuRub-&gt;nomkey=<span class="stringliteral">&quot;numrub&quot;</span>;
<a name="l01941"></a>01941                                 $menuRub-&gt;nummenu=$numrub;
<a name="l01942"></a>01942                                 $menuRub-&gt;infosMenu();
<a name="l01943"></a>01943                                 echo <span class="stringliteral">&quot;&lt;a href=&#39;&quot;</span>.$menuRub-&gt;url.<span class="stringliteral">&quot;&#39;&gt;&quot;</span>.$menuRub-&gt;nomMenu.<span class="stringliteral">&quot;&lt;/a&gt; &quot;</span>;
<a name="l01944"></a>01944                                 <span class="keywordflow">if</span> ($numcateg) echo <span class="stringliteral">&quot;&gt; &quot;</span>;
<a name="l01945"></a>01945                         }
<a name="l01946"></a>01946                         
<a name="l01947"></a>01947                         <span class="keywordflow">if</span> ($numcateg) {
<a name="l01948"></a>01948                                 $menuCat=<span class="keyword">new</span> <a class="code" href="class_menu.html" title="cr√©ation, modification, suppression d&amp;#39;un menu">Menu</a>();
<a name="l01949"></a>01949                                 $menuCat-&gt;type=<span class="stringliteral">&quot;categorie&quot;</span>;
<a name="l01950"></a>01950                                 $menuCat-&gt;nomkey=<span class="stringliteral">&quot;numcateg&quot;</span>;
<a name="l01951"></a>01951                                 $menuCat-&gt;nummenu=$numcateg;
<a name="l01952"></a>01952                                 $menuCat-&gt;infosMenu();
<a name="l01953"></a>01953                                 echo <span class="stringliteral">&quot;&lt;a href=&#39;&quot;</span>.$menuCat-&gt;url.<span class="stringliteral">&quot;&#39;&gt;&quot;</span>.$menuCat-&gt;nomMenu.<span class="stringliteral">&quot;&lt;/a&gt; &quot;</span>;
<a name="l01954"></a>01954                                 <span class="keywordflow">if</span> ($numsscateg) echo <span class="stringliteral">&quot;&gt; &quot;</span>; 
<a name="l01955"></a>01955                         }
<a name="l01956"></a>01956                         
<a name="l01957"></a>01957                         <span class="keywordflow">if</span> ($numsscateg) {
<a name="l01958"></a>01958                                 $menuSscat=<span class="keyword">new</span> <a class="code" href="class_menu.html" title="cr√©ation, modification, suppression d&amp;#39;un menu">Menu</a>();
<a name="l01959"></a>01959                                 $menuSscat-&gt;type=<span class="stringliteral">&quot;sscateg&quot;</span>;
<a name="l01960"></a>01960                                 $menuSscat-&gt;nomkey=<span class="stringliteral">&quot;numsscateg&quot;</span>;
<a name="l01961"></a>01961                                 $menuSscat-&gt;nummenu=$numsscateg;
<a name="l01962"></a>01962                                 $menuSscat-&gt;infosMenu();
<a name="l01963"></a>01963                                 echo <span class="stringliteral">&quot;&lt;a href=&#39;&quot;</span>.$menuSscat-&gt;url.<span class="stringliteral">&quot;&#39;&gt;&quot;</span>.$menuSscat-&gt;nomMenu.<span class="stringliteral">&quot;&lt;/a&gt;&quot;</span>;
<a name="l01964"></a>01964                         }
<a name="l01965"></a>01965                         ?&gt;
<a name="l01966"></a>01966                         &lt;/p&gt;
<a name="l01967"></a>01967                                 &lt;/div&gt;
<a name="l01968"></a>01968                                 &lt;/div&gt;
<a name="l01969"></a>01969                   &lt;/div&gt;
<a name="l01970"></a>01970         &lt;/div&gt;
<a name="l01971"></a>01971 &lt;?php
<a name="l01972"></a>01972 }<span class="comment">//fin if (!$accueil) </span>
<a name="l01973"></a>01973 ?&gt;
<a name="l01974"></a>01974 
<a name="l01975"></a>01975 
<a name="l01976"></a>01976 &lt;!-- accueil - notez que l<span class="stringliteral">&#39;on n&#39;</span>encadre pas par une div <span class="keyword">class</span>=<span class="stringliteral">&quot;line&quot;</span> car il y a 2 div line dans home.php --&gt;
<a name="l01977"></a>01977 &lt;?php 
<a name="l01978"></a>01978 <span class="keywordflow">if</span> ($accueil) {
<a name="l01979"></a>01979         <span class="keywordflow">if</span> ($pg_admin &amp;&amp; file_exists(<span class="stringliteral">&quot;admin/&quot;</span>.$pg_admin.<span class="stringliteral">&quot;.php&quot;</span>)) include (<span class="stringliteral">&quot;admin/&quot;</span>.$pg_admin.<span class="stringliteral">&quot;.php&quot;</span>); 
<a name="l01980"></a>01980         <span class="keywordflow">else</span> <span class="keywordflow">if</span> ($spec &amp;&amp; file_exists($spec.<span class="stringliteral">&quot;.php&quot;</span>)) include ($spec.<span class="stringliteral">&quot;.php&quot;</span>); <span class="keywordflow">else</span> include (<span class="stringliteral">&quot;includes/page.php&quot;</span>);  
<a name="l01981"></a>01981 }
<a name="l01982"></a>01982 
<a name="l01983"></a>01983 ?&gt;
<a name="l01984"></a>01984 
<a name="l01985"></a>01985 &lt;!-- les autres pages --&gt;
<a name="l01986"></a>01986 &lt;?php
<a name="l01987"></a>01987 <span class="keywordflow">if</span> (!$accueil) {
<a name="l01988"></a>01988 ?&gt;
<a name="l01989"></a>01989 &lt;div <span class="keyword">class</span>=<span class="stringliteral">&quot;line&quot;</span>&gt;
<a name="l01990"></a>01990 
<a name="l01991"></a>01991                 &lt;!-- the left menu column --&gt;
<a name="l01992"></a>01992                 &lt;div <span class="keyword">class</span>=<span class="stringliteral">&quot;item&quot;</span> <span class="keywordtype">id</span>=<span class="stringliteral">&quot;menu_gauche&quot;</span>&gt;
<a name="l01993"></a>01993                          &lt;?php include (<span class="stringliteral">&quot;includes/menu.php&quot;</span>); ?&gt;
<a name="l01994"></a>01994                 &lt;/div&gt;
<a name="l01995"></a>01995 
<a name="l01996"></a>01996         &lt;!-- the content : les div <span class="keyword">class</span>=<span class="stringliteral">&quot;item&quot;</span> sont dedans --&gt;
<a name="l01997"></a>01997         &lt;?php
<a name="l01998"></a>01998         <span class="keywordflow">if</span> ($pg_admin &amp;&amp; file_exists(<span class="stringliteral">&quot;admin/&quot;</span>.$pg_admin.<span class="stringliteral">&quot;.php&quot;</span>)) include (<span class="stringliteral">&quot;admin/&quot;</span>.$pg_admin.<span class="stringliteral">&quot;.php&quot;</span>); 
<a name="l01999"></a>01999         <span class="keywordflow">else</span> <span class="keywordflow">if</span> ($spec &amp;&amp; file_exists($spec.<span class="stringliteral">&quot;.php&quot;</span>)) include ($spec.<span class="stringliteral">&quot;.php&quot;</span>); <span class="keywordflow">else</span> include (<span class="stringliteral">&quot;includes/page.php&quot;</span>);    
<a name="l02000"></a>02000         ?&gt;                                                                                                                                                                                                                                                                                              &lt;!---fin div <span class="keyword">class</span>=<span class="stringliteral">&quot;line&quot;</span>---&gt;    
<a name="l02001"></a>02001 &lt;/div&gt; 
<a name="l02002"></a>02002 
<a name="l02003"></a>02003 &lt;?php
<a name="l02004"></a>02004 }<span class="comment">//fin if (!$accueil)</span>
<a name="l02005"></a>02005 ?&gt;
<a name="l02006"></a>02006 
<a name="l02007"></a>02007 &lt;!-- the footer --&gt;
<a name="l02008"></a>02008 &lt;div <span class="keyword">class</span>=<span class="stringliteral">&quot;line&quot;</span>&gt;
<a name="l02009"></a>02009         &lt;div <span class="keywordtype">id</span>=<span class="stringliteral">&quot;footer&quot;</span> <span class="keyword">class</span>=<span class="stringliteral">&quot;item&quot;</span>&gt;
<a name="l02010"></a>02010                 &lt;div <span class="keyword">class</span>=<span class="stringliteral">&quot;sap-content&quot;</span>&gt;
<a name="l02011"></a>02011                  &lt;?php include (<span class="stringliteral">&quot;includes/footer.php&quot;</span>); ?&gt;
<a name="l02012"></a>02012                 &lt;/div&gt;
<a name="l02013"></a>02013         &lt;/div&gt;
<a name="l02014"></a>02014 &lt;/div&gt;
<a name="l02015"></a>02015 
<a name="l02016"></a>02016 &lt;!-- fin container --&gt;
<a name="l02017"></a>02017 &lt;/div&gt; 
<a name="l02018"></a>02018 &lt;input type=<span class="stringliteral">&quot;hidden&quot;</span> name=<span class="stringliteral">&quot;numdoc&quot;</span> value=<span class="stringliteral">&quot;&lt;?=$numdoc?&gt;&quot;</span> /&gt;
<a name="l02019"></a>02019 &lt;input type=<span class="stringliteral">&quot;hidden&quot;</span> name=<span class="stringliteral">&quot;moteur_rech&quot;</span> /&gt;&lt;!-- indique que l<span class="stringliteral">&#39;on recherche un ou plusieurs mots dans le moteur de recherche du site public - valeur possible &quot;1&quot;--&gt;</span>
<a name="l02020"></a>02020 <span class="stringliteral">&lt;/form&gt;</span>
<a name="l02021"></a>02021 <span class="stringliteral">&lt;!-- gestion des onglets et du menu general par Spry --&gt;</span>
<a name="l02022"></a>02022 <span class="stringliteral">&lt;script language=&quot;JavaScript&quot; type=&quot;text/javascript&quot;&gt;</span>
<a name="l02023"></a>02023 <span class="stringliteral">&lt;?php  </span>
<a name="l02024"></a>02024 <span class="stringliteral">if ($pg_admin==&quot;content&quot;) {</span>
<a name="l02025"></a>02025 <span class="stringliteral">?&gt;</span>
<a name="l02026"></a>02026 <span class="stringliteral">        var tp1 = new Spry.Widget.TabbedPanels(&quot;tp1&quot;, { defaultTab: &lt;? if ($onglet==&quot;voir&quot;) echo&quot;0&quot;;  else if ($onglet==&quot;mod_page&quot;) echo&quot;1&quot;; else if ($onglet==&quot;mod_para&quot;) echo&quot;2&quot;; else if ($onglet==&quot;aj_para&quot;) echo&quot;3&quot;; else echo&quot;0&quot;;?&gt; });</span>
<a name="l02027"></a>02027 <span class="stringliteral">&lt;?php</span>
<a name="l02028"></a>02028 <span class="stringliteral">}  </span>
<a name="l02029"></a>02029 <span class="stringliteral">if ($onglet==&quot;mod_para&quot;) {</span>
<a name="l02030"></a>02030 <span class="stringliteral">?&gt;</span>
<a name="l02031"></a>02031 <span class="stringliteral">        var Acc0= new Spry.Widget.Accordion(&quot;Acc0&quot;, { useFixedPanelHeights: false, defaultPanel: -1 });</span>
<a name="l02032"></a>02032 <span class="stringliteral">&lt;?php</span>
<a name="l02033"></a>02033 <span class="stringliteral">}</span>
<a name="l02034"></a>02034 <span class="stringliteral"> </span>
<a name="l02035"></a>02035 <span class="stringliteral">if ($cpt_acc) {   </span>
<a name="l02036"></a>02036 <span class="stringliteral">if ($cpt_acc&gt;1) $cpt_acc=$cpt_acc-1;</span>
<a name="l02037"></a>02037 <span class="stringliteral">?&gt;</span>
<a name="l02038"></a>02038 <span class="stringliteral">         //var Acc1 = new Spry.Widget.Accordion(&quot;Acc1&quot;, { useFixedPanelHeights: false, defaultPanel: -1 }); </span>
<a name="l02039"></a>02039 <span class="stringliteral">&lt;?php</span>
<a name="l02040"></a>02040 <span class="stringliteral">        for ($i=1; $i&lt;=$cpt_acc; $i++) {</span>
<a name="l02041"></a>02041 <span class="stringliteral">?&gt;</span>
<a name="l02042"></a>02042 <span class="stringliteral">                var Acc&lt;?=$i?&gt; = new Spry.Widget.Accordion(&quot;Acc&lt;?=$i?&gt;&quot;, { useFixedPanelHeights: false, defaultPanel: -1 });</span>
<a name="l02043"></a>02043 <span class="stringliteral">&lt;?php</span>
<a name="l02044"></a>02044 <span class="stringliteral">        } //fin du for</span>
<a name="l02045"></a>02045 <span class="stringliteral">}//fin if ($cpt_acc) </span>
<a name="l02046"></a>02046 <span class="stringliteral">?&gt;</span>
<a name="l02047"></a>02047 <span class="stringliteral">        &lt;!-- Menu general du site --&gt;</span>
<a name="l02048"></a>02048 <span class="stringliteral">        var MenuBarTop = new Spry.Widget.MenuBar(&quot;MenuBarTop&quot;, {imgDown:&quot;&quot;, imgRight:&quot;&quot;});</span>
<a name="l02049"></a>02049 <span class="stringliteral">&lt;/script&gt;</span>
<a name="l02050"></a>02050 <span class="stringliteral">&lt;!-- Google Analytics --&gt;</span>
<a name="l02051"></a>02051 <span class="stringliteral">&lt;script type=&quot;text/javascript&quot;&gt;</span>
<a name="l02052"></a>02052 <span class="stringliteral">var gaJsHost = ((&quot;https:&quot; == document.location.protocol) ? &quot;https://ssl.&quot; : &quot;http://www.&quot;);</span>
<a name="l02053"></a>02053 <span class="stringliteral">document.write(unescape(&quot;%3Cscript src=&#39;</span><span class="stringliteral">&quot; + gaJsHost + &quot;</span>google-analytics.com/ga.js<span class="stringliteral">&#39; type=&#39;</span>text/javascript<span class="stringliteral">&#39;%3E%3C/script%3E&quot;));</span>
<a name="l02054"></a>02054 <span class="stringliteral">&lt;/script&gt;</span>
<a name="l02055"></a>02055 <span class="stringliteral">&lt;script type=&quot;text/javascript&quot;&gt;</span>
<a name="l02056"></a>02056 <span class="stringliteral">try {</span>
<a name="l02057"></a>02057 <span class="stringliteral">var pageTracker = _gat._getTracker(&quot;UA-1769043-13&quot;);</span>
<a name="l02058"></a>02058 <span class="stringliteral">pageTracker._trackPageview();</span>
<a name="l02059"></a>02059 <span class="stringliteral">} catch(err) {}&lt;/script&gt;</span>
<a name="l02060"></a>02060 <span class="stringliteral">&lt;/body&gt;</span>
<a name="l02061"></a>02061 <span class="stringliteral">&lt;?php</span>
<a name="l02062"></a>02062 <span class="stringliteral">if ($mes) {</span>
<a name="l02063"></a>02063 <span class="stringliteral">echo&quot;&lt;script language=\&quot;javascript1.2\&quot;&gt;&lt;!--\n&quot;;</span>
<a name="l02064"></a>02064 <span class="stringliteral">echo&quot;alert(&#39;</span>$mes<span class="stringliteral">&#39;);\n&quot;;</span>
<a name="l02065"></a>02065 <span class="stringliteral">echo&quot;// --&gt;&lt;/script&gt;&quot;;</span>
<a name="l02066"></a>02066 <span class="stringliteral">}</span>
<a name="l02067"></a>02067 <span class="stringliteral">?&gt;</span>
<a name="l02068"></a>02068 <span class="stringliteral">&lt;/html&gt;</span>
<a name="l02069"></a>02069 <span class="stringliteral">&lt;?php</span>
<a name="l02070"></a>02070 <span class="stringliteral">mysql_close();</span>
<a name="l02071"></a>02071 <span class="stringliteral">?&gt;</span>
</pre></div></div>
<hr size="1"/><address style="text-align: right;"><small>G√©n√©r√© par&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.2 </small></address>
</body>
</html>
